SalesDashboard.dashboardModel=function(){function x(e,a,c){p.show();let d={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),CAM_MESA_CSC:a};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ensamble_Mesa_Ayuda","GET",d,getJSON(DeveloperType).ApiTickets_v2.token).then(f=>{if(1==f.success){let q=f.JsonData[0];null==q.CAM_MESA_IFRAMEWEB?DevExpress.ui.notify("Error no se identifico mesa de ayuda",
"error",3E3):setTimeout(()=>{let w="TIPO="+e+"&CSC_MESA="+a+"&TK_ID="+c+"&TPO_USUARIO="+b.TipoUsuario,t="/"+b.patname.split("/")[1]+"/views/Vistas_Mesas_Ayuda/"+q.CAM_MESA_IFRAMEWEB+"/"+q.CAM_MESA_IFRAMEWEB+".html?"+w;$("#Pop_Mesa_Ayuda_Config").dxPopup("instance").option("contentTemplate",function(y){return $('<div style="height:100%;">').append("<iframe src="+t+' width="100%" height="100%" scrolling="auto" frameBorder="0" style=" flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;"></iframe>')});
$("#Pop_Mesa_Ayuda_Config").dxPopup("show");p.hide()},3E3)}else DevExpress.ui.notify("Error no se identifico mesa de ayuda","error",3E3)}).catch(function(f){DevExpress.ui.notify("Error mesa de ayuda no localizada intente nuevamnete","error",3E3)})}let b=this,l=null;this.Estatus=null;let z=[],h=null;b.MisServiciosActivosTickets=[];b.FechaPromesaDefecto=86400;b.__Temp_Ult_Consulta={};let p=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,
shading:!0,visible:!0}).dxLoadPanel("instance");b.TipoUsuario="ADMIN";b.TimeZoneServidor=localStorage.getItem("tmzServidor");b.TimeZoneEmpleado=localStorage.getItem("tmzEmpleado");b.TiempoUTCEmpleado=DiferencieTimeZones();b.__DataSource_Tickets_Grid_Admin=new DevExpress.data.ArrayStore({data:[]});b.__DataSource_Tipificaiones=new DevExpress.data.ArrayStore({data:[]});b.init=async function(){await b.Load_Full_Catalogs();await b.Get_Cat_Tipificaciones();$("#splashscreen").fadeOut(1E3);Globalize.loadMessages(dictionary);
var e=function(){let a=sessionStorage.getItem("locale");return null!=a?a:"es"}();Globalize.locale(e);DevExpress.localization.locale(e);$("#adm_title_ms").html(Globalize.formatMessage("adm_title_ms"));$("#adm_title_grid").html(Globalize.formatMessage("adm_title_grid"));b.patname=window.location.pathname;l=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));$("#Mod_Tab_Reporte_Sura").dxTabPanel({animationEnabled:!1,deferRendering:!1,repaintChangesOnly:!1,dataSource:[{title:"Grid General",template:"tab_gridGeneral",
icon:"./images/Icons/Todos.png"},{title:"Cubos de informaci\u00f3n",template:"tab_cubo",icon:"./images/Icons/3d.png"}]});$("#treeTicketAdmin").dxTreeView({dataSource:[],height:"100%",showScrollbar:"always",dataStructure:"plain",selectionMode:"single",activeStateEnabled:!1,hoverStateEnabled:!1,focusStateEnabled:!1,selectByClick:!1,searchEnabled:!1,expandEvent:"click",keyExpr:"ID",displayExpr:"DESCRIPCION",parentIdExpr:"Task_Parent_ID",autoExpandAll:!1,itemTemplate:function(a,c,d){c=document.createElement("span");
c.className="menu_item "+a.ICON;d.append(c);c=document.createElement("span");c.className="item-text";c.innerText=a.DESCRIPCION;d.append(c)},onItemClick:function(a){b.__Temp_Ult_Consulta={};let c=a.itemData;h=b.MisServiciosActivosTickets.join(",");if(0==c.CAM_MESA_CSC)switch(c.CLAVE_ITEM){case "MTA_TODO":b.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=l.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTA_NO_TK":b.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=l.EMPLEADO_CSC_EMPLEADO;
$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTA_ABIERTAS":b.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=l.EMPLEADO_CSC_EMPLEADO;b.__Temp_Ult_Consulta.TIC_CERRADO=0;b.ConsultaTickets(b.__Temp_Ult_Consulta);break;case "MTA_CERRADAS":b.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=l.EMPLEADO_CSC_EMPLEADO;b.__Temp_Ult_Consulta.TIC_CERRADO=1;b.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_TODO":b.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=l.EMPLEADO_CSC_EMPLEADO;
$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_NO_TK":b.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=l.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTC_ABIERTAS":b.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=l.EMPLEADO_CSC_EMPLEADO;b.__Temp_Ult_Consulta.TIC_CERRADO=0;b.ConsultaTickets(b.__Temp_Ult_Consulta);break;case "MTC_CERRADAS":b.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=l.EMPLEADO_CSC_EMPLEADO;b.__Temp_Ult_Consulta.TIC_CERRADO=1;b.__Temp_Ult_Consulta.BYFC=
!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_ABIERTAS":if(""==h||null==h){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3);break}b.__Temp_Ult_Consulta.TIC_CERRADO=0;b.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=h;b.ConsultaTickets(b.__Temp_Ult_Consulta);break;case "MSA_CERRADAS":if(""==h||null==h){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3);break}b.__Temp_Ult_Consulta.TIC_CERRADO=1;b.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=h;b.__Temp_Ult_Consulta.BYFC=
!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_TODO":if(""==h||null==h){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3);break}b.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=h;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_NO_TK":""==h||null==h?DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3):(b.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=h,$("#Dialog_Busqueda_No_Ticket").dxPopup("show"))}else if(0!=c.CAM_MESA_CSC)switch(b.__Temp_Ult_Consulta=
{},a=a.itemData,a.CLAVE_ITEM){case "ALTATICKET":null==a.IFRAMEWEB?DevExpress.ui.notify("Error no se identifico mesa de ayuda","error",3E3):(b.__Temp_Ult_Consulta={EMPLEADO_CSC_ATIENDE:l.EMPLEADO_CSC_EMPLEADO,TIC_CERRADO:0},x("ALTA",a.CAM_MESA_CSC,null));break;case "TODAS":b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ABIERTAS":b.__Temp_Ult_Consulta.TIC_CERRADO=0;b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC;b.ConsultaTickets(b.__Temp_Ult_Consulta);
break;case "CERRADAS":b.__Temp_Ult_Consulta.TIC_CERRADO=1;b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC;b.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ESTATUS":b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC;b.__Temp_Ult_Consulta.ESTATUS_CSC=a.ESTATUS_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ITEMSEVERIDAD":b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC;b.__Temp_Ult_Consulta.SEVERIDAD_CSC=a.SEVERIDAD_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");
break;case "ITEMPRIORIDAD":b.__Temp_Ult_Consulta.CAM_MESA_CSC=a.CAM_MESA_CSC,b.__Temp_Ult_Consulta.PRIORIDAD_CSC=a.PRIORIDAD_CSC,$("#Dialog_Busqueda_Fecha").dxPopup("show")}}});$("#Pop_Mesa_Ayuda_Config").dxPopup({hideOnOutsideClick:!1,title:"Detalles",height:"90%",width:"70%",position:{my:"center",at:"center",of:window},onHiding:function(a){a.component.content().empty();b.ConsultaTickets(b.__Temp_Ult_Consulta)},onShowing:function(a){},onShown:function(a){}});b.DataGridTicketsAdmin=$("#Data_Grid_Ticket_Admin").dxDataGrid({dataSource:b.__DataSource_Tickets_Grid_Admin,
deferRendering:!0,allowColumnResizing:!0,height:"100%",filterRow:{visible:!1},filterPanel:{visible:!0},headerFilter:{visible:!0},keyExpr:"TIC_CSCTICKET",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!1,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!0,
export:{enabled:!0},onExporting:function(a){let c=new ExcelJS.Workbook,d=c.addWorksheet("Hoja1");DevExpress.excelExporter.exportDataGrid({worksheet:d,component:a.component,customizeCell:function(f){f.font={name:"Arial",size:12};f.alignment={horizontal:"left"}}}).then(function(){c.xlsx.writeBuffer().then(function(f){saveAs(new Blob([f],{type:"application/octet-stream"}),"Solicitudes_"+moment().tz(b.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss")+".xlsx")})});a.cancel=!0},columns:[{caption:"TICKET",
dataField:"TIC_CSCTICKET",fixed:!0,fixedPosition:"left",alignment:"center",sortOrder:"desc",width:130},{caption:"MESA DE AYUDA",dataField:"CAM_MESA_CSC",alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_CAM_MESA_DE_AYUDA").DATA,displayExpr:b.Get_Config_Cat_local("SAMT_CAM_MESA_DE_AYUDA").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_CAM_MESA_DE_AYUDA").KEYID}},{caption:"PROCESO",dataField:"ESTATUS_TICKET_CSC",alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_ESTATUS_TICKET").DATA,
displayExpr:b.Get_Config_Cat_local("SAMT_ESTATUS_TICKET").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_ESTATUS_TICKET").KEYID}},{caption:"CLASE TIPIFICACION",dataField:"TIPIFICA_CSC_PARENT_PARENT",alignment:"left",lookup:{dataSource:[].concat(b.Content_Full_Tipificaciones),displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC"}},{caption:"TIPO TIPIFICACION",dataField:"TIPIFICA_CSC_PARENT",alignment:"left",lookup:{dataSource:[].concat(b.Content_Full_Tipificaciones),displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC"}},
{caption:"TIPIFICACION",dataField:"TIPIFICA_CSC",alignment:"left",lookup:{dataSource:[].concat(b.Content_Full_Tipificaciones),displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC"}},{caption:"CLIENTE SOLICITA",dataField:"CLIENTE_CSC_SOLICITA",alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_CLIENTES").DATA,displayExpr:b.Get_Config_Cat_local("SAMT_CLIENTES").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_CLIENTES").KEYID}},{caption:"SERVICIO",dataField:"PM_CSC_PROYECTO_SOLICITA",alignment:"left",
lookup:{dataSource:b.Get_Config_Cat_local("SAMT_PROYECTOS").DATA,displayExpr:b.Get_Config_Cat_local("SAMT_PROYECTOS").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_PROYECTOS").KEYID}},{caption:"PROVEEDOR",dataField:"CAM_CSC_SERVICIO_SOLICITA",alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_CAM_SERVICIO").DATA,displayExpr:b.Get_Config_Cat_local("SAMT_CAM_SERVICIO").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_CAM_SERVICIO").KEYID}},{caption:"PRIORIDAD",dataField:"TIPO_PRIORIDAD_CSC",
alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_TIPO_PRIORIDAD_TICKET").DATA,displayExpr:b.Get_Config_Cat_local("SAMT_TIPO_PRIORIDAD_TICKET").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_TIPO_PRIORIDAD_TICKET").KEYID}},{caption:"SOLICITA",dataField:"TIC_SOLICITA",alignment:"left"},{caption:"ATIENDE",dataField:"NOM_EMP_ATN",alignment:"left"},{caption:"UBICACI\u00d3N",dataField:"REQ_CSCREQUISICION",alignment:"left",lookup:{dataSource:b.Get_Config_Cat_local("SAMT_REQUISICIONES").DATA,
displayExpr:b.Get_Config_Cat_local("SAMT_REQUISICIONES").TEXT,valueExpr:b.Get_Config_Cat_local("SAMT_REQUISICIONES").KEYID}},{caption:"RUTA",dataField:"TIC_SEGMENTACION_INM_DES",alignment:"left"},{caption:"FECHA ALTA",dataField:"fecha_alta_timezone",alignment:"center",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss"},{caption:"FECHA SOLICITA",dataField:"fecha_solicita_timezone",alignment:"center",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss"},{caption:"FECHA PROMESA",dataField:"fecha_promesa_timezone",
alignment:"center",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss"},{caption:"FECHA DE CIERRE",dataField:"fecha_cierre_timezone",alignment:"center",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss"},{caption:"EDO. FECH. PROMESA",width:150,alignment:"left",calculateCellValue:function(a){if(1==a.TIC_CERRADO||null!=a.TIC_FECHA_CIERRE){var c=a.TIC_FECHA_CIERRE;a=null==a.TIC_FECHA_PROMESA?moment(a.TIC_FECHA_ALTA).add(b.FechaPromesaDefecto,"seconds").format("YYYY-MM-DD HH:mm:ss"):a.TIC_FECHA_PROMESA;a=
moment(a);c=moment(c);return a>=c?"CUMPLIDA":"NO CUMPLIDA"}}},{caption:"T. PROMESA/CIERRE",dataField:"ttranfp",alignment:"center",width:170,calculateCellValue:function(a){if(1==a.TIC_CERRADO||null!=a.TIC_FECHA_CIERRE){var c=moment(a.TIC_FECHA_CIERRE).add(b.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD HH:mm:ss");a=null==a.TIC_FECHA_PROMESA?moment(a.TIC_FECHA_ALTA).add(b.FechaPromesaDefecto,"seconds").format("YYYY-MM-DD HH:mm:ss"):a.TIC_FECHA_PROMESA;c=moment(c);a=moment(a);if(c<=a)return c=a.diff(c,
"miliseconds"),c=moment.duration(c),0==c._isValid?"Sin Gestionar":("0"+c.days()).slice(-2)+" d "+("0"+c.hours()).slice(-2)+":"+("0"+c.minutes()).slice(-2)+":"+("0"+c.seconds()).slice(-2)+" (a)";c=c.diff(a,"miliseconds");c=moment.duration(c);return 0==c._isValid?"Sin Gestionar":("0"+c.days()).slice(-2)+" d "+("0"+c.hours()).slice(-2)+":"+("0"+c.minutes()).slice(-2)+":"+("0"+c.seconds()).slice(-2)}}},{caption:"SLA",width:150,alignment:"center",calculateCellValue:function(a){if(0==a.TIC_TIEMPO_EJECUCION)return a=
moment.duration(b.FechaPromesaDefecto,"seconds"),0==a._isValid?"Sin Gestionar":("0"+a.days()).slice(-2)+"d "+("0"+a.hours()).slice(-2)+":"+("0"+a.minutes()).slice(-2)+":"+("0"+a.seconds()).slice(-2);a=moment.duration(a.TIC_TIEMPO_EJECUCION,"seconds");return 0==a._isValid?"Sin Gestionar":("0"+a.days()).slice(-2)+"d "+("0"+a.hours()).slice(-2)+":"+("0"+a.minutes()).slice(-2)+":"+("0"+a.seconds()).slice(-2)}},{caption:"CUMPLIMIENTO SLA",width:150,alignment:"center",cellTemplate:function(a,c){const d=
$("<div>").text(c.value);"Vencido"==c.value?$("<div>").css("height","16px").css("width","16px").css("background-color","red").css("border-radius","50%").css("border","double 3px red").css("float","left").appendTo(a):$("<div>").css("height","16px").css("width","16px").css("background-color","#299A0B").css("border-radius","50%").css("border","double 3px #299A0B").css("float","left").appendTo(a);return d},calculateCellValue:function(a){if(1==a.TIC_CERRADO){var c=a.TIC_FECHA_CIERRE,d=moment(a.TIC_FECHA_ALTA);
c=moment(c).diff(d,"seconds");a=a.TIC_TIEMPO_EJECUCION;return 0==a?c>b.FechaPromesaDefecto?"Resuelto fuera de SLA":"Resuelto en tiempo":c>a?"Resuelto fuera de SLA":"Resuelto en tiempo"}c=moment().tz(b.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");d=moment(a.TIC_FECHA_ALTA);return moment(c).diff(d,"seconds")>a.TIC_TIEMPO_EJECUCION?"Vencido":"En Tiempo"}},{caption:"T. TRANSCURRIDO",dataField:"TRANSCURRIDOS",alignment:"center",width:150,calculateCellValue:function(a){if(1==a.TIC_CERRADO){var c=a.TIC_FECHA_CIERRE;
a=moment(a.TIC_FECHA_ALTA);a=moment(c).diff(a,"miliseconds");a=moment.duration(a);return 0==a._isValid?"Sin Gestionar":("0"+a.days()).slice(-2)+" d "+("0"+a.hours()).slice(-2)+":"+("0"+a.minutes()).slice(-2)+":"+("0"+a.seconds()).slice(-2)}c=moment().tz(b.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");a=moment(a.TIC_FECHA_ALTA);a=moment(c).diff(a,"miliseconds");a=moment.duration(a);return 0==a._isValid?"Sin Gestionar":("0"+a.days()).slice(-2)+" d "+("0"+a.hours()).slice(-2)+":"+("0"+a.minutes()).slice(-2)+
":"+("0"+a.seconds()).slice(-2)}},{caption:"ESTADO",width:170,alignment:"center",calculateCellValue:function(a){if(1==a.TIC_CERRADO)return"CERRADO";if(null!=a.TIC_FECHA_CIERRE)return"ESPERA DE CALIFICACI\u00d3N";let c=moment().format("YYYY-MM-DD HH:mm:ss");a=moment(a.TIC_FECHA_PROMESA).add(b.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD\u00a0HH:mm:ss");return new Date(c)>new Date(a)?"VENCIDA":"EN TIEMPO"},cellTemplate:function(a,c){a=$("<div>").text(c.value);"VENCIDA"==c.value?a.css({color:"white",
"background-color":"red"}):a.css({color:"white","background-color":"green"});return a}},{caption:"ASIGNACION",width:160,fixed:!0,alignment:"center",cellTemplate:function(a,c){const d=$("<div>").text(c.value);"ASIGNADO"==c.value?$("<div>").css("height","16px").css("width","16px").css("background-color","#23A521").css("border-radius","50%").css("border","double 3px #23A521").css("float","left").appendTo(a):$("<div>").css("height","16px").css("width","16px").css("background-color","#1E5799").css("border-radius",
"50%").css("border","double 3px #1E5799").css("float","left").appendTo(a);return d},calculateCellValue:function(a){return null==a.EMPLEADO_CSC_ATIENDE?"SIN ASIGNAR":"ASIGNADO"}}],summary:{totalItems:[{name:"Total",showInColumn:"TIC_CSCTICKET",displayFormat:"Total: {0}",summaryType:"count"}]},onRowDblClick:function(a){setTimeout(()=>{x("EDITAR",a.data.CAM_MESA_CSC,a.data.TIC_NEWID)},1E3)}}).dxDataGrid("instance");b.PivotDataGridTickets=$("#PivotDG_Ticket_Admin").dxPivotGrid({allowSortingBySummary:!0,
allowSorting:!0,allowFiltering:!0,height:"100%",showBorders:!0,fieldPanel:{showColumnFields:!0,showDataFields:!0,showFilterFields:!0,showRowFields:!0,allowFieldDragging:!0,visible:!0},export:{enabled:!0},fieldChooser:{enabled:!0,applyChangesMode:"instantly",allowSearch:!0},stateStoring:{enabled:!0,type:"localStorage",storageKey:"pivot_datagrid_report"},onExporting:function(a){let c=new ExcelJS.Workbook,d=c.addWorksheet("Hoja1");DevExpress.excelExporter.exportPivotGrid({worksheet:d,component:a.component,
customizeCell:function(f){f.font={name:"Arial",size:12};f.alignment={horizontal:"left"}}}).then(function(){c.xlsx.writeBuffer().then(function(f){saveAs(new Blob([f],{type:"application/octet-stream"}),"Solicitudes_"+moment().tz(b.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss")+".xlsx")})});a.cancel=!0},dataSource:{fields:[{caption:"Conteo",dataField:"EMP_CSC_EMPRESA_HOST",dataType:"number",summaryType:"count",area:"data"},{caption:"% Columna",dataField:"EMP_CSC_EMPRESA_HOST",dataType:"number",summaryType:"sum",
area:"data",summaryDisplayMode:"percentOfColumnGrandTotal"},{caption:"% Fila",dataField:"EMP_CSC_EMPRESA_HOST",dataType:"number",summaryType:"sum",area:"filter",summaryDisplayMode:"percentOfRowGrandTotal"},{caption:"Mesa",dataField:"CAM_MESA_CSC",width:150,area:"row",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_CAM_MESA_DE_AYUDA")},expanded:!0},{caption:"Fecha Alta (Dia/Mes/A\u00f1o)",area:"row",expanded:!1,selector:function(a){return null==a.fecha_alta_timezone?null:
moment(a.fecha_alta_timezone).format("DD/MM/YYYY")},customizeText:function(a){return null==a.value?"Sin Dato":a.value}},{caption:"Tipo De Ticket",dataField:"TIPO_TICKET_CSC",area:"column",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_TIPO_TICKET")},expanded:!0},{caption:"Fecha de Cierre (Desconcatenado)",dataField:"fecha_cierre_timezone",dataType:"date",area:"filter",expanded:!1},{caption:"A\u00f1o de Cierre",groupName:"fecha_cierre_timezone",groupInterval:"year",expanded:!1,
customizeText:function(a){return null==a.value?"Sin Dato":"A\u00f1o "+a.value}},{caption:"Cuatrimestre de Cierre ",groupName:"fecha_cierre_timezone",groupInterval:"quarter",expanded:!1,visible:!1},{caption:"Mes de Cierre",groupName:"fecha_cierre_timezone",groupInterval:"month",expanded:!1},{caption:"Dia de Cierre",groupName:"fecha_cierre_timezone",groupInterval:"day",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"Dia "+a.value}},{caption:"Atiende",dataField:"NOM_EMP_ATN",area:"filter",
expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":a.value}},{caption:"Atiende",dataField:"NOM_EMP_ATN",area:"filter",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":a.value}},{caption:"Clase Tipificaci\u00f3n",dataField:"TIPIFICA_CSC_PARENT_PARENT",area:"filter",expanded:!1,customizeText:function(a){if(null==a.value)return"Sin Dato";var c=jslinq(b.Content_Full_Tipificaciones).where(function(d){return d.TIPIFICA_CSC==a.value}).toList();return 0==c.length?a.value:
c[0].TIPIFICA_IDIOMA1}},{caption:"Tipo Tipificaci\u00f3n",dataField:"TIPIFICA_CSC_PARENT",area:"filter",expanded:!1,customizeText:function(a){if(null==a.value)return"Sin Dato";var c=jslinq(b.Content_Full_Tipificaciones).where(function(d){return d.TIPIFICA_CSC==a.value}).toList();return 0==c.length?a.value:c[0].TIPIFICA_IDIOMA1}},{caption:"Tipificaci\u00f3n",dataField:"TIPIFICA_CSC",area:"filter",expanded:!1,customizeText:function(a){if(null==a.value)return"Sin Dato";var c=jslinq(b.Content_Full_Tipificaciones).where(function(d){return d.TIPIFICA_CSC==
a.value}).toList();return 0==c.length?a.value:c[0].TIPIFICA_IDIOMA1}},{caption:"Cliente",dataField:"CLIENTE_CSC_SOLICITA",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_CLIENTES")},expanded:!0},{caption:"Servicio",dataField:"PM_CSC_PROYECTO_SOLICITA",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_PROYECTOS")},expanded:!0},{caption:"Proveedor",dataField:"CAM_CSC_SERVICIO_SOLICITA",width:150,area:"filter",
customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_CAM_SERVICIO")},expanded:!0},{caption:"Inmueble",dataField:"REQ_CSCREQUISICION",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_REQUISICIONES")},expanded:!0},{caption:"Canal",dataField:"SAMT_CAM_TIPO_SERVICIO_CSC",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_CAM_TIPO_SERVICIO")},expanded:!0},{caption:"Solicita",dataField:"TIC_SOLICITA",
area:"filter",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":a.value}},{caption:"Severidad",dataField:"TIPO_SEVERIDAD_CSC",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_TIPO_SEVERIDAD")},expanded:!0},{caption:"Prioridad",dataField:"TIPO_PRIORIDAD_CSC",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_TIPO_PRIORIDAD_TICKET")},expanded:!0},{caption:"A/C Estatus",dataField:"TIC_CERRADO",
area:"filter",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":1==a.value||1==a.value?"Cerrado":"Abierto"}},{caption:"Calificac\u00edon",dataField:"TIPO_CALIFICACION_CSC",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_TIPO_CALIFICACION")},expanded:!0},{caption:"Proceso",dataField:"ESTATUS_TICKET_CSC",width:150,area:"filter",customizeText:function(a){return b.Calcule_Label_Colum_Pivot(a.value,"SAMT_ESTATUS_TICKET")},expanded:!0},
{caption:"Fecha de Alta (Desconcatenado)",dataField:"fecha_alta_timezone",dataType:"date",area:"filter",expanded:!1},{caption:"A\u00f1o de Alta",groupName:"fecha_alta_timezone",groupInterval:"year",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"A\u00f1o "+a.value}},{caption:"Cuatrimestre de Alta ",groupName:"fecha_alta_timezone",groupInterval:"quarter",expanded:!1,visible:!1},{caption:"Mes de Alta",groupName:"fecha_alta_timezone",groupInterval:"month",expanded:!1},{caption:"Dia de Alta",
groupName:"fecha_alta_timezone",groupInterval:"day",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"Dia "+a.value}},{caption:"Hora de Alta",area:"filter",expanded:!1,selector:function(a){return null==a.fecha_alta_timezone?null:parseInt(moment(a.fecha_alta_timezone).format("HH"))},customizeText:function(a){return null==a.value?"Sin Dato":a.value+" Horas"}},{caption:"Fecha De Cierre (Dia/Mes/A\u00f1o)",area:"filter",expanded:!1,selector:function(a){return null==a.fecha_cierre_timezone?
null:moment(a.fecha_cierre_timezone).format("DD/MM/YYYY")},customizeText:function(a){return null==a.value?"Sin Dato":a.value}},{caption:"Hora de Cierre",area:"filter",expanded:!1,selector:function(a){return null==a.fecha_cierre_timezone?null:parseInt(moment(a.fecha_cierre_timezone).format("HH"))},customizeText:function(a){return null==a.value?"Sin Dato":a.value+" Horas"}},{caption:"Fecha Promesa (Desconcatenado)",dataField:"fecha_promesa_timezone",dataType:"date",expanded:!1},{caption:"A\u00f1o Promesa",
groupName:"fecha_promesa_timezone",groupInterval:"year",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"A\u00f1o "+a.value}},{caption:"Cuatrimestre Promesa ",groupName:"fecha_promesa_timezone",groupInterval:"quarter",expanded:!1,visible:!1},{caption:"Mes Promesa",groupName:"fecha_promesa_timezone",groupInterval:"month",expanded:!1},{caption:"Dia Promesa",groupName:"fecha_promesa_timezone",groupInterval:"day",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":
"Dia "+a.value}},{caption:"Fecha Solicita (Desconcatenado)",dataField:"fecha_solicita_timezone",dataType:"date",expanded:!1},{caption:"A\u00f1o Solicita",groupName:"fecha_solicita_timezone",groupInterval:"year",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"A\u00f1o "+a.value}},{caption:"Cuatrimestre Solicita ",groupName:"fecha_solicita_timezone",groupInterval:"quarter",expanded:!1,visible:!1},{caption:"Mes Solicita",groupName:"fecha_solicita_timezone",groupInterval:"month",
expanded:!1},{caption:"Dia Solicita",groupName:"fecha_solicita_timezone",groupInterval:"day",expanded:!1,customizeText:function(a){return null==a.value?"Sin Dato":"Dia "+a.value}},{caption:"Tiempo Ejecusi\u00f3n",dataField:"TIC_TIEMPO_EJECUCION",expanded:!0},{caption:"Tiempo Recepci\u00f3n",dataField:"TIC_TIEMPO_RECEPCION",expanded:!0},{caption:"Nombre Empleado Solicita",dataField:"NOM_EMP_SOL",expanded:!0},{dataField:"AUDITORIA_FEC_ALTA",visible:!1},{dataField:"AUDITORIA_FEC_ULT_MOD",visible:!1},
{dataField:"AUDITORIA_USU_ALTA",visible:!1},{dataField:"AUDITORIA_USU_ULT_MOD",visible:!1},{dataField:"EMPLEADO_CSC_ATIENDE",visible:!1},{dataField:"EMPLEADO_CSC_SOLICITA",visible:!1},{dataField:"INM_CSCINMUEBLE",visible:!1},{dataField:"SAMT_TICKET_TIPO_ACTUALIZA_CSC",visible:!1},{dataField:"SEG_CSC_SEGMENTACION_INM",visible:!1},{dataField:"SUB_ESTATUS_TICKET_CSC",visible:!1},{dataField:"TIC_ASUNTO_ORIGEN",visible:!1},{dataField:"TIC_AUXS1",visible:!1},{dataField:"TIC_AUXI1",visible:!1},{dataField:"TIC_AUXD1",
visible:!1},{dataField:"TIC_AUXS2",visible:!1},{dataField:"TIC_AUXI2",visible:!1},{dataField:"TIC_AUXD2",visible:!1},{dataField:"TIC_AUXS3",visible:!1},{dataField:"TIC_AUXI3",visible:!1},{dataField:"TIC_AUXD3",visible:!1},{dataField:"TIC_AVANCE",visible:!1},{dataField:"TIC_CALIFICACION_COMENTARIO",visible:!1},{dataField:"TIC_CALIFICADO",visible:!1},{dataField:"TIC_CONSECUTIVO_MESA",visible:!1},{dataField:"TIC_CRM",visible:!1},{dataField:"TIC_CSCTICKET",visible:!1},{dataField:"TIC_DESCRIPCION",visible:!1},
{dataField:"TIC_DESCRIPCION_SOLUCION",visible:!1},{dataField:"TIC_DESCRIPCION_CANCELACION",visible:!1},{dataField:"TIC_DURACION_CONFIRMACION",visible:!1},{dataField:"TIC_DURACION_EJECUCION",visible:!1},{dataField:"TIC_DURACION_RECEPCION",visible:!1},{dataField:"TIC_EMAIL_NOTIFICA_1",visible:!1},{dataField:"TIC_EMAIL_NOTIFICA_2",visible:!1},{dataField:"TIC_TELEFONO_SOLICITANTE",visible:!1},{dataField:"TIC_ESFUERZO_REQUERIDO",visible:!1},{dataField:"TIC_FECHA_ALTA",visible:!1},{dataField:"TIC_FECHA_ALTA_HORA_COMPLETA",
visible:!1},{dataField:"TIC_FECHA_ALTA_SOLA",visible:!1},{dataField:"TIC_FECHA_CIERRE",visible:!1},{dataField:"TIC_FECHA_CIERRE_SOLA",visible:!1},{dataField:"TIC_FECHA_CIERRE_HORA_COMPLETA",visible:!1},{dataField:"TIC_NEWID",visible:!1},{dataField:"TIC_NOTIFICA_OPERACION",visible:!1},{dataField:"TIC_EMAIL_SOLICITANTE",visible:!1},{dataField:"TIC_FECHA_PROMESA",visible:!1},{dataField:"TIC_FECHA_SOLICITA",visible:!1},{dataField:"TIC_PORC_PENALIZACION_RECEPCION",visible:!1},{dataField:"TIC_PORC_PENALIZACION_EJECUCION",
visible:!1},{dataField:"TIC_PORC_PENALIZACION_CONFIRMACION",visible:!1},{dataField:"TIC_SEGMENTACION_INM_DES",visible:!1},{dataField:"TIC_TIEMPO_CONFIRMACION",visible:!1}]}}).dxPivotGrid("instance");$("#Dialog_Busqueda_Fecha").dxPopup({hideOnOutsideClick:!1,title:"PARAMETROS",height:160,width:400,position:{my:"center",at:"center",of:window},onShowing:function(a){},contentTemplate:function(a){a.attr({style:"display: flex; flex-direction: column;"});a.append($("<div/>").append("Selecciona un rango de fechas.").attr({style:"font-size: 12px; margin-bottom: 5px; "}),
$("<div/>").append("**Se recomienda realizar busquedas en bloques no mayores a 3 meses.").attr({style:"font-size: 10px; margin-bottom: 5px; color:red;"}),$("<div />").attr({id:"Form_Busqueda_Fecha",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_Fecha_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{dataField:"TIC_FECHA_INICIAL",label:{text:"Fecha Inicial"},
editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",message:"Fecha requerida"}]},{dataField:"TIC_FECHA_FINAL",label:{text:"Fecha Final"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",
icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",{});$("#Dialog_Busqueda_Fecha").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},onClick(){var c=$("#Form_Busqueda_Fecha").dxForm("instance");c.validate().isValid?
(c=c.option("formData"),b.__Temp_Ult_Consulta.TIC_FECHA_INICIAL=c.TIC_FECHA_INICIAL+" 00:00:00",b.__Temp_Ult_Consulta.TIC_FECHA_FINAL=c.TIC_FECHA_FINAL+" 23:59:59",b.ConsultaTickets(b.__Temp_Ult_Consulta),$("#Dialog_Busqueda_Fecha").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}}]}]}))}});$("#Dialog_Busqueda_No_Ticket").dxPopup({hideOnOutsideClick:!1,title:"BUSQUEDA DE TICKET",height:120,width:400,position:{my:"center",at:"center",of:window},onShowing:function(a){},
contentTemplate:function(a){a.attr({style:"display: flex; flex-direction: column;"});a.append($("<div />").attr({id:"Form_Busqueda_No_Ticket",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_No_Ticket_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{colSpan:2,editorType:"dxNumberBox",dataField:"TIC_CSCTICKET",label:{text:"No. Ticket"},editorOptions:{disabled:!1},
validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_No_Ticket").dxForm("instance").resetValues();$("#Form_Busqueda_No_Ticket").dxForm("instance").option("formData",{});$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",
icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},onClick(){var c=$("#Form_Busqueda_No_Ticket").dxForm("instance");c.validate().isValid?(c=c.option("formData"),b.__Temp_Ult_Consulta.TIC_CSCTICKET=c.TIC_CSCTICKET,b.ConsultaTickets(b.__Temp_Ult_Consulta),$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}}]}]}))}});e={Tbl:"SAMT_CAM_SERVICIO",WHR:" EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+
" "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",e,getJSON(DeveloperType).ApiGeneral.token).then(a=>{if(1==a.success){a=a.JsonData;for(let c=0;c<a.length;c++)z.push(a[c].CAM_MESA_CSC)}});b.cargaArbolTicket()};b.cargaArbolTicket=function(){let e=[];e.push({ID:12,CAM_MESA_CSC:0,CLAVE_ITEM:"ALLTICKETSMS",DESCRIPCION:Globalize.formatMessage("adm_tk_tree"),Task_Parent_ID:0,ICON:"FOLDER"},{ID:13,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_TODO",DESCRIPCION:Globalize.formatMessage("adm_tk_all"),
Task_Parent_ID:12,ICON:"TODAS"},{ID:14,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_NO_TK",DESCRIPCION:"No. Ticket",Task_Parent_ID:12,ICON:"SEARCH"},{ID:15,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:12,ICON:"ABIERTAS"},{ID:16,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:12,ICON:"CERRADAS"});let a=18,c={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),
EMPLEADO_CSC_EMPLEADO:l.EMPLEADO_CSC_EMPLEADO,TPO_USUARIO:b.TipoUsuario};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Mesa_Empleado","GET",c,getJSON(DeveloperType).ApiTickets_v2.token).then(d=>{if(1==d.success){let f=d.JsonData;d={Tbl:"SAMT_ESTATUS_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",d,getJSON(DeveloperType).ApiGeneral.token).then(q=>{if(1==q.success){let w=q.JsonData;
q={Tbl:"SAMT_TIPO_SEVERIDAD",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_SEVERIDAD_TICKET_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",q,getJSON(DeveloperType).ApiGeneral.token).then(t=>{if(1==t.success){let y=t.JsonData;t={Tbl:"SAMT_TIPO_PRIORIDAD_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_PRIORIDAD_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+
"Get_Cat_Whr","GET",t,getJSON(DeveloperType).ApiGeneral.token).then(v=>{if(1==v.success){v=v.JsonData;for(let g=0;g<f.length;g++){b.MisServiciosActivosTickets.push(f[g].CAM_MESA_CSC);var m=parseInt(a+"");e.push({ID:m,CLAVE_ITEM:"SERVICIO",CAM_MESA_CSC:f[g].CAM_MESA_CSC,DESCRIPCION:f[g].CAM_MESA_IDIOMA1,Task_Parent_ID:0,ICON:"SERVICIO"});a++;e.push({ID:a,CLAVE_ITEM:"TODAS",DESCRIPCION:"Todas",CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"TODAS"});a++;e.push({ID:a,CLAVE_ITEM:"ABIERTAS",DESCRIPCION:"Abiertas",
CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"ABIERTAS"});a++;e.push({ID:a,CLAVE_ITEM:"CERRADAS",DESCRIPCION:"Cerradas",CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"CERRADAS"});a++;var r=parseInt(a+"");e.push({ID:r,CLAVE_ITEM:"PROCESO",DESCRIPCION:"Proceso",CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"PROCESO"});a++;var k=jslinq(w).where(function(u){return u.CAM_MESA_CSC==f[g].CAM_MESA_CSC}).toList();for(var n=0;n<k.length;n++)e.push({ID:a,CLAVE_ITEM:"ESTATUS",DESCRIPCION:k[n].ESTATUS_TICKET_IDIOMA1,
ESTATUS_CSC:k[n].ESTATUS_TICKET_CSC,CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:r,ICON:"ESTATUS"}),a++;a++;r=parseInt(a+"");e.push({ID:r,CLAVE_ITEM:"SEVERIDAD",DESCRIPCION:"Severidad",CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"SEVERIDAD"});a++;k=jslinq(y).where(function(u){return u.CAM_MESA_CSC==f[g].CAM_MESA_CSC}).toList();for(n=0;n<k.length;n++)e.push({ID:a,CLAVE_ITEM:"ITEMSEVERIDAD",DESCRIPCION:k[n].TIPO_SEVERIDAD_TICKET_IDIOMA1,SEVERIDAD_CSC:k[n].TIPO_SEVERIDAD_CSC,CAM_MESA_CSC:f[g].CAM_MESA_CSC,
Task_Parent_ID:r,ICON:"ITEMSEVERIDAD"}),a++;a++;r=parseInt(a+"");e.push({ID:r,CLAVE_ITEM:"PRIORIDAD",DESCRIPCION:"Prioridad",CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:m,ICON:"PRIORIDAD"});a++;m=jslinq(v).where(function(u){return u.CAM_MESA_CSC==f[g].CAM_MESA_CSC}).toList();for(k=0;k<m.length;k++)e.push({ID:a,CLAVE_ITEM:"ITEMPRIORIDAD",DESCRIPCION:m[k].TIPO_PRIORIDAD_IDIOMA1,PRIORIDAD_CSC:m[k].TIPO_PRIORIDAD_CSC,CAM_MESA_CSC:f[g].CAM_MESA_CSC,Task_Parent_ID:r,ICON:"ITEMPRIORIDAD"}),a++;a++}$("#treeTicketAdmin").dxTreeView("instance").option("dataSource",
e);p.hide()}})}})}})}else $("#treeTicketAdmin").dxTreeView("instance").option("dataSource",e),p.hide()});p.hide()};b.ConsultaTickets=function(e){b.__DataSource_Tickets_Grid_Admin.clear();let a={...ReturnDefaultData_Init()};e=Object.assign(a,e);p.show();__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Servicio","GET",e,getJSON(DeveloperType).ApiTickets_v2.token).then(c=>{1==c.success?(c=c.JsonData,c.forEach(function(d){b.__DataSource_Tickets_Grid_Admin.insert(d)}),b.DataGridTicketsAdmin.refresh(),
b.PivotDataGridTickets.option("dataSource.store",c)):(b.__DataSource_Tickets_Grid_Admin.clear(),b.DataGridTicketsAdmin.refresh(),b.PivotDataGridTickets.option("dataSource.store",[]));p.hide()}).catch(function(c){b.__DataSource_Tickets_Grid_Admin.clear();b.DataGridTicketsAdmin.refresh();p.hide();DevExpress.ui.notify("Eror de de busqueda vueva a intentar nuevamente","error",3E3)})};b.Load_Full_Catalogs=async function(){b.Content_Full_Catalogs={SAMT_CAM_MESA_DE_AYUDA:{DATA:[],KEYID:"CAM_MESA_CSC",TEXT:"CAM_MESA_IDIOMA1",
ACTIVE:"CAM_MESA_ACTIVO"},SAMT_ESTATUS_TICKET:{DATA:[],KEYID:"ESTATUS_TICKET_CSC",TEXT:"ESTATUS_TICKET_IDIOMA1",ACTIVE:"ESTATUS_TICKET_ACTIVO"},SAMT_TIPO_PRIORIDAD_TICKET:{DATA:[],KEYID:"TIPO_PRIORIDAD_CSC",TEXT:"TIPO_PRIORIDAD_IDIOMA1",ACTIVE:"TIPO_PRIORIDAD_ACTIVO"},SAMT_REQUISICIONES:{DATA:[],KEYID:"REQ_CSCREQUISICION",TEXT:"REQ_NOMBREAREA",ACTIVE:""},SAMT_CLIENTES:{DATA:[],KEYID:"CLIENTE_CSC",TEXT:"CLIENTE_NOMBRE",ACTIVE:""},SAMT_PROYECTOS:{DATA:[],KEYID:"PM_CSC_PROYECTO",TEXT:"PM_NOMBRE",ACTIVE:"PM_CERRADO_ABIERTO"},
SAMT_CAM_SERVICIO:{DATA:[],KEYID:"CAM_CSC_SERVICIO",TEXT:"CAM_SERVICIO_NOMBRE",ACTIVE:"CAM_ACTIVA"},SAMT_TIPO_TICKET:{DATA:[],KEYID:"TIPO_TICKET_CSC",TEXT:"TIPO_TICKET_IDIOMA1",ACTIVE:"TIPO_TICKET_ACTIVO"},SAMT_CAM_TIPO_SERVICIO:{DATA:[],KEYID:"SAMT_CAM_TIPO_SERVICIO_CSC",TEXT:"TIPO_SERVICIO_IDIOMA1",ACTIVE:"TIPO_SERVICIO_ACTIVO"},SAMT_TIPO_SEVERIDAD:{DATA:[],KEYID:"TIPO_SEVERIDAD_CSC",TEXT:"TIPO_SEVERIDAD_TICKET_IDIOMA1",ACTIVE:"TIPO_SEVERIDAD_TICKET_ACTIVO"},SAMT_TIPO_CALIFICACION:{DATA:[],KEYID:"TIPO_CALIFICACION_CSC",
TEXT:"TIPO_CALIFICACION_IDIOMA1",ACTIVE:"TIPO_CALIFICACION_ACTIVO"}};for(const e in b.Content_Full_Catalogs)await new Promise(async a=>{await b.Get_Cat_DataBase(e).then(function(c){console.log(c.success);a("resolved")}).catch(function(c){DevExpress.ui.notify("ERROR AL OBTENER CATALOGO");a("resolved")})})};b.Get_Cat_DataBase=function(e){return new Promise((a,c)=>{var d={Tbl:e};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",d,getJSON(DeveloperType).ApiGeneral.token).then(f=>
{b.Content_Full_Catalogs[e].DATA=1==f.success?[].concat(f.JsonData):[];a(f)}).catch(function(f){c({success:!1})})})};b.Get_Config_Cat_local=function(e){return Object.assign({},b.Content_Full_Catalogs[e])};b.Get_Cat_Tipificaciones=function(){return new Promise((e,a)=>{var c={EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type")};__Get_catalogos(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Simple_Tipificaciones",
"GET",c,getJSON(DeveloperType).ApiTickets_v2.token).then(d=>{b.Content_Full_Tipificaciones=1==d.success?d.JsonData:[];e(d)}).catch(function(d){a({success:!1})})})};b.Calcule_Label_Colum_Pivot=function(e,a){if(null==e)return"Sin Dato";var c=jslinq(b.Get_Config_Cat_local(a).DATA).where(function(d){return d[b.Get_Config_Cat_local(a).KEYID]==e}).toList();return 0==c.length?e:c[0][b.Get_Config_Cat_local(a).TEXT]}};
setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.init()},1E3);
