SalesDashboard.dashboardModel=function(){var a=this,f=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance");a.patname=window.location.pathname;a.TimeZoneServidor=localStorage.getItem("tmzServidor");a.TimeZoneEmpleado=localStorage.getItem("tmzEmpleado");a.TiempoUTCEmpleado=DiferencieTimeZones();a.IdEmpleado=null;a.TpoUsuario=null;a.DatosUsuariosPsw=null;a.obj_DatosEmpleado=null;a.init=function(){$("#splashscreen").fadeOut(1E3);
Globalize.loadMessages(dictionary);var d=function(){var b=sessionStorage.getItem("locale");return null!=b?b:"es"}();Globalize.locale(d);DevExpress.localization.locale(d);d=decrypt(localStorage.getItem("DatosEncriptados"));a.obj_DatosEmpleado=JSON.parse(d);$("#TagMesas").dxTagBox({showSelectionControls:!0,applyValueMode:"useButtons",displayExpr:"EMPLEADO_MNU_DESCRIPCION1",valueExpr:"EMPLEADO_MNU_CSC_MENU",dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+
"Get_Cat","GET",{Tbl:"SAMT_EMPLEADOS_MENU_DLL",NACTIVE:"EMPLEADO_MNU_ACTIVO"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return b.JsonData;console.log(b.message)})}catch(b){console.log(b)}}}),onValueChanged:function(b){b=b.value;var e=$("#DataGridMenuRh").dxDataGrid("instance"),k=null;null!=e.getDataSource()&&(k=e.getDataSource().items());var l=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),m=a.IdEmpleado;b.forEach(function(g){if(void 0==(null==k?void 0:k.find(h=>
h.EMPLEADO_MENU_CSC_MENU===g))){var c={};c.AUDITORIA_USU_ALTA=a.obj_DatosEmpleado.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_USU_ULT_MOD=a.obj_DatosEmpleado.EMPLEADO_CSC_EMPLEADO;c.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");c.AUDITORIA_FEC_ALTA=l;c.AUDITORIA_FEC_ULT_MOD=l;c.EMPLEADO_CSC_EMPLEADO=m;c.EMPLEADO_MENU_CSC_MENU=g;c={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),DATA_INSERT:c};
__Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+"Insert_Rh_Menu_Empleado","POST",JSON.stringify(c),getJSON(DeveloperType).ApiRecursosHumanos.token).then(h=>{f.show();1==h.success&&DevExpress.ui.notify({message:"Servicio asignado correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"})}).catch(function(h){DevExpress.ui.notify({message:"Error en comunicaci\u00f3n con servidores",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",
direction:"up-push"})})}});setTimeout(()=>{var g={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),EMPLEADO_CSC_EMPLEADO:a.IdEmpleado,TPO_USUARIO:a.TpoUsuario};a.Get_Rh_Menu_Empleado(g);f.hide()},3E3)}});f.hide();a.IdEmpleado=getUrlParam("idemp");a.TpoUsuario=getUrlParam("TpoUsuario");$("#DataGridMenuRh").dxDataGrid({keyExpr:"EMPLEADO_MENU_CSC_MENU",selection:{mode:"single"},height:390,scrolling:{useNative:!1,
scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always"},hoverStateEnabled:!0,showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"Id",dataField:"EMPLEADO_MENU_CSC_MENU",alignment:"left",width:50},{caption:"Men\u00fa",dataField:"EMPLEADO_MNU_DESCRIPCION1",alignment:"left"},{type:"buttons",width:110,buttons:[{text:"Eliminar",onClick(b){b={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:Number(localStorage.getItem("EMP_CSC_EMPRESA_HOST")),
Type:localStorage.getItem("Type"),EMPLEADO_CSC_EMPLEADO:Number(a.IdEmpleado),EMPLEADO_MENU_CSC_MENU:Number(b.row.data.EMPLEADO_MENU_CSC_MENU)};__Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+"Del_Rh_Menu_Empleado","POST",JSON.stringify(b),getJSON(DeveloperType).ApiRecursosHumanos.token).then(e=>{f.show();1==e.success&&(e={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),EMPLEADO_CSC_EMPLEADO:a.IdEmpleado,
USU_CODESQUEMASEG:3},a.Get_Rh_Menu_Empleado(e),DevExpress.ui.notify({message:"Men\u00fa retirado correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}))}).catch(function(e){DevExpress.ui.notify({message:"Error en comunicaci\u00f3n con servidores",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}}]}]});d={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),
Type:localStorage.getItem("Type"),EMPLEADO_CSC_EMPLEADO:a.IdEmpleado,USU_CODESQUEMASEG:3};a.Get_Rh_Menu_Empleado(d)};a.Get_Rh_Menu_Empleado=function(d){__Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+"Get_Rh_Menu_Empleado","GET",d,getJSON(DeveloperType).ApiRecursosHumanos.token).then(b=>{f.show();1==b.success?(b=b.JsonData,$("#DataGridMenuRh").dxDataGrid("instance").option("dataSource",b)):console.log("Sin Servicios Asignados");f.hide()})}};
setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.init()},1E3);
