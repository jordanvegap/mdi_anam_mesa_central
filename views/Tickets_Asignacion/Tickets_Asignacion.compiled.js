SalesDashboard.dashboardModel=function(){function w(e,b,c){var l={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),CAM_MESA_CSC:b};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ensamble_Mesa_Ayuda","GET",l,getJSON(DeveloperType).ApiTickets_v2.token).then(d=>{if(1==d.success)if(d=d.JsonData[0],null==d.CAM_MESA_IFRAMEWEB)DevExpress.ui.notify("Error no se identifico mesa de ayuda",
"error",3E3);else{var g="TIPO="+e+"&CSC_MESA="+b+"&TK_ID="+c,u="/"+a.patname.split("/")[1]+"/views/Vistas_Mesas_Ayuda/"+d.CAM_MESA_IFRAMEWEB+"/"+d.CAM_MESA_IFRAMEWEB+".html?"+g;$("#Pop_Mesa_Ayuda_Config").dxPopup("instance").option("contentTemplate",function(p){return $('<div style="height:100%;">').append("<iframe src="+u+' width="100%" height="100%" scrolling="auto" frameBorder="0" style=" flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;"></iframe>')});$("#Pop_Mesa_Ayuda_Config").dxPopup("show")}else DevExpress.ui.notify("Error no se identifico mesa de ayuda",
"error",3E3)}).catch(function(d){DevExpress.ui.notify("Error mesa de ayuda no localizada intente nuevamnete","error",3E3)})}var a=this,h=null;this.Nombre;this.Apellido;this.Estatus=null;var x=[];a.MisServiciosActivosTickets=[];a.__Temp_Ult_Consulta={};var m=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance");a.TodoEmpleados=null;a.init=function(){$("#splashscreen").fadeOut(1E3);Globalize.loadMessages(dictionary);
var e=function(){var b=sessionStorage.getItem("locale");return null!=b?b:"es"}();Globalize.locale(e);DevExpress.localization.locale(e);$("#adm_title_ms").html(Globalize.formatMessage("adm_title_ms"));a.patname=window.location.pathname;h=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));a.TodoEmpleados=JSON.parse(sessionStorage.getItem("all_emp_host"));$("#treeTicketAdmin").dxTreeView({dataSource:[],height:"100%",showScrollbar:"always",dataStructure:"plain",selectionMode:"single",activeStateEnabled:!1,
hoverStateEnabled:!1,focusStateEnabled:!1,selectByClick:!1,searchEnabled:!1,expandEvent:"click",keyExpr:"ID",displayExpr:"DESCRIPCION",parentIdExpr:"Task_Parent_ID",autoExpandAll:!1,itemTemplate:function(b,c,l){c=document.createElement("span");c.className="menu_item "+b.ICON;l.append(c);c=document.createElement("span");c.className="item-text";c.innerText=b.DESCRIPCION;l.append(c)},onItemClick:function(b){a.__Temp_Ult_Consulta={};var c=b.itemData;if(0==c.CAM_MESA_CSC)switch(c.CLAVE_ITEM){case "MTA_TODO":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=
h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTA_NO_TK":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTA_ABIERTAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "MTA_CERRADAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=
1;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_TODO":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_NO_TK":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTC_ABIERTAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.ConsultaTickets(a.__Temp_Ult_Consulta);
break;case "MTC_CERRADAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_ABIERTAS":b=a.MisServiciosActivosTickets.join(",");a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=b;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "MSA_CERRADAS":b=a.MisServiciosActivosTickets.join(",");a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=
b;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_TODO":b=a.MisServiciosActivosTickets.join(",");a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=b;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_NO_TK":b=a.MisServiciosActivosTickets.join(","),a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=b,$("#Dialog_Busqueda_No_Ticket").dxPopup("show")}else if(0!=c.CAM_MESA_CSC)switch(a.__Temp_Ult_Consulta={},c=b.itemData,c.CLAVE_ITEM){case "ALTATICKET":null==c.IFRAMEWEB?DevExpress.ui.notify("Error no se identifico mesa de ayuda",
"error",3E3):w("ALTA",c.CAM_MESA_CSC,null);break;case "TODAS":a.__Temp_Ult_Consulta.CAM_MESA_CSC=c.CAM_MESA_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ABIERTAS":a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.__Temp_Ult_Consulta.CAM_MESA_CSC=c.CAM_MESA_CSC;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "CERRADAS":a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.CAM_MESA_CSC=c.CAM_MESA_CSC;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ESTATUS":a.__Temp_Ult_Consulta.CAM_MESA_CSC=
c.CAM_MESA_CSC;a.__Temp_Ult_Consulta.ESTATUS_CSC=c.ESTATUS_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ITEMSEVERIDAD":a.__Temp_Ult_Consulta.CAM_MESA_CSC=c.CAM_MESA_CSC;a.__Temp_Ult_Consulta.SEVERIDAD_CSC=c.SEVERIDAD_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ITEMPRIORIDAD":a.__Temp_Ult_Consulta.CAM_MESA_CSC=c.CAM_MESA_CSC,a.__Temp_Ult_Consulta.PRIORIDAD_CSC=c.PRIORIDAD_CSC,$("#Dialog_Busqueda_Fecha").dxPopup("show")}}});$("#Pop_Mesa_Ayuda_Config").dxPopup({hideOnOutsideClick:!1,
title:"Detalle Solicitud",height:"90%",width:"800",position:{my:"center",at:"center",of:window},onHiding:function(b){a.ConsultaTickets(a.__Temp_Ult_Consulta)},onShowing:function(b){},onShown:function(b){}});$("#Pop_Select_Empleado_Reasigna").dxPopup({hideOnOutsideClick:!1,title:"EMPLEADO A ASIGNAR",height:function(){return 150},width:function(){return 350},position:{my:"center",at:"center",of:window},onShowing:function(b){},onHiding:function(b){$("#Frm_Empleado_Reasigna_Ticket").dxForm("instance").resetValues()},
contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div />").attr({id:"Frm_Empleado_Reasigna_Ticket",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",labelLocation:"top",validationGroup:"Frm_Empleado_Reasigna_Ticket_Validation",colCount:1,items:[{colSpan:1,dataField:"EMPLEADO_CSC_ATIENDE",editorType:"dxSelectBox",label:{text:"Empleado a Reasignar "},editorOptions:{searchEnabled:!0,
dataSource:a.TodoEmpleados,displayExpr:"NOMBRE",valueExpr:"EMPLEADO_CSC_EMPLEADO",onValueChanged:function(c){}},validationRules:[{type:"required",message:"requerido"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{width:"100%",type:"success",text:"REASIGNAR",icon:"save",onInitialized:function(c){$btn_SalvarAsegurado=c.component},onClick:function(){var c=$("#Frm_Empleado_Reasigna_Ticket").dxForm("instance");if(c.validate().isValid){var l=c.option("formData");c=$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").getSelectedRowsData();
m.show();var d=$.when();c.forEach(g=>{var u={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),DATA_UPDATE:{EMPLEADO_CSC_ATIENDE:l.EMPLEADO_CSC_ATIENDE,AUDITORIA_FEC_ULT_MOD:moment().tz(localStorage.getItem("tmzServidor")).format("YYYY-MM-DD HH:mm:ss"),AUDITORIA_USU_ULT_MOD:h.EMPLEADO_CSC_EMPLEADO},DATA_WHERE:{TIC_CSCTICKET:g.TIC_CSCTICKET,EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST")}};
d=d.then(function(){var p={};p.TIC_CSCTICKET=g.TIC_CSCTICKET;p.ESTATUS_TICKET_CSC=0;m.show();console.log(p);a.InsertaBitacoraManual(p,"Se reasigna usuario: de "+g.EMPLEADO_NOMBREEMPLEADO+" a ",!1,1,3);return __Reques_ajax_BitaoraDato(getJSON(DeveloperType).ApiTickets_v2.url+"Update_Ticket_Servicio","POST",JSON.stringify(u),getJSON(DeveloperType).ApiTickets_v2.token)}).catch(function(){return!1})});d.then(function(g){console.log(g);a.ConsultaTickets(a.__Temp_Ult_Consulta);$("#Pop_Select_Empleado_Reasigna").dxPopup("hide");
m.hide()})}else DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO")}}}]}))}});$("#context_menu_asignacion").dxContextMenu({items:[{text:"REASIGNAR SOLICITUDES",icon:"refresh",clave:"REASIGNAR"}],width:200,target:"#Data_Grid_Ticket_Admin",valueExpr:"clave",displayExpr:"text",onItemClick:function(b){if(!b.itemData.items)switch(b.itemData.clave){case "REASIGNAR":0<$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").getSelectedRowsData().length?$("#Pop_Select_Empleado_Reasigna").dxPopup("show"):DevExpress.ui.notify("SELECCIONE UNO O MAS REGISTROS A REASIGNAR",
"error",5E3)}}});$("#Data_Grid_Ticket_Admin").dxDataGrid({deferRendering:!0,allowColumnResizing:!0,height:"100%",filterRow:{visible:!0,applyFilter:"auto"},headerFilter:{visible:!0},keyExpr:"TIC_CSCTICKET",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"multiple"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!1,showColumnLines:!0,
rowAlternationEnabled:!0,columnAutoWidth:!0,columns:[{caption:"No. solicitud",dataField:"TIC_CSCTICKET",alignment:"center",sortOrder:"desc",width:130},{caption:"Fecha de ingreso",dataField:"FINGRESO",width:130},{caption:"Hora de ingreso",dataField:"HINGRESO",width:130},{caption:"Fecha de gesti\u00f3n inicial",dataField:"FGESTIONINICIAL",width:130},{caption:"Hora de gesti\u00f3n inicial",dataField:"HGESTIONINICIAL",width:130},{caption:"Tipo de documento",dataField:"DOCUMENTO_DESCRIPCION1",width:200},
{caption:"N\u00famero de documento",dataField:"CRM_NUMERO_DOCUMENTO",width:230},{caption:"Nombre",dataField:"CRM_NOMBRE",width:250},{caption:"Apellidos",dataField:"CRM_APELLIDOS",width:250},{caption:"Nombre Instituci\u00f3n",dataField:"CRM_NOMBRE_INSTITUCION",width:250},{caption:"Tel\u00e9fono celular",dataField:"CRM_TELEFONO_CEL",width:250},{caption:"Tel\u00e9fono fijo",dataField:"CRM_TELEFONO_FIJO",width:250},{caption:"Correo electronico",dataField:"CRM_CORREO",width:350},{caption:"Departamento",
dataField:"DEPARTAMENTO",width:250},{caption:"Ciudad",dataField:"CIUDAD",width:250},{caption:"Tipo de servicio",dataField:"SERVICIO",width:200},{caption:"Tipo de solicitud",dataField:"SOLICITUD",width:350},{caption:"Estado",dataField:"ESTATUS",width:150},{caption:"Fecha gestion final",dataField:"FECHACIERRE",width:130},{caption:"Hora gestion final",dataField:"TIC_FECHA_CIERRE_HORA_COMPLETA",width:130},{caption:"Usuario Asignado",dataField:"EMPLEADO_NOMBREEMPLEADO",width:250,fixed:!0,fixedPosition:"right"}],
summary:{totalItems:[{name:"Total",showInColumn:"TIC_CSCTICKET",displayFormat:"Total: {0}",summaryType:"count"}]}});$("#Dialog_Busqueda_Fecha").dxPopup({hideOnOutsideClick:!1,title:"PARAMETROS",height:function(){return 120},width:function(){return 400},position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div />").attr({id:"Form_Busqueda_Fecha",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,
showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_Fecha_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{dataField:"TIC_FECHA_INICIAL",label:{text:"Fecha Inicial"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",message:"Fecha requerida"}]},{dataField:"TIC_FECHA_FINAL",label:{text:"Fecha Final"},editorType:"dxDateBox",
editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},onClick(){var c=$("#Form_Busqueda_Fecha").dxForm("instance");c.validate().isValid?(c=c.option("formData"),a.__Temp_Ult_Consulta.TIC_FECHA_INICIAL=c.TIC_FECHA_INICIAL+" 00:00:00",
a.__Temp_Ult_Consulta.TIC_FECHA_FINAL=c.TIC_FECHA_FINAL+" 23:59:59",a.ConsultaTickets(a.__Temp_Ult_Consulta),$("#Dialog_Busqueda_Fecha").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",
{});$("#Dialog_Busqueda_Fecha").dxPopup("hide")}}}]}]}))}});$("#Dialog_Busqueda_No_Ticket").dxPopup({hideOnOutsideClick:!1,title:"BUSQUEDA DE SOLICITUD",height:function(){return 120},width:function(){return 400},position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div />").attr({id:"Form_Busqueda_No_Ticket",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,
showValidationSummary:!1,validationGroup:"Form_Busqueda_No_Ticket_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{colSpan:2,editorType:"dxNumberBox",dataField:"TIC_CSCTICKET",label:{text:"No. Solicitud"},editorOptions:{disabled:!1},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},
onClick(){var c=$("#Form_Busqueda_No_Ticket").dxForm("instance");c.validate().isValid?(c=c.option("formData"),a.__Temp_Ult_Consulta.TIC_CSCTICKET=c.TIC_CSCTICKET,a.ConsultaTickets(a.__Temp_Ult_Consulta),$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_No_Ticket").dxForm("instance").resetValues();
$("#Form_Busqueda_No_Ticket").dxForm("instance").option("formData",{});$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")}}}]}]}))}});e={Tbl:"SAMT_CAM_SERVICIO",WHR:" EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",e,getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success){b=b.JsonData;for(var c=0;c<b.length;c++)x.push(b[c].CAM_MESA_CSC)}});a.cargaArbolTicket()};a.cargaArbolTicket=function(){var e=
[];e.push({ID:12,CAM_MESA_CSC:0,CLAVE_ITEM:"ALLTICKETSMS",DESCRIPCION:"Solicitud's",Task_Parent_ID:0,ICON:"FOLDER"},{ID:13,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_TODO",DESCRIPCION:"Todas",Task_Parent_ID:12,ICON:"TODAS"},{ID:14,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_NO_TK",DESCRIPCION:"No. Solicitud",Task_Parent_ID:12,ICON:"SEARCH"},{ID:15,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:12,ICON:"ABIERTAS"},{ID:16,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:12,
ICON:"CERRADAS"},{ID:17,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_NOASIG",DESCRIPCION:"No asignadas",Task_Parent_ID:12,ICON:"SINASIG"});var b=18,c={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),EMPLEADO_CSC_EMPLEADO:h.EMPLEADO_CSC_EMPLEADO,TPO_USUARIO:"ADMIN"};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Mesa_Empleado","GET",c,getJSON(DeveloperType).ApiTickets_v2.token).then(l=>{m.show();
if(1==l.success){var d=l.JsonData;l={Tbl:"SAMT_ESTATUS_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",l,getJSON(DeveloperType).ApiGeneral.token).then(g=>{if(1==g.success){var u=g.JsonData;g={Tbl:"SAMT_TIPO_SEVERIDAD",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_SEVERIDAD_TICKET_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr",
"GET",g,getJSON(DeveloperType).ApiGeneral.token).then(p=>{if(1==p.success){var y=p.JsonData;p={Tbl:"SAMT_TIPO_PRIORIDAD_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_PRIORIDAD_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",p,getJSON(DeveloperType).ApiGeneral.token).then(r=>{if(1==r.success){r=r.JsonData;for(var f=0;f<d.length;f++){a.MisServiciosActivosTickets.push(d[f].CAM_MESA_CSC);var n=parseInt(b+"");e.push({ID:n,
CLAVE_ITEM:"SERVICIO",CAM_MESA_CSC:d[f].CAM_MESA_CSC,DESCRIPCION:d[f].CAM_MESA_IDIOMA1,Task_Parent_ID:0,ICON:"SERVICIO"});b++;e.push({ID:b,CLAVE_ITEM:"ALTATICKET",DESCRIPCION:"Generar nueva solicitud",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"ADD",IFRAMEWEB:d[f].CAM_MESA_IFRAMEWEB});b++;e.push({ID:b,CLAVE_ITEM:"TODAS",DESCRIPCION:"Todas",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"TODAS"});b++;e.push({ID:b,CLAVE_ITEM:"ABIERTAS",DESCRIPCION:"Abiertas",CAM_MESA_CSC:d[f].CAM_MESA_CSC,
Task_Parent_ID:n,ICON:"ABIERTAS"});b++;e.push({ID:b,CLAVE_ITEM:"CERRADAS",DESCRIPCION:"Cerradas",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"CERRADAS"});b++;var t=parseInt(b+"");e.push({ID:t,CLAVE_ITEM:"PROCESO",DESCRIPCION:"Proceso",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"PROCESO"});b++;for(var q=jslinq(u).where(function(v){return v.CAM_MESA_CSC==d[f].CAM_MESA_CSC}).toList(),k=0;k<q.length;k++)e.push({ID:b,CLAVE_ITEM:"ESTATUS",DESCRIPCION:q[k].ESTATUS_TICKET_IDIOMA1,ESTATUS_CSC:q[k].ESTATUS_TICKET_CSC,
CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:t,ICON:"ESTATUS"}),b++;b++;t=parseInt(b+"");e.push({ID:t,CLAVE_ITEM:"SEVERIDAD",DESCRIPCION:"Severidad",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"SEVERIDAD"});b++;q=jslinq(y).where(function(v){return v.CAM_MESA_CSC==d[f].CAM_MESA_CSC}).toList();for(k=0;k<q.length;k++)e.push({ID:b,CLAVE_ITEM:"ITEMSEVERIDAD",DESCRIPCION:q[k].TIPO_SEVERIDAD_TICKET_IDIOMA1,SEVERIDAD_CSC:q[k].TIPO_SEVERIDAD_CSC,CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:t,ICON:"ITEMSEVERIDAD"}),
b++;b++;t=parseInt(b+"");e.push({ID:t,CLAVE_ITEM:"PRIORIDAD",DESCRIPCION:"Prioridad",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"PRIORIDAD"});b++;q=jslinq(r).where(function(v){return v.CAM_MESA_CSC==d[f].CAM_MESA_CSC}).toList();for(k=0;k<q.length;k++)e.push({ID:b,CLAVE_ITEM:"ITEMPRIORIDAD",DESCRIPCION:r[k].TIPO_PRIORIDAD_IDIOMA1,PRIORIDAD_CSC:r[k].TIPO_PRIORIDAD_CSC,CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:t,ICON:"ITEMPRIORIDAD"}),b++;e.push({ID:b++,CLAVE_ITEM:"NOASIG",DESCRIPCION:"No Asignadas",
CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"SINASIG",IFRAMEWEB:d[f].CAM_MESA_IFRAMEWEB},{ID:b++,CLAVE_ITEM:"PORAUT",DESCRIPCION:"Por Autorizar",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"XAUT",IFRAMEWEB:d[f].CAM_MESA_IFRAMEWEB},{ID:b++,CLAVE_ITEM:"AUTCANCEL",DESCRIPCION:"Autorizadas o canceladas",CAM_MESA_CSC:d[f].CAM_MESA_CSC,Task_Parent_ID:n,ICON:"CANCAUTO",IFRAMEWEB:d[f].CAM_MESA_IFRAMEWEB});b++}e.push({ID:7,CAM_MESA_CSC:0,CLAVE_ITEM:"INIT_MTA",DESCRIPCION:"Mis Solicitudes's asignadas",
Task_Parent_ID:1,ICON:"MTA"},{ID:8,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_TODO",DESCRIPCION:"Todas",Task_Parent_ID:7,ICON:"TODAS"},{ID:9,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_NO_TK",DESCRIPCION:"No. Solicitud",Task_Parent_ID:7,ICON:"SEARCH"},{ID:10,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:7,ICON:"ABIERTAS"},{ID:11,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:7,ICON:"CERRADAS"});$("#treeTicketAdmin").dxTreeView("instance").option("dataSource",
e);m.hide();r=a.MisServiciosActivosTickets.join(",");a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=r;a.ConsultaTickets(a.__Temp_Ult_Consulta)}})}})}})}else $("#treeTicketAdmin").dxTreeView("instance").option("dataSource",e),m.hide()});m.hide();setTimeout(()=>{},1E3)};a.InsertaBitacoraManual=function(e,b,c,l,d){1==c&&(c=$("#Dg_Bitacora_Ticket").dxDataGrid("instance").getDataSource().items(),2<=jslinq(c).where(function(g){return 5==g.SAMT_TICKET_SUBTIPO_BITACORA_CSC}).toList().length?
a.Generar_Orden_Trabajo_Rechazo():console.log("NO SE GENERARA OT"));e={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),DATA_INSERT:{EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),AUDITORIA_USU_ALTA:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,AUDITORIA_USU_ULT_MOD:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,AUDITORIA_FEC_ALTA:moment().tz(localStorage.getItem("tmzServidor")).format("YYYY-MM-DD HH:mm:ss"),
AUDITORIA_FEC_ULT_MOD:moment().tz(localStorage.getItem("tmzServidor")).format("YYYY-MM-DD HH:mm:ss"),TIC_CSCTICKET:e.TIC_CSCTICKET,ESTATUS_TICKET_CSC:e.ESTATUS_TICKET_CSC,TIB_NOMBRE:h.EMPLEADO_NOMBREEMPLEADO+" "+h.EMPLEADO_APATERNOEMPLEADO+" "+h.EMPLEADO_AMATERNOEMPLEADO,TIB_DESCRIPCION:b,TIB_FECHAHORA:moment().tz(localStorage.getItem("tmzServidor")).format("YYYY-MM-DD HH:mm:ss"),SAMT_TICKET_TIPO_BITACORA_CSC:l,SAMT_TICKET_SUBTIPO_BITACORA_CSC:d}};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Insert_Bitacora_Ticket","POST",JSON.stringify(e),getJSON(DeveloperType).ApiTickets_v2.token).then(g=>{1==g.success?DevExpress.ui.notify("BITACORA AGREGADA CORRECTAMENTE","success",5E3):m.hide();return g}).catch(function(g){m.hide();DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)})};a.ConsultaTickets=function(e){$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").option("dataSource",[]);var b={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),
EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST")};e=Object.assign(b,e);m.show();__Reques_ajax(getJSON(DeveloperType).ApiSuraCrmColombia.url+"Get_Ticket_Reporte","GET",e,getJSON(DeveloperType).ApiSuraCrmColombia.token).then(c=>{1==c.success?$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").option("dataSource",c.JsonData):$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").option("dataSource",[]);m.hide()}).catch(function(c){$("#Data_Grid_Ticket_Admin").dxDataGrid("instance").option("dataSource",
[]);m.hide();DevExpress.ui.notify("Eror de de busqueda vueva a intentar nuevamente","error",3E3)})}};setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.init()},1E3);
