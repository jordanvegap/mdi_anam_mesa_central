SalesDashboard.dashboardModel=function(){let e=this,k;e.DataOtOpen=null;e.setDefaultValues_Ots=!1;e.Ids_TipoUso_Requi_Ots=9;e.Frm_Ot_Instance=null;let h=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance");e.init=function(){function d(b){b.font={name:"Arial",size:12};b.alignment={horizontal:"left"}}function c(b){saveAs(new Blob([b],{type:"application/octet-stream"}),"REPORTE_OT_"+moment().tz(localStorage.getItem("tmzEmpleado")).format("YYYYMMDD_HH")+
".xlsx")}k=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));h.hide();$("#splashscreen").fadeOut(1E3);Globalize.loadMessages(dictionary);let g=function(){let b=sessionStorage.getItem("locale");return null!=b?b:"es-mx"}();Globalize.locale(g);DevExpress.localization.locale(g);e.patname=window.location.pathname;$("#Pop_Busqueda_Fecha_Ot").dxPopup({hideOnOutsideClick:!1,title:"PARAMETROS",height:120,width:400,position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});
b.append($("<div />").attr({id:"Form_Busqueda_Fecha",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_Fecha_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{dataField:"TIC_FECHA_INICIAL",label:{text:"Fecha Inicial"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",
message:"Fecha requerida"}]},{dataField:"TIC_FECHA_FINAL",label:{text:"Fecha Final"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy"},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(a){},onClick(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();
$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",{});$("#Pop_Busqueda_Fecha_Ot").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(a){},onClick(){var a=$("#Form_Busqueda_Fecha").dxForm("instance");a.validate().isValid?(a=a.option("formData"),e.Consulta_Ordenes_Trabajo(a),$("#Pop_Busqueda_Fecha_Ot").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO",
"error",300)}}}]}]}))}});$("#Mod_Tab_Reporte_OT").dxTabPanel({animationEnabled:!1,deferRendering:!1,repaintChangesOnly:!1,dataSource:[{title:"Grid General",template:"tab_gridGeneral",icon:"./images/Icons/Todos.png"},{title:"Cubos de informaci\u00f3n",template:"tab_cubo",icon:"./images/Icons/3d.png"}]});$("#__tree_Ot_ADmin").dxTreeView({dataSource:[],height:"100%",showScrollbar:"always",dataStructure:"plain",selectionMode:"single",activeStateEnabled:!1,hoverStateEnabled:!1,focusStateEnabled:!1,selectByClick:!1,
searchEnabled:!1,expandEvent:"click",keyExpr:"ID",displayExpr:"DESCRIPCION",parentIdExpr:"Task_Parent_ID",autoExpandAll:!1,itemTemplate:function(b,a,f){a=document.createElement("span");a.className="menu_item "+b.ICON;f.append(a);a=document.createElement("span");a.className="item-text";a.innerText=b.DESCRIPCION;f.append(a)},onItemClick:function(b){let a=b.itemData;"ASIGNADA"==a.CLAVE_ITEM||"ABIERTA"==a.CLAVE_ITEM||"SINASIGNACION"==a.CLAVE_ITEM?e.Consulta_Ordenes_Trabajo(a):"NO_OT"==a.CLAVE_ITEM?($("#Pop_Busqueda_No_Ot").dxPopup("show"),
setTimeout(function(){$("#Frm_Busqueda_No_Ots").dxForm("instance").resetValues();$("#Frm_Busqueda_No_Ots").dxForm("instance").option("formData",{});$("#Frm_Busqueda_No_Ots").dxForm("instance").option("formData",a)},500)):"TODAS"==a.CLAVE_ITEM||"CERRADA"==a.CLAVE_ITEM||"AREA"==a.NODO_TAG||"DEPARTAMENTO"==a.NODO_TAG?($("#Pop_Busqueda_Fecha_Ot").dxPopup("show"),setTimeout(function(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",
{});$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",a)},500)):"OTVENC"!=a.CLAVE_ITEM&&"OTVENCHOY"!=a.CLAVE_ITEM&&"OTVENCP"!=a.CLAVE_ITEM||e.Consulta_Ordenes_Trabajo(a);"ESTATUS"!=a.NODO_TAG&&"OTPRIORIDAD"!=a.NODO_TAG||e.Consulta_Ordenes_Trabajo(a);if("ABIERTAS"==a.CLAVE_ITEM||"ESTATUS"==a.CLAVE_ITEM||"ITEMSEVERIDAD"==a.CLAVE_ITEM||"ITEMPRIORIDAD"==a.CLAVE_ITEM)e.Consulta_Ordenes_Trabajo(a);else if("CERRADAS"==a.CLAVE_ITEM||"TODAS"==a.CLAVE_ITEM)$("#Pop_Busqueda_Fecha_Ot").dxPopup("show"),
setTimeout(function(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",{});$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",a)},500)}});$("#Pop_Busqueda_No_Ot").dxPopup({hideOnOutsideClick:!1,title:"BUSQUEDA DE ORDEN DE TRABAJO",height:120,width:400,position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div />").attr({id:"Frm_Busqueda_No_Ots",
style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Frm_Busqueda_No_Ots_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{colSpan:2,editorType:"dxNumberBox",dataField:"OTR_CSCORDENTRABAJO",label:{text:"No. de Orden de trabajo"},editorOptions:{disabled:!1},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",
buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(a){},onClick(){$("#Frm_Busqueda_No_Ots").dxForm("instance").resetValues();$("#Frm_Busqueda_No_Ots").dxForm("instance").option("formData",{});$("#Pop_Busqueda_No_Ot").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(a){},onClick(){var a=$("#Frm_Busqueda_No_Ots").dxForm("instance");
a.validate().isValid?(a=a.option("formData"),e.Consulta_Ordenes_Trabajo(a),$("#Pop_Busqueda_No_Ot").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",3E3)}}}]}]}))}});$("#Pop_Open_Ot").dxPopup({hideOnOutsideClick:!1,title:"Orden de trabajo",height:"100%",width:"500",position:{my:"center",at:"center",of:window},onHiding:function(b){document.getElementById("Mod_Embebed_Ot").src=""},onShowing:function(b){},onShown:function(b){}});$("#Data_Grid_Ot_Admin").dxDataGrid({deferRendering:!0,
allowColumnReordering:!0,allowColumnResizing:!0,rowAlternationEnabled:!0,allowHeaderFiltering:!0,height:"100%",keyExpr:"OTR_CSCORDENTRABAJO",headerFilter:{visible:!0},filterRow:{visible:!0},filterPanel:{visible:!0},remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},columnFixing:{enabled:!0},columnChooser:{enabled:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,
pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,columnAutoWidth:!0,export:{enabled:!0},onExporting:function(b){let a=new ExcelJS.Workbook,f=a.addWorksheet("OT");DevExpress.excelExporter.exportDataGrid({worksheet:f,component:b.component,customizeCell:d}).then(function(){a.xlsx.writeBuffer().then(c)});b.cancel=!0},columns:[{caption:"No. OT",dataField:"OTR_CSCORDENTRABAJO",fixed:!0,fixedPosition:"left",alignment:"center",width:85,dataType:"number",format:{type:"fixedPoint",precision:0}},
{caption:"Proceso",dataField:"ESTATUS_ORDEN",alignment:"center",dataType:"string"},{caption:"Titulo",dataField:"OTR_TITULO",alignment:"center",dataType:"string",width:200},{caption:"Tipo de Orden",dataField:"TIPO_ORDEN",alignment:"center",dataType:"string"},{caption:"Sub Tipo",dataField:"SUB_TIPO",alignment:"center",dataType:"string"},{caption:"Especialidad",dataField:"TIPO_ESPECIALIDAD_OT",alignment:"center",dataType:"string"},{caption:"Centro de Costos",dataField:"CENTRO_COSTOS",alignment:"center",
dataType:"string"},{caption:"Prioridad",dataField:"TIPO_PRIORIDAD",alignment:"center",dataType:"string"},{caption:"Cerrada",dataField:"OTR_CERRADA",alignment:"center",dataType:"string"},{caption:"Fecha Alta",dataField:"OTR_FECHA_ALTA",alignment:"center",dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Fecha Cierre",dataField:"OTR_FECHA_CIERRE",alignment:"center",dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Fecha Programada Inicio",dataField:"OTR_FECHA_PROGRAMADA_INICIO",alignment:"center",
dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Fecha Programada Fin",dataField:"OTR_FECHA_PROGRAMADA_FIN",alignment:"center",dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Fecha Real Inicio",dataField:"OTR_FECHA_REAL_INICIO",alignment:"center",dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Fecha Real Fin",dataField:"OTR_FECHA_REAL_FIN",alignment:"center",dataType:"date",format:"yyyy-MM-dd HH:mm:ss"},{caption:"Tiempo Programado",dataField:"OTR_TIEMPO_PROGRAMADO",alignment:"center",
dataType:"time",format:"HH:mm:ss"},{caption:"Tiempo Real",dataField:"OTR_TIEMPO_REAL",alignment:"center",dataType:"time",format:"HH:mm:ss"},{caption:"Area Solicita",dataField:"AREA_SOLICITA",alignment:"center",dataType:"string"},{caption:"Departamento Solicita",dataField:"DEPARTAMENTO_SOLICITA",alignment:"center",dataType:"string"},{caption:"Area Responsable",dataField:"AREA_RESPONSABLE",alignment:"center",dataType:"string"},{caption:"Despartamento Responsable",dataField:"DEPARTAMENTO_RESPONSABLE",
alignment:"center",dataType:"string"},{caption:"Calificacion",dataField:"TIPO_CALIFICACION",alignment:"center",dataType:"string"},{caption:"Ubicacion",dataField:"OTR_UBICACION",alignment:"center",dataType:"string",visible:!1},{caption:"Proveedor",dataField:"CAT_PROVEEDOR_INFRA",alignment:"center",dataType:"string"},{caption:"Cliente",dataField:"CLIENTE",alignment:"center",dataType:"string",visible:!1},{caption:"Campa\u00f1a",dataField:"CAMPANIA",alignment:"center",dataType:"string",visible:!1},{caption:"Sub Campa\u00f1a",
dataField:"SUBCAMPANIA",alignment:"center",dataType:"string",visible:!1},{caption:"Solicita",dataField:"EMPLEADO_SOLICITA",alignment:"center",dataType:"string"},{caption:"Responsable",dataField:"EMPLEADO_RESPONSABLE",alignment:"center",dataType:"string"},{caption:"Empleado Alta",dataField:"EMPLEADO_ALTA",alignment:"center",dataType:"string"},{caption:"Site",dataField:"REQ_NOMBREAREA",alignment:"center",dataType:"string"},{caption:"Inmueble",dataField:"INM_CLVE_INMUEBLE",alignment:"center",dataType:"string",
visible:!1},{caption:"Autorizacion",dataField:"CAT_OT_AUTORIZACION",alignment:"center",dataType:"string",visible:!1},{caption:"Tipo Tramite",dataField:"TIPO_OT_TRAMITE",alignment:"center",dataType:"string"},{caption:"Duracion A\u00f1os",dataField:"OTR_FECHA_DURACION_ANIOS",alignment:"center",dataType:"number",format:{type:"fixedPoint",precision:0},visible:!1},{caption:"Duracion Dias ",dataField:"OTR_FECHA_DURACION_DIAS",alignment:"center",dataType:"number",format:{type:"fixedPoint",precision:0},visible:!1},
{caption:"Duracion Horas",dataField:"OTR_FECHA_DURACION_HORAS",alignment:"center",dataType:"number",format:{type:"fixedPoint",precision:0},visible:!1},{caption:"Duracion Minutos",dataField:"OTR_FECHA_DURACION_MIMUTOS",alignment:"center",dataType:"number",format:{type:"fixedPoint",precision:0},visible:!1},{caption:"Moneda",dataField:"MDA_CVEMONEDA",alignment:"center",dataType:"string"},{caption:"Costo",dataField:"OTR_COSTO",alignment:"center",dataType:"number",format:{type:"currency",precision:2,currency:"MXN"}},
{caption:"Esfuerzo Requerido",dataField:"OTR_ESFUERZO_REQUERIDO",alignment:"center",dataType:"time",format:"HH:mm:ss"},{caption:"Moneda Total",dataField:"MDA_CVEMONEDA_TOTAL",alignment:"center",dataType:"string"},{caption:"Costo Total",dataField:"OTR_COSTO_TOTAL",alignment:"center",dataType:"number",format:{type:"currency",precision:2,currency:"MXN"}},{caption:"Estado",dataField:"ESTATUS_OT",fixed:!0,fixedPosition:"right",alignment:"center",dataType:"string",cellTemplate(b,a){"Cerrado"==a.value?$("<div>").css("color",
"#FFF").css("background-color","#07B40A").css("border-radius","0px").css("border","double 2px #07B40A").css("margin","-4px").css("padding","1px").css("font-weight","700").css("text-align","center").append(a.data.ESTATUS_OT).appendTo(b):"Con Retrazo"==a.value?$("<div>").css("color","#FFF").css("background-color","#F20000").css("border-radius","0px").css("border","double 2px #F20000").css("margin","-4px").css("padding","1px").css("font-weight","700").css("text-align","center").append(a.data.ESTATUS_OT).appendTo(b):
"En Tiempo"==a.value&&$("<div>").css("color","#FFF").css("background-color","#dad901").css("border-radius","2px").css("border","double 2px #dad901").css("margin","-4px").css("padding","1px").css("font-weight","700").css("text-align","center").append(a.data.ESTATUS_OT).appendTo(b)}},{caption:"RTSO_I",dataField:"RTSO_I",fixed:!0,fixedPosition:"right",alignment:"center",visible:!1,width:84,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"RTSO_F",dataField:"RTSO_F",fixed:!0,fixedPosition:"right",
alignment:"center",visible:!1,width:87,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"DP",dataField:"DURACION_PROGRAMADA",fixed:!0,fixedPosition:"right",alignment:"center",visible:!1,width:63,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"DR",dataField:"DURACION_REAL",fixed:!0,fixedPosition:"right",alignment:"center",visible:!1,width:63,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"Retrazo",dataField:"RETRAZO",fixed:!0,fixedPosition:"right",
alignment:"center",visible:!0,width:87,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"Al Dia de Hoy",dataField:"ALA_FECHA",fixed:!0,fixedPosition:"right",alignment:"center",visible:!0,width:120,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"DC",dataField:"DC",fixed:!0,fixedPosition:"right",alignment:"center",visible:!1,width:63,dataType:"number",format:{type:"fixedPoint",precision:0}},{caption:"AUTH",dataField:"AUTH",fixed:!0,fixedPosition:"right",alignment:"center",
width:78,dataType:"number",format:{type:"fixedPoint",precision:0}}],summary:{totalItems:[{name:"Total",showInColumn:"OTR_CSCORDENTRABAJO",displayFormat:"Total: {0}",summaryType:"count"}]},onRowDblClick:function(b){console.log(b.data);setTimeout(()=>{var a="TIPO=EDITAR&OT_ID="+b.data.OTR_NEWID;$("#Pop_Open_Ot").dxPopup("show");a="/"+e.patname.split("/")[1]+"/views/Vistas_Ordenes_Trabajo/frm_ots/frm_ots.html?"+a;document.getElementById("Mod_Embebed_Ot").src=a},1E3)}});$("#PivotDG_Orden_Admin").dxPivotGrid({allowSortingBySummary:!0,
allowSorting:!0,allowFiltering:!0,showColumnGrandTotals:!1,showColumnTotals:!1,showRowGrandTotals:!0,showRowTotals:!1,scrolling:{mode:"horizontal"},height:"100%",showBorders:!0,fieldPanel:{showColumnFields:!0,showDataFields:!0,showFilterFields:!0,showRowFields:!0,allowFieldDragging:!0,visible:!0},fieldChooser:{height:500},stateStoring:{enabled:!0,type:"localStorage",storageKey:"dx-widget-gallery-pivotgrid-admin-orden-trabajo"},export:{enabled:!0},onExporting:function(b){let a=new ExcelJS.Workbook,
f=a.addWorksheet("Orden Trabajo");DevExpress.excelExporter.exportPivotGrid({worksheet:f,component:b.component,customizeCell:d}).then(function(){a.xlsx.writeBuffer().then(c)});b.cancel=!0},dataSource:{fields:[{caption:"Fecha de Alta",dataField:"OTR_FECHA_ALTA",icon:"",dataType:"date",format:"yyyy-MMM-dd",alignment:"center",area:"filter"},{caption:"Fecha Programa Fin",dataField:"OTR_FECHA_PROGRAMADA_FIN",dataType:"date",format:"shortDate",alignment:"center",area:"filter"},{caption:"Fecha de Cierre",
dataField:"OTR_FECHA_CIERRE",dataType:"date",format:"shortDate",alignment:"center",area:"filter"},{caption:"Proceso",dataField:"ESTATUS_ORDEN",alignment:"center",area:"column"},{caption:"Tipo de Orden",dataField:"TIPO_ORDEN",alignment:"center",area:"row"},{caption:"Sub Tipo",dataField:"SUB_TIPO",alignment:"center",area:"row"},{caption:"Especialidad",dataField:"TIPO_ESPECIALIDAD_OT",alignment:"center",width:150,area:"row"},{caption:"Conteo",dataField:"OTR_CSCORDENTRABAJO",dataType:"number",summaryType:"count",
alignment:"center",area:"data"},{caption:"Duracion",dataField:"OTR_TIEMPO_REAL",alignment:"center",dataType:"time",summaryType:"sum",area:"data",cellClass:"custom-cell"},{caption:"%",dataField:"OTR_CSCORDENTRABAJO",dataType:"number",summaryType:"count",summaryDisplayMode:"percentOfColumnGrandTotal",area:"data"}]}}).dxPivotGrid("instance");e.cargaArbolTicket()};e.cargaArbolTicket=function(){let d=[{ID:1,CLAVE_ITEM:"INICIAL",NODO_TAG:"INICIAL",DESCRIPCION:k.EMPLEADO_NOMBREEMPLEADO+" "+k.EMPLEADO_APATERNOEMPLEADO+
" "+k.EMPLEADO_AMATERNOEMPLEADO,Task_Parent_ID:0,ICON:"MYUSER"},{ID:2,NODO_TAG:"Asignadas",CLAVE_ITEM:"ASIGNADA",DESCRIPCION:"Ots Asignadas",Task_Parent_ID:1,ICON:"USER"},{ID:3,NODO_TAG:"INTORDEN",CLAVE_ITEM:"INTORDEN",DESCRIPCION:"Ordenes de trabajo",Task_Parent_ID:0,ICON:"FOLDER"},{ID:4,NODO_TAG:"TODAS",CLAVE_ITEM:"TODAS",DESCRIPCION:"Todas",Task_Parent_ID:3,ICON:"TODAS"},{ID:5,NODO_TAG:"NO_OT",CLAVE_ITEM:"NO_OT",DESCRIPCION:"No. OT",Task_Parent_ID:3,ICON:"SEARCH"},{ID:6,NODO_TAG:"ABIERTA",CLAVE_ITEM:"ABIERTA",
DESCRIPCION:"Abiertas",Task_Parent_ID:3,ICON:"ABIERTAS"},{ID:7,NODO_TAG:"CERRADA",CLAVE_ITEM:"CERRADA",DESCRIPCION:"Cerradas",Task_Parent_ID:3,ICON:"CERRADAS"},{ID:8,NODO_TAG:"SINASIGNACION",CLAVE_ITEM:"SINASIGNACION",DESCRIPCION:"No Asignadas",Task_Parent_ID:3,ICON:"SINASIG"},{ID:9,NODO_TAG:"VENC",CLAVE_ITEM:"VENC",DESCRIPCION:"Vencimiento",Task_Parent_ID:0,ICON:"VENCIMIENTO"},{ID:10,NODO_TAG:"OTVENC",CLAVE_ITEM:"OTVENC",DESCRIPCION:"Vencidas",Task_Parent_ID:9,ICON:"VENCIDAS"},{ID:11,NODO_TAG:"OTVENCHOY",
CLAVE_ITEM:"OTVENCHOY",DESCRIPCION:"Vencen Hoy",Task_Parent_ID:9,ICON:"VENCENHOY"},{ID:12,NODO_TAG:"OTVENCP",CLAVE_ITEM:"OTVENCP",DESCRIPCION:"Proximas a Vencer",Task_Parent_ID:9,ICON:"PROXIMASVENCER"}],c=13;$("#__tree_Ot_ADmin").dxTreeView("instance").option("dataSource",d);var g={Tbl:"SAMT_ESTATUS_ORDEN_TRABAJO",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND ESTATUS_ORDEN_ACTIVO = 1"};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",g,getJSON(DeveloperType).ApiGeneral.token).then(b=>
{if(1==b.success){b=b.JsonData;d.push({ID:c,CLAVE_ITEM:"ESTATUS",NODO_TAG:"ESTATUS",DESCRIPCION:"Estatus",Task_Parent_ID:0,ICON:"ESTATUS_OT"});let a=parseInt(c+"");c++;for(const f of b)d.push({ID:c,CLAVE_ITEM:f.ESTATUS_ORDEN_CSC,NODO_TAG:"ESTATUS",DESCRIPCION:f.ESTATUS_ORDEN_IDIOMA1,Task_Parent_ID:a,ICON:"ESTATUS_OT"}),c++;$("#__tree_Ot_ADmin").dxTreeView("instance").option("dataSource",d);h.hide()}});g={Tbl:"SAMT_TIPO_PRIORIDAD_OT",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+
" AND TIPO_PRIORIDAD_ACTIVO = 1"};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",g,getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success){b=b.JsonData;d.push({ID:c,CLAVE_ITEM:"OTPRIORIDAD",NODO_TAG:"OTPRIORIDAD",DESCRIPCION:"Prioridad",Task_Parent_ID:0,ICON:"PRIORIDAD_PARENT"});let a=parseInt(c+"");c++;for(const f of b)d.push({ID:c,CLAVE_ITEM:f.TIPO_PRIORIDAD_CSC,NODO_TAG:"OTPRIORIDAD",DESCRIPCION:f.TIPO_PRIORIDAD_IDIOMA1,Task_Parent_ID:a,ICON:"PRIORIDAD"}),
c++;$("#__tree_Ot_ADmin").dxTreeView("instance").option("dataSource",d);h.hide()}});g={Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND SAMT_TIPO_DEPARTAMENTO_ACTIVO = 1"};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",g,getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success){var a=b.JsonData;d.push({ID:c,CLAVE_ITEM:"OTAREA",NODO_TAG:"OTAREA",DESCRIPCION:"Area",Task_Parent_ID:0,ICON:"AREA_PARENT"});
b=parseInt(c+"");c++;for(const f of a){d.push({ID:c,CLAVE_ITEM:f.EMPLEADO_DEPARTAMENTO_CSC,NODO_TAG:"AREA",DESCRIPCION:f.SAMT_TIPO_DEPARTAMENTO_IDIOMA1,Task_Parent_ID:b,ICON:"AREA_DEPARTAMENTO"});let n=parseInt(c+"");c++;a={Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND SAMT_TIPO_DEPARTAMENTO_ACTIVO = 1 AND TIPO_AREA_CSC = "+f.EMPLEADO_DEPARTAMENTO_CSC};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",
a,getJSON(DeveloperType).ApiGeneral.token).then(l=>{if(1==l.success){l=l.JsonData;for(const m of l)d.push({ID:c,CLAVE_ITEM:m.EMPLEADO_DEPARTAMENTO_CSC,NODO_TAG:"DEPARTAMENTO",DESCRIPCION:m.SAMT_TIPO_DEPARTAMENTO_IDIOMA1,Task_Parent_ID:n,ICON:"AREA_OPERACION"}),c++;$("#__tree_Ot_ADmin").dxTreeView("instance").option("dataSource",d);h.hide()}})}$("#__tree_Ot_ADmin").dxTreeView("instance").option("dataSource",d);h.hide()}})};e.Consulta_Ordenes_Trabajo=function(d){$("#Data_Grid_Ot_Admin").dxDataGrid("instance").option("dataSource",
[]);$("#PivotDG_Orden_Admin").dxPivotGrid("instance").option("dataSource",{store:[]});let c={...ReturnDefaultData_Init()};switch(d.CLAVE_ITEM){case "ASIGNADA":c.OTR_CERRADA=0;c.EMPLEADO_CSC_RESPONSABLE=k.EMPLEADO_CSC_EMPLEADO;break;case "TODAS":c.TIC_FECHA_INICIAL=d.TIC_FECHA_INICIAL+" 00:00:00";c.TIC_FECHA_FINAL=d.TIC_FECHA_FINAL+" 23:59:59";break;case "NO_OT":c.OTR_CSCORDENTRABAJO=d.OTR_CSCORDENTRABAJO;break;case "ABIERTA":c.OTR_CERRADA=0;break;case "CERRADA":c.OTR_CERRADA=1;c.TIC_FECHA_INICIAL=
d.TIC_FECHA_INICIAL+" 00:00:00";c.TIC_FECHA_FINAL=d.TIC_FECHA_FINAL+" 23:59:59";break;case "SINASIGNACION":c.OTR_CERRADA=0;c.EMPLEADO_CSC_RESPONSABLE=0;break;case "OTVENC":c.OTR_CERRADA=0;break;case "OTVENCHOY":c.OTR_CERRADA=0;break;case "OTVENCP":c.OTR_CERRADA=0}switch(d.NODO_TAG){case "ESTATUS":c.ESTATUS_ORDEN_CSC=d.CLAVE_ITEM;break;case "OTPRIORIDAD":c.TIPO_PRIORIDAD_CSC=d.CLAVE_ITEM;break;case "AREA":c.TIPO_AREA_CSC_RESPONSABLE=d.CLAVE_ITEM;c.TIC_FECHA_INICIAL=d.TIC_FECHA_INICIAL+" 00:00:00";
c.TIC_FECHA_FINAL=d.TIC_FECHA_FINAL+" 23:59:59";break;case "DEPARTAMENTO":c.CAT_DEPTO_CSC_RESPONSABLE=d.CLAVE_ITEM,c.TIC_FECHA_INICIAL=d.TIC_FECHA_INICIAL+" 00:00:00",c.TIC_FECHA_FINAL=d.TIC_FECHA_FINAL+" 23:59:59"}c.CLAVE_ITEM=d.CLAVE_ITEM;c.NODO_TAG=d.NODO_TAG;h.show();__Request_Http_Mode(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+"Get_Vista_Orden_Trabajo","GET",c,getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(g=>{1==g.success?($("#Data_Grid_Ot_Admin").dxDataGrid("instance").option("dataSource",
g.JsonData),$("#PivotDG_Orden_Admin").dxPivotGrid("instance").option("dataSource",{store:g.JsonData}),h.hide()):($("#Data_Grid_Ot_Admin").dxDataGrid("instance").option("dataSource",[]),$("#PivotDG_Orden_Admin").dxPivotGrid("instance").option("dataSource",{store:[]}),h.hide(),DevExpress.ui.notify("No se localizo ninguna Ot","success",3E3))}).catch(function(g){$("#Data_Grid_Ot_Admin").dxDataGrid("instance").option("dataSource",[]);$("#PivotDG_Orden_Admin").dxPivotGrid("instance").option("dataSource",
{store:[]});h.hide();DevExpress.ui.notify("Error de de busqueda vueva a intentar nuevamente","error",3E3)})}};setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.init()},1E3);
