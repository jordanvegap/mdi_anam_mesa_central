$(function(){function y(){let b=moment().tz(localStorage.getItem("tmzEmpleado")),c=b.hour(),e=b.minute(),g=b.second();ap=12>c?"<span>AM</span>":"<span>PM</span>";c=v(c);e=v(e);g=v(g);document.getElementById("clock").innerHTML=c+":"+e+":"+g;var h="Dom Lun Mar Mie Jue Vie Sab".split(" ")[b.day()];let n=b.date(),a="Enero Febrero Marzo Abril Mayo Junio Julio Augosto Septiembre Octubre Noviembre Deciembre".split(" ")[b.month()],d=b.year();h=h+", "+n+" "+a+" "+d;document.getElementById("date").innerHTML=
h;setTimeout(function(){y()},500);return`${v(b.date())}/${v(b.month())}/${b.year()} ${c}:${e}:${g}`}function v(b){10>b&&(b="0"+b);return b}function z(b,c,e){c="data:image/png;base64,"+toBase64(b.MNU_IMAGEN_PEQUENIA_ACTIVO.data);e.append($('<img src="'+c+'" class="navIcon" alt="Icon Menu"/>')).append($("<span>").text(b.MNU_DESCRIPCION1)).append($("<i>").addClass("dx-icon").addClass("dx-icon-close").click(function(){A(b,e)}))}function B(b,c,e){b="frm_ticket_compartido"==b.MNU_WEB_ARCHIVO?"views/"+b.MNU_WEB_ARCHIVO+
"/"+b.MNU_WEB_ARCHIVO+".html?v="+Math.random().toString(36).substr(2,9)+"&TIPO=ALTA&CSC_MESA=1&TK_ID=D7996A9E-9D6A-4223-8372-5399F4798EAE&TPO_USUARIO=GENERA":"views/"+b.MNU_WEB_ARCHIVO+"/"+b.MNU_WEB_ARCHIVO+".html?v="+Math.random().toString(36).substr(2,9);c=document.createElement("iframe");c.setAttribute("id","frame-"+Math.random().toString(36).substr(2,9));c.setAttribute("src",b);c.setAttribute("scrolling","auto");c.style.border="none";c.style.position="absolute";c.style.width="100%";c.style.height=
"100%";b=$("<div/>").append(c);c=$("<div>").css({height:"100%"});b.appendTo(c);c.appendTo(e);c.dxScrollView({scrollByContent:!0,scrollByThumb:!0})}function A(b,c){b&&(console.log(sessionStorage.getItem("FirmadoServicioSura")),"true"==sessionStorage.getItem("FirmadoServicioSura")?DevExpress.ui.dialog.alert("<div style='text-align:center'> <img src='./images/AsisVritual_Warning.svg' width='120'> <br> <i>POR FAVOR DESFIRMESE DEL SERVICIO</i></div>","FIRMADO A SERVICIO").done(function(e){console.log(e)}):
(b=p.option("dataSource").indexOf(b),c=p.option("dataSource"),c.splice(b,1),p.option("dataSource",c),b>=c.length&&0<b&&p.option("selectedIndex",b-1)))}function C(b){let c=[],e={};for(let g=0;g<b.length;g++){let h=Object.keys(b[g]);h.sort(function(a,d){return a-d});let n="";for(let a=0;a<h.length;a++)n+=JSON.stringify(h[a]),n+=JSON.stringify(b[g][h[a]]);e.hasOwnProperty(n)||(c.push(b[g]),e[n]=!0)}return c}function D(){if(1==r.USU_CODESQUEMASEG)try{let b={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),
Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),USU_CSC_USUARIO:r.USU_CSC_USUARIO,USU_CODESQUEMASEG:r.USU_CODESQUEMASEG};__Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+"GetMenuWebUsuario","GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{!0===c.success?(q=c.JsonData,$("#dxMenuMdi").dxTreeView("instance").option("dataSource",q),$("#splashscreen").fadeOut(1E3)):DevExpress.ui.notify("No cuentas con menus asignados, Comunicate con Recursos Humanos",
"error",1E4)})}catch(b){console.log(b)}else try{let b={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),USU_CSC_USUARIO:r.USU_CSC_USUARIO,USU_CODESQUEMASEG:r.USU_CODESQUEMASEG};__Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+"GetMenuWebUsuario","GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{!0===c.success?(q=c.JsonData,c={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),
Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),USU_CODESQUEMASEG:1},__Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+"GetMenuWebUsuario","GET",c,getJSON(DeveloperType).ApiGeneral.token).then(e=>{var g=e.JsonData;let h=[],n=[];if(!0===e.success){q=C(q);for(let a=0;a<q.length;a++)null!=q[a].MNU_CSC_MENU_PADRE&&(e=g.find(d=>d.MNU_CSC_MENU==q[a].MNU_CSC_MENU_PADRE),h.push(e));if(1<=h.length){for(let a=0;a<h.length;a++)null!=h[a].MNU_CSC_MENU_PADRE&&
(e=g.find(d=>d.MNU_CSC_MENU==h[a].MNU_CSC_MENU_PADRE),n.push(e));g=unikeByList(n,a=>a.MNU_CSC_MENU);g=unikeByList(h,a=>a.MNU_CSC_MENU).concat(q,g);$("#dxMenuMdi").dxTreeView("instance").option("dataSource",g)}else DevExpress.ui.notify("No cuentas con menus asignados, Comunicate con Recursos Humanos","error",1E4);$("#splashscreen").fadeOut(1E3)}})):(DevExpress.ui.notify("No cuentas con menus asignados, Comunicate con Recursos Humanos","error",1E4),$("#splashscreen").fadeOut(1E3))})}catch(b){console.log(b)}}
localStorage.getItem("__isLogin");let E=[],q=[],r=null,t=null;document.getElementById("statusSocketConectivity");document.getElementById("sonidoNotificacion");let p=null;self.TimeZoneServidor=localStorage.getItem("tmzServidor");self.TimeZoneEmpleado=localStorage.getItem("tmzEmpleado");self.intervalRenewSS=setInterval(()=>{renewSession()},3E5);self.intervalUpdateFirmaSistema=setInterval(()=>{},18E4);if(isAuthenticated()){Globalize.loadMessages(dictionary);var w=c();Globalize.locale(w);renewSession();
w={inputAttr:{id:"selectInput"},dataSource:locales,displayExpr:"name",valueExpr:"value",value:w,fieldTemplate:function(a,d){let k=$("<div class='custom-item'><img src='"+(a?a.ImageSrc:"")+"' /><div class='product-name'></div></div>");k.find(".product-name").dxTextBox({value:a&&a.name,readOnly:!0});d.append(k)},itemTemplate:function(a){return"<div class='custom-item'><img src='"+a.ImageSrc+"' /><div class='product-name'>"+a.name+"</div></div>"},onValueChanged:b};$("#selectBox").dxSelectBox(w);function b(a){sessionStorage.setItem("locale",
a.value);document.location.reload()}function c(){let a=sessionStorage.getItem("locale");return null!=a?a:"es"}$("#txt_EstatusSession").html(Globalize.formatMessage("LoadText"));r=JSON.parse(localStorage.getItem("obj_SessionInfo"));t=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));n();let e=$("#PanleLoadWindow").dxLoadPanel({shadingColor:"rgba(0,0,0,0.4)",visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1,onShown:function(){setTimeout(function(){e.hide()},3E3)}}).dxLoadPanel("instance"),
g=t.EMPLEADO_NOMBREEMPLEADO+" "+t.EMPLEADO_APATERNOEMPLEADO;document.getElementById("Logo_Des_Preload").style.backgroundImage="url(images/Logotipos/"+localStorage.getItem("SkinWeb")+"/logo.svg)";document.getElementById("Logo_Des_mini").src="images/Logotipos/"+localStorage.getItem("SkinWeb")+"/logo_head.svg";p=$("#Mdi__T__Panel").dxTabPanel({noDataText:"",dataSource:E.slice(0,0),itemTitleTemplate:z,itemTemplate:B,deferRendering:!0,showNavButtons:!0,repaintChangesOnly:!0,scrollByContent:!0,scrollingEnabled:!0}).dxTabPanel("instance");
let h=$("#drawer").dxDrawer({opened:!0,closeOnOutsideClick:!1,template:function(){const a=$("<div style='overflow:hidden;position:relative;'>").width(180).height("100%");var d=$("<div id='dxMenuMdi' style='display: flex; flex-direction: column;flex-grow: 1;overflow:hidden; position:relative;'>");d.dxTreeView({dataSource:[],showScrollbar:"always",dataStructure:"plain",selectionMode:"single",activeStateEnabled:!1,hoverStateEnabled:!1,focusStateEnabled:!1,selectByClick:!1,searchEnabled:!1,expandEvent:"click",
height:"100%",keyExpr:"MNU_CSC_MENU",displayExpr:"MNU_DESCRIPCION1",parentIdExpr:"MNU_CSC_MENU_PADRE",itemTemplate:function(f,l,u){l="data:image/png;base64,"+toBase64(f.MNU_IMAGEN_GRANDE_ACTIVO.data);f=4==f.TIPO_MENU_CSC?$("<div class='Sub_Menu_center'/>").attr({style:"display: flex; flex-direction: column;flex-grow: 1; "}).append('<div class="text">'+f.MNU_DESCRIPCION1+'</div><div class="imagen"><img src="'+l+'" alt="person on a tour" class="slice_img"></div>'):$("<div class='Menu_center'/>").attr({style:"display: flex; flex-direction: column;flex-grow: 1; "}).append('<div class="Menu_center_k"><div class="Menu_center_caption">'+
f.MNU_DESCRIPCION1+'</div></div><div class="Menu_center_img"><img src="'+l+'" alt="person on a tour" class="Menu_center_img_sice"></div>');u.append(f)},onItemClick:function(f){if(4===f.itemData.TIPO_MENU_CSC){let l=p.option("dataSource");f=f.itemData;let u=!1;if(0==l.length)l.push(f),p.option("dataSource",l),p.option("selectedItem",f);else{for(let m=0;m<l.length;m++)f.MNU_CSC_MENU==l[m].MNU_CSC_MENU&&(u=!0,p.option("selectedItem",f));u||(l.push(f),p.option("dataSource",l),p.option("selectedItem",
f))}}}}).dxTreeView("instance");let k="";k=null==t.EMPLEADO_PATHFOTO?"images/descarga.png":"data:image/png;base64,"+toBase64(t.EMPLEADO_PATHFOTO.data);d=$("<div />").attr({style:"display: flex; flex-direction: column;flex-grow: 1;height:100%;"}).append('<div class="HeadBgInfoEmp"><div class="story_shape"><img src="'+k+'" alt="person on a tour" class="story_img"></div><div class="story_caption"> <span style="font-size: 10px;color: #FFFFFF;" id="EmplLogin">'+g+'</span> </br> <span style="font-size: 9px;color: #FFFFFF;" id="PueEmpLogin"> '+
Globalize.formatMessage("NoEmpleado")+": "+t.EMPLEADO_ID_EXTERNO+" </span></div></div>","<div class='heading_InnerFrm'><h2>Men\u00fa General</h2></div>",d,'<div class="container-shadow" style="padding: 3px;"><img id="statusSocketConectivity" style="width:16px; height:16px;" src="images/Icons/SocketOnline.gif" alt="Estatus Socket"> <span style="font-size: 10px;color: #000000;" id="EstatusConexionSocket">ONLINE</span></div>');document.getElementById("statusSocketConectivity");return a.append(d)}}).dxDrawer("instance");
setTimeout(()=>{D()},3E3);$("#btnFinalizar").dxButton({icon:"images/Icons/Apps-Dialog-Shutdown-icon64.png",text:Globalize.formatMessage("LogOut"),onClick:function(){setTimeout(()=>{localStorage.clear();sessionStorage.clear();clearInterval(self.intervalRenewSS);clearInterval(self.intervalUpdateFirmaSistema);const a=document.cookie.split(";");for(let k=0;k<a.length;k++){var d=a[k];const f=d.indexOf("=");d=-1<f?d.substr(0,f):d;document.cookie=`${d}=; expires=${(new Date(0)).toUTCString()}; path=/;`}location.href=
"index.html"},2E3)}});$("#btnMenuGeneral").dxButton({icon:"images/Icons/MenuIcon.png",text:"MENU",onClick:function(){h.toggle()}});$("#btnVerErrores").dxButton({icon:"images/Icons/SinAtencion.png",text:Globalize.formatMessage("errorLogBtn"),onClick:function(){ErrorDB.obtenerErrores().then(function(a){console.log(a)}).catch(function(a){console.error(a)})}});btnVerErrores;$("#VersionCode").html("VERSION: "+getJSON(DeveloperType).VersionCode);$("#NombreEmpresa").html("AT&T");y();setTimeout(()=>{$("#login").val(g)},
2E3);function n(){try{let a={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),EMPLEADO_CSC_EMPLEADO:t.EMPLEADO_CSC_EMPLEADO,USU_CODESQUEMASEG:r.USU_CODESQUEMASEG};__Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+"Get_Empleado_Servicios_Full/","GET",a,getJSON(DeveloperType).ApiGeneral.token).then(d=>{sessionStorage.setItem("serv_empl",JSON.stringify(d.JsonData));return d})}catch(a){console.log(a)}try{__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+
"Get_Cat","GET",{Tbl:"SAMT_TIPO_ORIGEN_FOTO",NACTIVE:"TIPO_ORIGEN_ACTIVO",NDEFAULT:"TIPO_ORIGEN_DEFAULT"},getJSON(DeveloperType).ApiGeneral.token).then(a=>{if(!0===a.success)return sessionStorage.setItem("cat_origen_foto",JSON.stringify(a.JsonData)),a.JsonData;console.log(a.message)})}catch(a){console.log(a)}try{__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat","GET",{Tbl:"SAMT_CAT_PROCESO_EMPLEADOS",NACTIVE:"CAT_PROCESO_EMP_ACTIVO"},getJSON(DeveloperType).ApiGeneral.token).then(a=>
{if(!0===a.success)return sessionStorage.setItem("Cat_Proceso_Empleados",JSON.stringify(a.JsonData)),a.JsonData;console.log(a.message)})}catch(a){console.log(a)}try{__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat","GET",{Tbl:"SAMT_CAT_SUBPROCESO_EMPLEADOS",NACTIVE:"CAT_SUBPROCESO_EMP_ACTIVO"},getJSON(DeveloperType).ApiGeneral.token).then(a=>{if(!0===a.success)return sessionStorage.setItem("Cat_Sub_Proceso_Empleados",JSON.stringify(a.JsonData)),a.JsonData;console.log(a.message)})}catch(a){console.log(a)}try{__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+
"Get_Cat","GET",{Tbl:"SAMT_CAT_ESTATUS_PROCESO_MPLEADOS",NACTIVE:"CAT_ESTATUS_PROCESO_EMP_ACTIVO"},getJSON(DeveloperType).ApiGeneral.token).then(a=>{if(!0===a.success)return sessionStorage.setItem("Cat_Estatus_Empleados",JSON.stringify(a.JsonData)),a.JsonData;console.log(a.message)})}catch(a){console.log(a)}setTimeout(()=>{var a=JSON.parse(sessionStorage.getItem("Cat_Proceso_Empleados")),d=JSON.parse(sessionStorage.getItem("Cat_Sub_Proceso_Empleados")),k=JSON.parse(sessionStorage.getItem("Cat_Estatus_Empleados"));
a=jslinq(a).where(function(m){return"ACTIVO"==m.CAT_PROCESO_EMP_CLAVE.trim()}).toList();d=jslinq(d).where(function(m){return"OPER"==m.CAT_SUBPROCESO_EMP_CLAVE.trim()}).toList();k=jslinq(k).where(function(m){return"ACT"==m.CAT_ESTATUS_PROCESO_EMP_CLAVE.trim()}).toList();let f=a[0].CAT_PROCESO_EMP_CSC,l=d[0].CAT_SUBPROCESO_EMP_CSC,u=k[0].CAT_ESTATUS_PROCESO_EMP_CSC;setTimeout(()=>{try{let m={...ReturnDefaultData_Init(),TIPO_CONSULTA:"AVANZADO",CAT_PROCESO_EMP_CSC:f,CAT_SUBPROCESO_EMP_CSC:l,CAT_ESTATUS_PROCESO_EMP_CSC:u,
INFO:"ALLEMP"};__Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+"GetEmpleado","GET",m,getJSON(DeveloperType).ApiGeneral.token).then(x=>{!0===x.success?sessionStorage.setItem("all_emp_host",JSON.stringify(x.JsonData)):sessionStorage.setItem("all_emp_host",[]);return x})}catch(m){console.log(m)}},1E3)},3E3);ErrorDB.abrirDB().then(function(a){console.log(a)}).catch(function(a){console.error(a)})}}else location.replace("index.html")});
