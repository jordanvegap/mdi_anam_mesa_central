SalesDashboard.dashboardModel=function(){function x(d,b,c){p.show();let f={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),CAM_MESA_CSC:b};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ensamble_Mesa_Ayuda","GET",f,getJSON(DeveloperType).ApiTickets_v2.token).then(e=>{if(1==e.success)if(e=e.JsonData[0],null==e.CAM_MESA_IFRAMEWEB)DevExpress.ui.notify("Error no se identifico mesa de ayuda",
"error",3E3);else{let r="TIPO="+d+"&CSC_MESA="+b+"&TK_ID="+c+"&TPO_USUARIO="+a.TipoUsuario,w="/"+a.patname.split("/")[1]+"/views/Vistas_Mesas_Ayuda/"+e.CAM_MESA_IFRAMEWEB+"/"+e.CAM_MESA_IFRAMEWEB+".html?"+r;$("#Pop_Mesa_Ayuda_Config").dxPopup("instance").option("contentTemplate",function(t){return $('<div style="height:100%;">').append("<iframe src="+w+' width="100%" height="100%" scrolling="auto" frameBorder="0" style=" flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;"></iframe>')});$("#Pop_Mesa_Ayuda_Config").dxPopup("show");
p.hide()}else DevExpress.ui.notify("Error no se identifico mesa de ayuda","error",1E4)}).catch(function(e){DevExpress.ui.notify("Error mesa de ayuda no localizada intente nuevamnete","error",1E4)})}let a=this,h=null;this.Nombre;this.Apellido;this.Estatus=null;let y=[],k=null;a.MisServiciosActivosTickets=[];a.FechaPromesaDefecto=86400;a.__Temp_Ult_Consulta={};let p=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance");
a.TipoUsuario="ADMIN";a.TimeZoneServidor=localStorage.getItem("tmzServidor");a.TimeZoneEmpleado=localStorage.getItem("tmzEmpleado");a.TiempoUTCEmpleado=DiferencieTimeZones();a.__DataSource_Tickets_Grid_Admin=new DevExpress.data.ArrayStore({data:[]});a.__DataSource_Tipificaiones=new DevExpress.data.ArrayStore({data:[]});a._ClienteProyectoCampania_ObjData=new DevExpress.data.ArrayStore({data:[]});a.idServiciosUsuario={};a.init=function(){$("#splashscreen").fadeOut(1E3);Globalize.loadMessages(dictionary);
var d=function(){let b=sessionStorage.getItem("locale");return null!=b?b:"es"}();Globalize.locale(d);DevExpress.localization.locale(d);$("#adm_title_ms").html(Globalize.formatMessage("adm_title_ms"));$("#adm_title_grid").html(Globalize.formatMessage("adm_title_grid"));a.patname=window.location.pathname;h=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));$("#Mod_Tab_Reporte_Sura").dxTabPanel({animationEnabled:!1,deferRendering:!1,repaintChangesOnly:!1,dataSource:[{title:"Grid General",template:"tab_gridGeneral",
icon:"./images/Icons/Todos.png"}]});$("#treeTicketAdmin").dxTreeView({dataSource:[],height:"100%",showScrollbar:"always",dataStructure:"plain",selectionMode:"single",activeStateEnabled:!1,hoverStateEnabled:!1,focusStateEnabled:!1,selectByClick:!1,searchEnabled:!1,expandEvent:"click",keyExpr:"ID",displayExpr:"DESCRIPCION",parentIdExpr:"Task_Parent_ID",autoExpandAll:!1,itemTemplate:function(b,c,f){c=document.createElement("span");c.className="menu_item "+b.ICON;f.append(c);c=document.createElement("span");
c.className="item-text";c.innerText=b.DESCRIPCION;f.append(c)},onItemClick:function(b){a.__Temp_Ult_Consulta={};let c=b.itemData;k=a.MisServiciosActivosTickets.join(",");if(0==c.CAM_MESA_CSC)switch(c.CLAVE_ITEM){case "MTA_TODO":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTA_NO_TK":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTA_ABIERTAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=
h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "MTA_CERRADAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_ATIENDE=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_TODO":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MTC_NO_TK":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=
h.EMPLEADO_CSC_EMPLEADO;$("#Dialog_Busqueda_No_Ticket").dxPopup("show");break;case "MTC_ABIERTAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "MTC_CERRADAS":a.__Temp_Ult_Consulta.EMPLEADO_CSC_SOLICITA=h.EMPLEADO_CSC_EMPLEADO;a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_ABIERTAS":if(""==k||null==k){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable",
"info",3E3);break}a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=k;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "MSA_CERRADAS":if(""==k||null==k){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3);break}a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=k;a.__Temp_Ult_Consulta.BYFC=!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_TODO":if(""==k||null==k){DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable",
"info",3E3);break}a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=k;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "MSA_NO_TK":""==k||null==k?DevExpress.ui.notify("No tiene niguna mesa de ayuda administrable","info",3E3):(a.__Temp_Ult_Consulta.CAM_MESA_CSC_IN=k,$("#Dialog_Busqueda_No_Ticket").dxPopup("show"))}else if(0!=c.CAM_MESA_CSC)switch(a.__Temp_Ult_Consulta={},b=b.itemData,b.CLAVE_ITEM){case "ALTATICKET":null==b.IFRAMEWEB?DevExpress.ui.notify("Error no se identifico mesa de ayuda","error",3E3):
(a.__Temp_Ult_Consulta.TIC_CERRADO=0,a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC,x("ALTA",b.CAM_MESA_CSC,null));break;case "TODAS":a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ABIERTAS":a.__Temp_Ult_Consulta.TIC_CERRADO=0;a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC;a.ConsultaTickets(a.__Temp_Ult_Consulta);break;case "CERRADAS":a.__Temp_Ult_Consulta.TIC_CERRADO=1;a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC;a.__Temp_Ult_Consulta.BYFC=
!0;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ESTATUS":a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC;a.__Temp_Ult_Consulta.ESTATUS_CSC=b.ESTATUS_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ITEMSEVERIDAD":a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC;a.__Temp_Ult_Consulta.SEVERIDAD_CSC=b.SEVERIDAD_CSC;$("#Dialog_Busqueda_Fecha").dxPopup("show");break;case "ITEMPRIORIDAD":a.__Temp_Ult_Consulta.CAM_MESA_CSC=b.CAM_MESA_CSC,a.__Temp_Ult_Consulta.PRIORIDAD_CSC=b.PRIORIDAD_CSC,
$("#Dialog_Busqueda_Fecha").dxPopup("show")}}});$("#Pop_Mesa_Ayuda_Config").dxPopup({hideOnOutsideClick:!1,title:"Detalles",height:"90%",width:"70%",position:{my:"center",at:"center",of:window},onHiding:function(b){b.component.content().empty();a.ConsultaTickets(a.__Temp_Ult_Consulta)},onShowing:function(b){},onShown:function(b){}});a.DataGridTicketsAdmin=$("#Data_Grid_Ticket_Admin").dxDataGrid({dataSource:a.__DataSource_Tickets_Grid_Admin,deferRendering:!0,allowColumnResizing:!0,height:"100%",filterRow:{visible:!1},
filterPanel:{visible:!0},headerFilter:{visible:!0},keyExpr:"TIC_CSCTICKET",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!1,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!0,export:{enabled:!0},onExporting:function(b){let c=new ExcelJS.Workbook,f=c.addWorksheet("Hoja1");
DevExpress.excelExporter.exportDataGrid({worksheet:f,component:b.component,customizeCell:function(e){e.font={name:"Arial",size:12};e.alignment={horizontal:"left"}}}).then(function(){c.xlsx.writeBuffer().then(function(e){saveAs(new Blob([e],{type:"application/octet-stream"}),"Tickets_"+moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss")+".xlsx")})});b.cancel=!0},columns:[{caption:"TICKET",dataField:"TIC_CSCTICKET",fixed:!0,fixedPosition:"left",alignment:"center",sortOrder:"desc",width:130},
{caption:"FOLIO PROVEEDOR",dataField:"TIC_ID_EXTERNO_PROVEEDOR",fixed:!0,fixedPosition:"left",alignment:"center",width:180},{caption:"INICIATIVA",dataField:"PM_CSC_PROYECTO_SOLICITA",alignment:"left",width:230,lookup:{displayExpr:"PM_NOMBRE",valueExpr:"PM_CSC_PROYECTO",dataSource:{store:new DevExpress.data.CustomStore({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_PROYECTOS"},getJSON(DeveloperType).ApiGeneral.token).then(b=>
{if(1==b.success)return b.JsonData;console.log(b.message)})}catch(b){console.log(b)}}})}}},{caption:"FECHA ALTA",dataField:"fecha_alta_timezone",alignment:"center",dataType:"datetime",format:"dd/MM/yyyy HH:mm:ss",width:130},{caption:"COMENTARIOS DE SOLICITUD",dataField:"TIC_DESCRIPCION",alignment:"left",width:380}],summary:{totalItems:[{name:"Total",showInColumn:"TIC_CSCTICKET",displayFormat:"Total: {0}",summaryType:"count"}]},onRowDblClick:function(b){x("EDITAR",b.data.CAM_MESA_CSC,b.data.TIC_NEWID)}}).dxDataGrid("instance");
$("#Dialog_Busqueda_Fecha").dxPopup({hideOnOutsideClick:!1,title:"PARAMETROS",height:function(){return 160},width:function(){return 400},position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div/>").append("Selecciona un rango de fechas.").attr({style:"font-size: 12px; margin-bottom: 5px; "}),$("<div/>").append("**Se recomienda realizar busquedas en bloques no mayores a 3 meses.").attr({style:"font-size: 10px; margin-bottom: 5px; color:red;"}),
$("<div />").attr({id:"Form_Busqueda_Fecha",style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_Fecha_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{dataField:"TIC_FECHA_INICIAL",label:{text:"Fecha Inicial"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy",max:new Date},validationRules:[{type:"required",
message:"Fecha requerida"}]},{dataField:"TIC_FECHA_FINAL",label:{text:"Fecha Final"},editorType:"dxDateBox",editorOptions:{type:"date",disabled:!1,dateSerializationFormat:"yyyy-MM-dd",displayFormat:"dd/MM/yyyy",max:new Date},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_Fecha").dxForm("instance").resetValues();
$("#Form_Busqueda_Fecha").dxForm("instance").option("formData",{});$("#Dialog_Busqueda_Fecha").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},onClick(){var c=$("#Form_Busqueda_Fecha").dxForm("instance");c.validate().isValid?(c=c.option("formData"),a.__Temp_Ult_Consulta.TIC_FECHA_INICIAL=c.TIC_FECHA_INICIAL+" 00:00:00",a.__Temp_Ult_Consulta.TIC_FECHA_FINAL=c.TIC_FECHA_FINAL+
" 23:59:59",a.ConsultaTickets(a.__Temp_Ult_Consulta),$("#Dialog_Busqueda_Fecha").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}}]}]}))}});$("#Dialog_Busqueda_No_Ticket").dxPopup({hideOnOutsideClick:!1,title:"BUSQUEDA DE TICKET",height:function(){return 120},width:function(){return 400},position:{my:"center",at:"center",of:window},onShowing:function(b){},contentTemplate:function(b){b.attr({style:"display: flex; flex-direction: column;"});b.append($("<div />").attr({id:"Form_Busqueda_No_Ticket",
style:"border: solid red 0px; margin-bottom: 5px; "}).dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Busqueda_No_Ticket_Validation",labelMode:"static",labelLocation:"top",items:[{itemType:"group",colCount:2,items:[{colSpan:2,editorType:"dxNumberBox",dataField:"TIC_CSCTICKET",label:{text:"No. Ticket"},editorOptions:{disabled:!1},validationRules:[{type:"required",message:"Fecha requerida"}]},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Cancelar",
icon:"remove",type:"danger",width:"100%",visible:!0,onInitialized:function(c){},onClick(){$("#Form_Busqueda_No_Ticket").dxForm("instance").resetValues();$("#Form_Busqueda_No_Ticket").dxForm("instance").option("formData",{});$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")}}},{itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Buscar",icon:"search",type:"default",width:"100%",visible:!0,onInitialized:function(c){},onClick(){var c=$("#Form_Busqueda_No_Ticket").dxForm("instance");
c.validate().isValid?(c=c.option("formData"),a.__Temp_Ult_Consulta.TIC_CSCTICKET=c.TIC_CSCTICKET,a.ConsultaTickets(a.__Temp_Ult_Consulta),$("#Dialog_Busqueda_No_Ticket").dxPopup("hide")):DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO","error",300)}}}]}]}))}});d={Tbl:"SAMT_CAM_SERVICIO",WHR:" EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",d,getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success){b=
b.JsonData;for(let c=0;c<b.length;c++)y.push(b[c].CAM_MESA_CSC)}});a.cargaArbolTicket()};a.cargaArbolTicket=function(){let d=[];d.push({ID:1,CAM_MESA_CSC:0,CLAVE_ITEM:"INICIAL",DESCRIPCION:h.EMPLEADO_NOMBREEMPLEADO+" "+h.EMPLEADO_APATERNOEMPLEADO+" "+h.EMPLEADO_AMATERNOEMPLEADO,Task_Parent_ID:0,ICON:"MYUSER"});d.push({ID:12,CAM_MESA_CSC:0,CLAVE_ITEM:"ALLTICKETSMS",DESCRIPCION:Globalize.formatMessage("adm_tk_tree"),Task_Parent_ID:0,ICON:"FOLDER"},{ID:13,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_TODO",DESCRIPCION:Globalize.formatMessage("adm_tk_all"),
Task_Parent_ID:12,ICON:"TODAS"},{ID:14,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_NO_TK",DESCRIPCION:"No. Ticket",Task_Parent_ID:12,ICON:"SEARCH"},{ID:15,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:12,ICON:"ABIERTAS"},{ID:16,CAM_MESA_CSC:0,CLAVE_ITEM:"MSA_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:12,ICON:"CERRADAS"});d.push({ID:2,CAM_MESA_CSC:0,CLAVE_ITEM:"INIT_MTC",DESCRIPCION:"Mis ticket's generados",Task_Parent_ID:1,ICON:"MTG"},{ID:3,CAM_MESA_CSC:0,CLAVE_ITEM:"MTC_TODO",
DESCRIPCION:"Todas",Task_Parent_ID:2,ICON:"TODAS"},{ID:4,CAM_MESA_CSC:0,CLAVE_ITEM:"MTC_NO_TK",DESCRIPCION:"No. Ticket",Task_Parent_ID:2,ICON:"SEARCH"},{ID:5,CAM_MESA_CSC:0,CLAVE_ITEM:"MTC_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:2,ICON:"ABIERTAS"},{ID:6,CAM_MESA_CSC:0,CLAVE_ITEM:"MTC_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:2,ICON:"CERRADAS"});let b=18,c={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),Type:localStorage.getItem("Type"),
EMPLEADO_CSC_EMPLEADO:h.EMPLEADO_CSC_EMPLEADO,TPO_USUARIO:a.TipoUsuario};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Mesa_Empleado","GET",c,getJSON(DeveloperType).ApiTickets_v2.token).then(f=>{if(1==f.success){let e=f.JsonData;f={Tbl:"SAMT_ESTATUS_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",f,getJSON(DeveloperType).ApiGeneral.token).then(r=>{if(1==r.success){let w=r.JsonData;
r={Tbl:"SAMT_TIPO_SEVERIDAD",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_SEVERIDAD_TICKET_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",r,getJSON(DeveloperType).ApiGeneral.token).then(t=>{if(1==t.success){let z=t.JsonData;t={Tbl:"SAMT_TIPO_PRIORIDAD_TICKET",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_PRIORIDAD_ACTIVO = 1 "};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+
"Get_Cat_Whr","GET",t,getJSON(DeveloperType).ApiGeneral.token).then(v=>{if(1==v.success){v=v.JsonData;for(let g=0;g<e.length;g++){a.MisServiciosActivosTickets.push(e[g].CAM_MESA_CSC);var l=parseInt(b+"");d.push({ID:l,CLAVE_ITEM:"SERVICIO",CAM_MESA_CSC:e[g].CAM_MESA_CSC,DESCRIPCION:e[g].CAM_MESA_IDIOMA1,Task_Parent_ID:0,ICON:"SERVICIO"});4!=e[g].CAM_MESA_CSC&&(b++,d.push({ID:b,CLAVE_ITEM:"ALTATICKET",DESCRIPCION:"Generar nuevo ticket",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"ADD",IFRAMEWEB:e[g].CAM_MESA_IFRAMEWEB}));
b++;d.push({ID:b,CLAVE_ITEM:"TODAS",DESCRIPCION:"Todas",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"TODAS"});b++;d.push({ID:b,CLAVE_ITEM:"ABIERTAS",DESCRIPCION:"Abiertas",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"ABIERTAS"});b++;d.push({ID:b,CLAVE_ITEM:"CERRADAS",DESCRIPCION:"Cerradas",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"CERRADAS"});b++;var q=parseInt(b+"");d.push({ID:q,CLAVE_ITEM:"PROCESO",DESCRIPCION:"Proceso",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,
ICON:"PROCESO"});b++;var m=jslinq(w).where(function(u){return u.CAM_MESA_CSC==e[g].CAM_MESA_CSC}).toList();for(var n=0;n<m.length;n++)d.push({ID:b,CLAVE_ITEM:"ESTATUS",DESCRIPCION:m[n].ESTATUS_TICKET_IDIOMA1,ESTATUS_CSC:m[n].ESTATUS_TICKET_CSC,CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:q,ICON:"ESTATUS"}),b++;b++;q=parseInt(b+"");d.push({ID:q,CLAVE_ITEM:"SEVERIDAD",DESCRIPCION:"Severidad",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"SEVERIDAD"});b++;m=jslinq(z).where(function(u){return u.CAM_MESA_CSC==
e[g].CAM_MESA_CSC}).toList();for(n=0;n<m.length;n++)d.push({ID:b,CLAVE_ITEM:"ITEMSEVERIDAD",DESCRIPCION:m[n].TIPO_SEVERIDAD_TICKET_IDIOMA1,SEVERIDAD_CSC:m[n].TIPO_SEVERIDAD_CSC,CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:q,ICON:"ITEMSEVERIDAD"}),b++;b++;q=parseInt(b+"");d.push({ID:q,CLAVE_ITEM:"PRIORIDAD",DESCRIPCION:"Prioridad",CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:l,ICON:"PRIORIDAD"});b++;l=jslinq(v).where(function(u){return u.CAM_MESA_CSC==e[g].CAM_MESA_CSC}).toList();for(m=0;m<l.length;m++)d.push({ID:b,
CLAVE_ITEM:"ITEMPRIORIDAD",DESCRIPCION:l[m].TIPO_PRIORIDAD_IDIOMA1,PRIORIDAD_CSC:l[m].TIPO_PRIORIDAD_CSC,CAM_MESA_CSC:e[g].CAM_MESA_CSC,Task_Parent_ID:q,ICON:"ITEMPRIORIDAD"}),b++;b++}d.push({ID:7,CAM_MESA_CSC:0,CLAVE_ITEM:"INIT_MTA",DESCRIPCION:"Mis ticket's asignados",Task_Parent_ID:1,ICON:"MTA"},{ID:8,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_TODO",DESCRIPCION:"Todas",Task_Parent_ID:7,ICON:"TODAS"},{ID:9,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_NO_TK",DESCRIPCION:"No. Ticket",Task_Parent_ID:7,ICON:"SEARCH"},{ID:10,
CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_ABIERTAS",DESCRIPCION:"Abiertas",Task_Parent_ID:7,ICON:"ABIERTAS"},{ID:11,CAM_MESA_CSC:0,CLAVE_ITEM:"MTA_CERRADAS",DESCRIPCION:"Cerradas",Task_Parent_ID:7,ICON:"CERRADAS"});$("#treeTicketAdmin").dxTreeView("instance").option("dataSource",d);p.hide()}})}})}})}else $("#treeTicketAdmin").dxTreeView("instance").option("dataSource",d),p.hide()});p.hide();setTimeout(()=>{let f={EMPLEADO_CSC_ATIENDE:h.EMPLEADO_CSC_EMPLEADO,TIC_CERRADO:0};a.__Temp_Ult_Consulta=f;a.ConsultaTickets(f)},
1E3)};a.ConsultaTickets=function(d){a.__DataSource_Tickets_Grid_Admin.clear();let b={...ReturnDefaultData_Init()};d=Object.assign(b,d,{CAM_CSC_SERVICIO_SOLICITA_IN:a.idServiciosUsuario,TIC_REQ_AUTORIZACION:0});p.show();__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Servicio","GET",d,getJSON(DeveloperType).ApiTickets_v2.token).then(c=>{1==c.success?c.JsonData.forEach(function(f){a.__DataSource_Tickets_Grid_Admin.insert(f)}):a.__DataSource_Tickets_Grid_Admin.clear();a.DataGridTicketsAdmin.refresh();
p.hide()}).catch(function(c){a.__DataSource_Tickets_Grid_Admin.clear();a.DataGridTicketsAdmin.refresh();p.hide();DevExpress.ui.notify("Eror de de busqueda vueva a intentar nuevamente","error",3E3)})};a.run=function(){a.getPermisosEmpleadoServicios()};a.getPermisosEmpleadoServicios=async function(){var d=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));d={...ReturnDefaultData_Init(),EMPLEADO_CSC_EMPLEADO:d.EMPLEADO_CSC_EMPLEADO};try{let c=await __Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+
"getTreeCliProyCamp","GET",d,getJSON(DeveloperType).ApiGeneral.token);if(1==c.success){jslinq(c.JsonData).toList().forEach(function(f){a._ClienteProyectoCampania_ObjData.insert(f)});var b=jslinq(c.JsonData).select(function(f){return f.CAM_CSC_SERVICIO}).toList();a.idServiciosUsuario=b.join(",");a.init()}}catch(c){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)}return!0};a.convertirSegundosADHHMMSS=function(d){const b=Math.floor(d/36E3);d%=36E3;const c=Math.floor(d/
3600);d%=3600;const f=Math.floor(d/60);d%=60;return("0"+b).slice(-2)+"d "+("0"+c).slice(-2)+":"+("0"+f).slice(-2)+":"+("0"+d).slice(-2)}};setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.run()},1E3);
