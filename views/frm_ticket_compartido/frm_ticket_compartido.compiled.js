SalesDashboard.dashboardModel=function(){var a=this;a.subdomain=window.location.host.split(".")[1]?window.location.host.split(".")[0]:!1;var q;let A;var z;a.DataTicketOpen=null;a.setDefaultValues=!1;a.Ids_TipoUso_Requi=9;a.CalificadoRechazado=!1;a.FileCorreoRespuesta=null;a.TipificacionesFull=null;a.CatalogosPantalla=[];a.Previous_TxtParentParent=null;a.Previous_TxtParent=null;a.Previous_TxtTipifica=null;a.Previous_TxtEstatus=null;a.Flag_Fila=!1;var x=$("#LoadEnvioCorreo").dxLoadPanel({hideOnOutsideClick:!1,
shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance"),p=$("#loadPanel").dxLoadPanel({hideOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",showIndicator:!0,showPane:!0,shading:!0,visible:!0}).dxLoadPanel("instance");a.UrlEnvioCorreos="http://localhost:3003";a.LoadCatFull=!0;a.Arr_ReglaNegocio=null;a.Arr_UniqueRN=null;a.Dts_LoadCrm=null;a.TimeZoneServidor=localStorage.getItem("tmzServidor");a.TimeZoneEmpleado=localStorage.getItem("tmzEmpleado");
a.TiempoUTCEmpleado=DiferencieTimeZones();a.TipoOrigenCreacion=0;a.TimeDefault=86400;a._Obj_Agrega_Emp_Ticket=new DevExpress.data.ArrayStore({data:[]});a._Obj_Autorizaciones_Grid=new DevExpress.data.ArrayStore({data:[]});a._Obj_Ot_Ticket_Grid=new DevExpress.data.ArrayStore({data:[]});a._Obj_Empleados_Grid=new DevExpress.data.ArrayStore({data:[]});a._MarkUpeditorText=null;a.ArchivosPermitidos=".jpg .jpeg .png .pdf .doc .docx .xlsx .xls".split(" ");a.extensionesDocumentos=".pdf .doc .docx .ppt .pptx .xls .xlsx .txt .rtf .csv .odt .ods .odp .odg .odf".split(" ");
a.extensionesImagenes=".jpg .jpeg .png .gif .bmp .webp .svg".split(" ");a.CamposVisiblesDG=!0;a.BotonesDisponibles=!1;a.jsonTiposParticipanes=null;a._Obj_Ticket_Participantes_Grid=new DevExpress.data.ArrayStore({data:[]});a.editandoForma=!1;a._CMB_SAMT_TIPO_REQ_USO_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_TICKET_PARTICIPANTE_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAT_EMPLEADO_AREA_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAT_EMPLEADO_DEPARTAMENTO_OBJDATA=
new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAM_MESA_DE_AYUDA_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_ESTATUS_TICKET_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_PRIORIDAD_TICKET_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_TICKET_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAM_TIPO_SERVICIO_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_SEVERIDAD_OBJDATA=new DevExpress.data.ArrayStore({data:[]});
a._CMB_SAMT_CLIENTES_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_PROYECTOS_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAM_SERVICIO_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_REQUISICIONES_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_CALIFICACION_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_PUESTO_EMPLEADO_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_TIPO_RESPUESTA_AUTORIZA_OBJDATA=
new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_ESTATUS_ORDEN_TRABAJO_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a._CMB_SAMT_CAM_TIPIFICACIONES_OBJDATA=new DevExpress.data.ArrayStore({data:[]});a.pauseTicket=!1;a.cierraTicket=!1;a._ClienteProyectoCampania_ObjData=new DevExpress.data.ArrayStore({data:[]});a._Obj_Activos_Grid_Busqueda=new DevExpress.data.ArrayStore({data:[]});a._DatosComplementariosTicket={};a.init=function(){function g(b,c,d){b=void 0==d?"TIPO="+b+"&OT_ID="+c:"TIPO="+
b+"&OT_ID="+c+"&TICKET_ID="+d;$("#Pop_Open_Ot_desde_ticket").dxPopup("show");b="/"+a.patname.split("/")[1]+"/views/Vistas_Ordenes_Trabajo/frm_ots/frm_ots.html?"+b;document.getElementById("Mod_Embebed_Ot_desde_ticket").src=b}function k(b){let c=[];var d=b.option("formData");Object.entries(d).forEach(([e])=>{var f=b.itemOption(e);if(void 0!=f){var m=f.editorType;f=f.label.text;"dxSelectBox"==m?(m=b.getEditor(e),c.push({[e]:m.option("text"),Label:f})):"dxTextBox"==m||"dxNumberBox"==m||"dxTextArea"==
m||"dxDateBox"==m?(m=b.getEditor(e),c.push({[e]:m.option("text"),Label:f})):"dxHtmlEditor"==m&&(m=b.getEditor(e),c.push({[e]:m.option("value"),Label:f}))}else if(f=b.itemOption("__Detalle_Edificio."+e),void 0!=f)if(m=f.editorType,f=f.label.text,"dxSelectBox"==m)m=b.getEditor(e),c.push({[e]:m.option("text"),Label:f});else if("dxTextBox"==m||"dxNumberBox"==m||"dxTextArea"==m||"dxDateBox"==m)m=b.getEditor(e),c.push({[e]:m.option("text"),Label:f})});d=l(a._SelectBox_OriginalDts,c,b);console.log(d)}function l(b,
c,d){d=d.option("formData");for(const f in b){var e=Object.keys(b[f])[0];c[f]&&c[f][e]!==b[f][e]&&(e={EMP_CSC_EMPRESA_HOST:ReturnDefaultData_Init().EMP_CSC_EMPRESA_HOST,AUDITORIA_USU_ALTA:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,AUDITORIA_USU_ULT_MOD:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,AUDITORIA_FEC_ALTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),AUDITORIA_FEC_ULT_MOD:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),
TIC_CSCTICKET:d.TIC_CSCTICKET,ESTATUS_TICKET_CSC:d.ESTATUS_TICKET_CSC,TIB_NOMBRE:q.EMPLEADO_NOMBREEMPLEADO+" "+q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO,TIB_FECHAHORA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),SAMT_TICKET_TIPO_BITACORA_CSC:1,SAMT_TICKET_SUBTIPO_BITACORA_CSC:3,TIB_DESCRIPCION:`${b[f].Label}: Cambio de '${b[f][e]}' a '${c[f][e]}'`,EMPLEADO_CSC_EMPLEADO:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO},e={...ReturnDefaultData_Init(),
DATA_INSERT:e},a.TestBitacoraInsert(e))}return{}}q=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));A=JSON.parse(localStorage.getItem("obj_SessionInfo"));p.hide();x.hide();Globalize.loadMessages(dictionary);var n=function(){var b=sessionStorage.getItem("locale");return null!=b?b:"es-mx"}();Globalize.locale(n);DevExpress.localization.locale(n);(function(){var b=document.getElementById("lista-archivos-permitidos"),c=Math.ceil(a.extensionesDocumentos.length/3),d=document.createElement("div");d.classList.add("column-container");
for(var e=0;3>e;e++){var f=document.createElement("div");f.classList.add("column");for(var m=document.createElement("ul"),h=Math.min((e+1)*c,a.extensionesDocumentos.length),r=e*c;r<h;r++){var t=a.extensionesDocumentos[r],u=document.createElement("li");u.textContent=t;m.appendChild(u)}f.appendChild(m);d.appendChild(f)}b.innerHTML="";b.appendChild(d)})();a.patname=window.location.pathname;__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat","GET",{Tbl:"SAMT_TIPO_REQ_USO",NACTIVE:"TIPO_USO_DE_REQ_ACTIVO"},
getJSON(DeveloperType).ApiGeneral.token).then(b=>{1==b.success?(jslinq(b.JsonData).where(function(c){return"CA"==c.TIPO_USO_DE_REQ_CLAVE.trim()}).toList(),b=jslinq(b.JsonData).select(function(c){return c.TIPO_USO_DE_REQ_CSC}).toList(),a.Ids_TipoUso_Requi=b.join(",")):__cmb_component.option("dataSource",[])});__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_TIPO_TICKET_PARTICIPANTE"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{a.jsonTiposParticipanes=1==b.success?
b.JsonData:null});a.TipoOrigenCreacion="GENERA"==getUrlParam("TPO_USUARIO")?1:2;$("#___Tb_Tickets").dxToolbar({onContentReady:function(){$Btn_Alta_Ticket.option("visible",!1);$btn_Modificar_Ticket.option("visible",!0);$btn_Salvar_Alta_Ticket.option("visible",!1);$btn_Salvar_Modifica_Ticket.option("visible",!1);$btn_Cancelar_Alta_Ticket.option("visible",!1);$btn_Cancelar_Modificar_Ticket.option("visible",!1);$btnCalificaAtencion.option("visible",!0)},items:[{location:"after",widget:"dxButton",locateInMenu:"auto",
options:{icon:"check",text:"Calificar ticket",type:"default",onInitialized:function(b){$btnCalificaAtencion=b.component},onClick(){if(1==a.DataTicketOpen.TIC_CERRADO)a.notificaPantalla("Acci\u00f3n no permitida",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"El ticket ya se enuentra cerrado.");else{var b=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem");"RESUELTO"==b.ESTATUS_TICKET_CLAVE||"CANCELADO"==b.ESTATUS_TICKET_CLAVE?$("#Pop_Califica_Ticket_Solicitante").dxPopup("show"):
a.notificaPantalla("Acci\u00f3n no permitida",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El ticket a\u00fan esta en "${b.ESTATUS_TICKET_IDIOMA1}", no es posible calificar.`)}}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"plus",text:"Alta",type:"default",onInitialized:function(b){$Btn_Alta_Ticket=b.component},onClick(){a.ClickAlta()}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"save",text:"Salvar Alta",type:"success",onInitialized:function(b){$btn_Salvar_Alta_Ticket=
b.component},onClick(){p.show();1==a.Frm_Ticket_Servicio_Instance.validate().isValid?a.Generar_Alta_Ticket():(p.hide(),DevExpress.ui.notify("LLENE LOS CAMPOS EN ROJO"))}}},{location:"after",widget:"dxButton",locateInMenu:"auto",options:{icon:"clear",text:"Cancelar Alta",type:"danger",onInitialized:function(b){$btn_Cancelar_Alta_Ticket=b.component},onClick(){$Btn_Alta_Ticket.option("visible",!0);$btn_Modificar_Ticket.option("visible",!0);$btn_Cancelar_Alta_Ticket.option("visible",!1);$btn_Salvar_Alta_Ticket.option("visible",
!1);a.Frm_Ticket_Servicio_Instance.resetValues();a.Frm_Ticket_Servicio_Instance.option("readOnly",!0)}}},{location:"after",widget:"dxButton",locateInMenu:"auto",options:{icon:"edit",text:"Modificar",type:"normal",onInitialized:function(b){$btn_Modificar_Ticket=b.component},onClick(){if(""==a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"))DevExpress.ui.notify({message:"No hay elemento a modificar",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"});
else{var b=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem");if("RESUELTO"==b.ESTATUS_TICKET_CLAVE)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El ticket se encuentra en estatus de: ${b.ESTATUS_TICKET_IDIOMA1}, se espera calificaci\u00f3n del solicitante.`,300,120);else if(1==a.DataTicketOpen.TIC_CERRADO)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"El ticket ya se encuentra cerrado.");
else switch(getUrlParam("TPO_USUARIO")){case "GENERA":DevExpress.ui.notify("EL TICKET YA SE ENCUENTRA EN PROCESO DE ATENCI\u00d3N.");a.Frm_Ticket_Servicio_Instance.getEditor("TIC_DESCRIPCION_SOLUCION").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("readOnly",
!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SOLICITA").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("readOnly",!0);break;default:a.setDefaultValues=!1,a.LoadCatFull=!1,a.editandoForma=!0,$btn_Modificar_Ticket.option("visible",!1),$Btn_Alta_Ticket.option("visible",!1),$btn_Salvar_Modifica_Ticket.option("visible",!0),$btn_Cancelar_Modificar_Ticket.option("visible",!0),a.Frm_Ticket_Servicio_Instance.option("readOnly",!1),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_DESCRIPCION").option("readOnly",
!0),a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("readOnly",!1),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SOLICITA").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("PM_CSC_PROYECTO_SOLICITA").option("readOnly",
!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_CODIGO_VPN").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TAG_COMPONENTE").option("readOnly",
!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SEGMENTACION_INM_DES").option("readOnly",!0)}}}}},{location:"before",widget:"dxButton",locateInMenu:"auto",options:{icon:"save",text:"Salvar Modifica",type:"success",onInitialized:function(b){$btn_Salvar_Modifica_Ticket=b.component},onClick(){var b=JSON.stringify(a.DataTicketOpen);a.DataTicketOpen=JSON.parse(b);var c=a.Frm_Ticket_Servicio_Instance.option("formData"),d=GetUpdateData(a.DataTicketOpen,c);b=0===Object.keys(d).length;var e=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem");
1==a.Frm_Ticket_Servicio_Instance.validate().isValid?1==b?DevExpress.ui.notify({message:"No se detecto ningun cambio",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"}):(p.show(),setTimeout(function(){1==a.CalificadoRechazado&&a.InsertaBitacoraManual(c,"Cliente rechazo la soluci\u00f3n",!0,1,1);k(a.Frm_Ticket_Servicio_Instance);d.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;d.AUDITORIA_FEC_ULT_MOD=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");
d.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");d.TIC_FECHA_ALTA&&(d.TIC_FECHA_ALTA=moment(d.TIC_FECHA_ALTA).add(CalculaTimeposInsertUpdate(),"hours").format("YYYY-MM-DD HH:mm:ss"));d.TIC_FECHA_SOLICITA&&(d.TIC_FECHA_SOLICITA=moment(d.TIC_FECHA_SOLICITA).add(CalculaTimeposInsertUpdate(),"hours").format("YYYY-MM-DD HH:mm:ss"));d.TIC_FECHA_PROMESA&&(d.TIC_FECHA_PROMESA=moment(d.TIC_FECHA_PROMESA).add(CalculaTimeposInsertUpdate(),"hours").format("YYYY-MM-DD HH:mm:ss"));if("RESUELTO"==
e.ESTATUS_TICKET_CLAVE||"CANCELADO"==e.ESTATUS_TICKET_CLAVE){d.TIC_FECHA_CIERRE=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");d.TIC_FECHA_CIERRE_SOLA=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");d.TIC_FECHA_CIERRE_HORA_COMPLETA=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");d.TIC_FECHA_CIERRE_SISTEMA=moment().tz(a.TimeZoneServidor).add(24,"hours").format("YYYY-MM-DD HH:mm:ss");d.TIC_CERRADO_POR_SISTEMA=1;if(0==a.DataTicketOpen.TIC_DURACION_EJECUCION){var f=
moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),m=a.DataTicketOpen.TIC_FECHA_ALTA,h=moment(f);m=moment(m);h=h.diff(m,"seconds");d.TIC_DURACION_EJECUCION=h}f={...ReturnDefaultData_Init(),TIC_NEWID:a.DataTicketOpen.TIC_NEWID};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"UpdateLogSla","POST",JSON.stringify(f),getJSON(DeveloperType).ApiTickets_v2.token).then(r=>{console.log(r)})}0==a.DataTicketOpen.TIC_DURACION_RECEPCION&&null==a.DataTicketOpen.TIC_FECHA_RECEPCION&&(f=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),
m=a.DataTicketOpen.AUDITORIA_FEC_ALTA,h=moment(f),m=moment(m),h=h.diff(m,"seconds"),d.TIC_DURACION_RECEPCION=h,d.TIC_FECHA_RECEPCION=f);f={...ReturnDefaultData_Init(),DATA_UPDATE:d,DATA_WHERE:{TIC_CSCTICKET:a.DataTicketOpen.TIC_CSCTICKET,TIC_NEWID:a.DataTicketOpen.TIC_NEWID,EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST")}};p.show();__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Update_Ticket_Servicio","POST",JSON.stringify(f),getJSON(DeveloperType).ApiTickets_v2.token).then(r=>
{if(1==r.success){var t={...ReturnDefaultData_Init(),TIC_NEWID:a.DataTicketOpen.TIC_NEWID};a.Get_Tickets(t,!1,null);DevExpress.ui.notify({message:"Ticket actualizado correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"});a.Flag_Fila=!1;$btn_Modificar_Ticket.option("visible",!0);$Btn_Alta_Ticket.option("visible",!1);$btn_Salvar_Modifica_Ticket.option("visible",!1);$btn_Cancelar_Modificar_Ticket.option("visible",!1);a.Frm_Ticket_Servicio_Instance.option("readOnly",
!0);a.pauseTicket=!1;t=createUUID(36);let u=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem"),v=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem"),w=a.Frm_Ticket_Servicio_Instance.getEditor("PM_CSC_PROYECTO_SOLICITA").option("selectedItem");a.EnviaRespuesta("Ticket actualizado.",a.DataTicketOpen.TIC_NEWID,`
                                                <b>Estatus:</b> ${e.ESTATUS_TICKET_IDIOMA1} 
                                                <br><b>Aduana:</b> ${u.REQUISICION_PROVEEDORES_CODIGO_VPN} ${u.REQUISICION_PROVEEDORES_NOMBRE} 
                                                <br><b>Punto tactico:</b> ${u.REQUISICION_PROVEEDORES_CODIGO_VPN} 
                                                <br><b>Numero de serie:</b> ${a.DataTicketOpen.TAG_COMPONENTE} 
                                                <br><b>Nombre:</b> ${a.DataTicketOpen.TIC_SOLICITA} 
                                                <br><b>Tel\u00e9fono:</b> ${a.DataTicketOpen.TIC_TELEFONO_SOLICITANTE} 
                                                <br><b>Tecnolog\u00eda:</b> ${w.PM_NOMBRE} 
                                                <br><b>Proveedor:</b> ${v.CAM_SERVICIO_NOMBRE} 
                                                <br><br><b>Descripci\u00f3n:</b> ${a.DataTicketOpen.TIC_DESCRIPCION}`,t)}else p.hide();return r}).catch(function(r){console.log(r);p.hide();DevExpress.ui.notify({message:"Error al actualizar ticket intentelo nuevamente",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})},2E3)):(p.hide(),DevExpress.ui.notify({message:"Llene los campos en rojo",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",
direction:"up-push"}))}}},{location:"after",widget:"dxButton",locateInMenu:"auto",options:{icon:"clear",text:"Cancelar Modificar",type:"danger",onInitialized:function(b){$btn_Cancelar_Modificar_Ticket=b.component},onClick(){a.editandoForma=!1;a.pauseTicket=!1;$btn_Modificar_Ticket.option("visible",!0);$Btn_Alta_Ticket.option("visible",!1);$btn_Salvar_Modifica_Ticket.option("visible",!1);$btn_Cancelar_Modificar_Ticket.option("visible",!1);a.Frm_Ticket_Servicio_Instance.option("readOnly",!0);var b=
JSON.stringify(a.DataTicketOpen);a.DataTicketOpen=JSON.parse(b);a.Frm_Ticket_Servicio_Instance.updateData(a.DataTicketOpen)}}}]}).dxToolbar("instance");z=JSON.parse(sessionStorage.getItem("cat_origen_foto"));z=jslinq(z).where(function(b){return"TKT"==b.TIPO_ORIGEN_CLAVE}).toList();$("#Pop_Notificacion_Success").dxPopup({width:20,height:20,visible:!1,showTitle:!1,title:"Information",hideOnOutsideClick:!1,onHiding:function(b){b.component.content().empty()},toolbarItems:[{widget:"dxButton",toolbar:"bottom",
options:{text:"Cerrar",onClick(){$("#Pop_Notificacion_Success").dxPopup("hide")}}}]}).dxPopup("instance");$("#Pop_Upload_Foto_Ticket").dxPopup({width:20,height:20,visible:!1,showTitle:!0,title:"-",hideOnOutsideClick:!1,onHiding:function(b){b.component.content().empty()},toolbarItems:[{widget:"dxButton",toolbar:"bottom",options:{text:"Cerrar",onClick(){$("#Pop_Upload_Foto_Ticket").dxPopup("hide");a.Get_Ticket_Foto();a.Get_Ticket_Documentos(!1)}}}]}).dxPopup("instance");$("#Pop_CrearVerRespuesta").dxPopup({width:"80%",
height:400,visible:!1,showTitle:!1,shading:!1,title:"Respuesta/Mensaje",hideOnOutsideClick:!1,contentTemplate:function(b){var c=$("<div id='Frm_MensajeRespuesta'>");c.dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Validacion_Frm_MensajeRespuesta",labelMode:"static",labelLocation:"top",colCount:1,screenByWidth(d){return 700>d?"sm":"lg"},items:[{colSpan:2,dataField:"RESPUESTA_ASUNTO",editorType:"dxTextBox",label:{text:"Asunto"},editorOptions:{readOnly:!1,valueChangeEvent:"keyup",
onValueChanged:function(d){null!=d.value&&""!=d.value&&d.component.option("value",d.value.toUpperCase())}},validationRules:[{type:"required",message:"requerido"}]},{dataField:"RESPUESTA_DESCRIPCION",label:{text:"Descripci\u00f3n/Observaci\u00f3n"},editorType:"dxHtmlEditor",editorOptions:{height:130,toolbar:{items:["undo","redo","separator",{name:"size",acceptedValues:"8pt 10pt 12pt 14pt 18pt 24pt 36pt".split(" ")},{name:"font",acceptedValues:"Arial;Courier New;Georgia;Impact;Lucida Console;Tahoma;Times New Roman;Verdana".split(";")},
"separator","bold","italic","strike","underline","separator","alignLeft","alignCenter","alignRight","alignJustify","separator","color","background"]}},validationRules:[{type:"required",message:"requerido"}]}]}).dxForm("instance");$("<div id='FileCorreoRespuesta'>").dxFileUploader({multiple:!0,allowedFileExtensions:a.ArchivosPermitidos,uploadMode:"useButtons",visible:!0,disabled:!1,onValueChanged:function(d){var e=d.component.option("values");$.each(e,function(f,m){d.element.find(".dx-fileuploader-upload-button").hide()});
d.element.find(".dx-fileuploader-upload-button").hide()}}).dxFileUploader("instance");JSON.stringify(a.ArchivosPermitidos);b.append(function(d){return $('<div style="height:100%;">').append(c)})},toolbarItems:[{widget:"dxButton",toolbar:"bottom",options:{icon:"save",type:"success",text:"Enviar respuesta",onClick(){p.show();var b=$("#Frm_MensajeRespuesta").dxForm("instance").option("formData");let c=a.Frm_Ticket_Servicio_Instance.option("formData");if(!1===$("#Frm_MensajeRespuesta").dxForm("instance").validate().isValid)DevExpress.ui.notify({message:"Llene los campos en rojo",
minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"}),p.hide();else{var d=createUUID(36),e=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");b.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");b.TIC_CSCTICKET=c.TIC_CSCTICKET;b.SAMT_ESTATUS_RESPUESTA_CSC=1;b.RESPUESTA_FECHAHORA_ALTA=e;b.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_FEC_ALTA=e;b.AUDITORIA_FEC_ULT_MOD=e;b.RESPUESTA_NOMBRE=
q.EMPLEADO_NOMBREEMPLEADO+" "+q.EMPLEADO_APATERNOEMPLEADO;b.TICKET_MENSAJE_NEWID=d;"GENERA"==getUrlParam("TPO_USUARIO")?(b.RESPUESTA_LEIDO_CLIENTE=!0,b.RESPUESTA_FEC_LEIDO_CLIENTE=e,b.RESPUESTA_CLAVE="CLIENTE"):(b.RESPUESTA_LEIDO_OPERADOR=!0,b.RESPUESTA_FEC_LEIDO_OPERADOR=e,b.RESPUESTA_CLAVE="OPERADOR");e={...ReturnDefaultData_Init(),DATA_INSERT:b};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Respuesta_Mensaje","POST",JSON.stringify(e),getJSON(DeveloperType).ApiTickets_v2.token).then(f=>
{1==f.success?(DevExpress.ui.notify({message:"Mensaje creado correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}),5==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&(b.TIC_CSCTICKET=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),__Reques_ajax("https://apioracle.dnasystem.io/api/Api_Tickets_v2/Insert_Respuesta_Mensaje","POST",JSON.stringify({EMP_CLV_EMPRESA:"CREATIF",EMP_CSC_EMPRESA_HOST:"1",
TimeZoneCliente:"America/Mexico_City",TimeZoneServer:"Etc/GMT",Type:"Pro",DATA_INSERT:b}),getJSON(DeveloperType).ApiTickets_v2.token).then(m=>{console.log(m);1==m.success&&DevExpress.ui.notify({message:"Mensaje creado a proveedor",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"})})),38==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&(b.TIC_CSCTICKET=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),
__Reques_ajax("https://apioracle.dnasystem.io/api/Api_Tickets_v2/Insert_Respuesta_Mensaje","POST",JSON.stringify({EMP_CLV_EMPRESA:"SRMSOTIC",EMP_CSC_EMPRESA_HOST:"1",TimeZoneCliente:"America/Mexico_City",TimeZoneServer:"Etc/GMT",Type:"Pro",DATA_INSERT:b}),getJSON(DeveloperType).ApiTickets_v2.token).then(m=>{console.log(m);1==m.success&&DevExpress.ui.notify({message:"Mensaje creado a proveedor",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"})})),p.hide(),
"GENERA"!=getUrlParam("TPO_USUARIO")&&(a.EnviaRespuesta("Respuesta",c.TIC_NEWID,b.RESPUESTA_DESCRIPCION,d),$("#Pop_CrearVerRespuesta").dxPopup("hide")),a.Get_Respuesta_Mensaje(a.Frm_Ticket_Servicio_Instance.option("formData").TIC_CSCTICKET)):p.hide();return f}).catch(function(f){console.log(f);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}}}},{widget:"dxButton",
toolbar:"bottom",options:{text:"Cerrar",onClick(){$("#Pop_CrearVerRespuesta").dxPopup("hide")}}}],onHiding:function(b){$("#Frm_MensajeRespuesta").dxForm("instance").resetValues()}}).dxPopup("instance");a.attachDocToMessageTicket=function(b){let c=$("#FileCorreoRespuesta").dxFileUploader("instance"),d=c.option("value");var e=c._files;if(0!=d.length){if(0<e.length)for(let f=0;f<e.length;f++)if(0==e[f].isValid()){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
"Un archivo no cumple con las reglas",400,130);return}e=new FormData;b={ClaveEmp:localStorage.getItem("EMP_CLV_EMPRESA"),EmpresaHost:parseInt(localStorage.getItem("EMP_CSC_EMPRESA_HOST")),TypeCon:localStorage.getItem("Type"),ClaveDoc:"TICKET_MENSAJE",IdEmpleado:q.EMPLEADO_CSC_EMPLEADO,cscEmpleado:q.EMPLEADO_CSC_EMPLEADO,NewIdEquipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),OrigenCrea:a.TipoOrigenCreacion,NewIdMessage:b};console.log(b);e.append("extra",JSON.stringify(b));
if(0<d.length)for(b=0;b<d.length;b++)e.append("fileToUpload",d[b]);$.ajax({xhr:function(){let f=new window.XMLHttpRequest;f.upload.addEventListener("progress",function(m){m.lengthComputable&&(m=m.loaded/m.total,m=parseInt(100*m),console.log(m))},!1);return f},type:"POST",url:`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}uploadAttachmentMessageToTicket`,data:e,dataType:"json",cache:!1,contentType:!1,processData:!1,headers:{}}).done(function(f){1==f.success&&(c.reset(),DevExpress.ui.notify({message:"Archivo(s) cargado(s) correctamente",
minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}),a.Get_Ticket_Documentos(!1))}).fail(function(f){console.log(f);DevExpress.ui.notify({message:"Error de comunicaci\u00f3n con servidor",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}};$("#Pop_Califica_Ticket_Solicitante").dxPopup({width:400,height:300,visible:!1,showTitle:!0,title:"Su opinion es muy importante, por favor califique el servicio.",hideOnOutsideClick:!1,
contentTemplate:function(b){var c=$("<div id='frmCalificaTicket'>");c.dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Validacion_frmCalificaTicket",labelMode:"static",labelLocation:"top",colCount:1,screenByWidth(d){return 700>d?"sm":"lg"},items:[{colSpan:1,dataField:"TIPO_CALIFICACION_CSC",editorType:"dxSelectBox",label:{text:"Calificaci\u00f3n"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_CALIFICACION_IDIOMA1",valueExpr:"TIPO_CALIFICACION_CSC",deferRendering:!1,
dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(){try{var d={Tbl:"SAMT_TIPO_CALIFICACION",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_CALIFICACION_ACTIVO = 1 "};return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",d,getJSON(DeveloperType).ApiGeneral.token).then(e=>{if(1==e.success)return jslinq(e.JsonData).where(function(f){return"NA"!=f.TIPO_CALIFICACION_CLAVE}).toList();console.log(e.message)})}catch(e){console.log(e)}}}),
onOpened:function(d){d.component.getDataSource().load().done(function(e){a.TIPO_CALIFICACION_CSC=e;e=jslinq(e).where(function(f){return 1==f.TIPO_CALIFICACION_ACTIVO}).toList();d.component.option("dataSource",e)})},onClosed:function(d){d.component.getDataSource().items()!==a.TIPO_CALIFICACION_CSC&&d.component.option("dataSource",a.TIPO_CALIFICACION_CSC)},onValueChanged:function(d){d=d.component.option("selectedItem");null!=d&&("CCC"==d.TIPO_CALIFICACION_CLAVE?$("#frmCalificaTicket").dxForm("instance").itemOption("TIC_CALIFICACION_COMENTARIO",
"isRequired",!0):$("#frmCalificaTicket").dxForm("instance").itemOption("TIC_CALIFICACION_COMENTARIO","isRequired",!1))}},validationRules:[{type:"required",message:"requerido"}]},{dataField:"TIC_CALIFICACION_COMENTARIO",editorType:"dxTextArea",colSpan:1,label:{text:"Descripci\u00f3n/Observaci\u00f3n"},editorOptions:{height:150,valueChangeEvent:"keyup",onValueChanged:function(d){},buttons:[{name:"ObtenPortapapel",location:"after",options:{stylingMode:"Contained",icon:"pasteplaintext",type:"normal",
onClick(d){a.ObtenClipboard("Frm_MensajeRespuesta","RESPUESTA_DESCRIPCION")}}}]}}]}).dxForm("instance");b.append(c)},toolbarItems:[{widget:"dxButton",toolbar:"bottom",options:{icon:"save",type:"success",text:"Calificar",onClick(){var b=$("#frmCalificaTicket").dxForm("instance").option("formData");p.show();if(!0===$("#frmCalificaTicket").dxForm("instance").validate().isValid){b.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_FEC_ULT_MOD=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");
var c=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem");let e=a._CMB_SAMT_ESTATUS_TICKET_OBJDATA._array,f=null;var d={};d.TIC_CSCTICKET=a.DataTicketOpen.TIC_CSCTICKET;d.ESTATUS_TICKET_CSC=c.ESTATUS_TICKET_CSC;3==b.TIPO_CALIFICACION_CSC?(a.InsertaBitacoraManual(d,`Ticket no atendido: ${b.TIC_CALIFICACION_COMENTARIO}`,!1,2,1),f=jslinq(e).where(function(m){return 1==m.ESTATUS_TICKET_ACTIVO&&m.CAM_CSC_SERVICIO==a.DataTicketOpen.CAM_CSC_SERVICIO_SOLICITA&&1==m.ESTATUS_TICKET_REASIGNAR}).toList(),
b.TIC_FECHA_CIERRE=null):(f=jslinq(e).where(function(m){return 1==m.ESTATUS_TICKET_ACTIVO&&m.CAM_CSC_SERVICIO==a.DataTicketOpen.CAM_CSC_SERVICIO_SOLICITA&&"CERRADO"==m.ESTATUS_TICKET_CLAVE}).toList(),b.TIC_CERRADO=!0,b.TIC_CERRADO_POR_SISTEMA=0,a.InsertaBitacoraManual(d,`Ticket atendido y cerrado: ${b.TIC_CALIFICACION_COMENTARIO}`,!1,2,1));b.TIC_CALIFICADO=1;b.TIC_CALIFICACION_FECHA=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");b.ESTATUS_TICKET_CSC=f[0].ESTATUS_TICKET_CSC;d=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("selectedItem");
b={...ReturnDefaultData_Init(),DATA_UPDATE:b,TIC_ID_EXTERNO_PROVEEDOR:a.DataTicketOpen.TIC_ID_EXTERNO_PROVEEDOR,TIC_TIPO_CATEGORIA:d.TIPIFICA_IDIOMA1,DATA_WHERE:{TIC_CSCTICKET:a.DataTicketOpen.TIC_CSCTICKET,TIC_NEWID:a.DataTicketOpen.TIC_NEWID,EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),CAM_CSC_SERVICIO_SOLICITA:a.DataTicketOpen.CAM_CSC_SERVICIO_SOLICITA}};p.show();__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Update_Ticket_Servicio","POST",JSON.stringify(b),getJSON(DeveloperType).ApiTickets_v2.token).then(m=>
{if(1==m.success){var h={...ReturnDefaultData_Init(),TIC_NEWID:a.DataTicketOpen.TIC_NEWID};a.Get_Tickets(h,!1,null);$("#Pop_Califica_Ticket_Solicitante").dxPopup("hide");h={};h.TIC_CSCTICKET=a.DataTicketOpen.TIC_CSCTICKET;h.ESTATUS_TICKET_CSC=c.ESTATUS_TICKET_CSC;let r=m.ResProvider;null!=r?0==r.isSuccessProvider?(a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`Error al calificar el ticket del proveedor: ${JSON.stringify(m.ResProvider.errorDetail.message.message)}`,
400,140),a.InsertaBitacoraManual(h,JSON.stringify(r.errorDetail),!1,2,1)):a.InsertaBitacoraManual(h,JSON.stringify(r.Detail),!1,1,2):a.InsertaBitacoraManual(h,JSON.stringify(r.Detail),!1,1,2);p.hide()}}).catch(function(m){console.log(m);p.hide()})}else p.hide(),a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Llene los campos en rojo.",400,130)}}},{widget:"dxButton",toolbar:"bottom",options:{text:"Cerrar",onClick(){$("#Pop_Califica_Ticket_Solicitante").dxPopup("hide")}}}],
onHiding:function(b){$("#frmCalificaTicket").dxForm("instance").resetValues()}}).dxPopup("instance");$("#Pop_Insertar_BitacoraManual").dxPopup({width:400,height:300,visible:!1,showTitle:!1,title:"Ingrese bitacora",hideOnOutsideClick:!1,contentTemplate:function(b){var c=$("<div id='Frm_BitacoraManual'>");c.dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Validacion_Frm_BitacoraManual",labelMode:"static",labelLocation:"top",colCount:1,screenByWidth(d){return 700>
d?"sm":"lg"},items:[{dataField:"INFO_BITACORA",editorType:"dxTextArea",colSpan:6,label:{text:"Descripci\u00f3n/Observaci\u00f3n"},editorOptions:{height:150,valueChangeEvent:"keyup",onValueChanged:function(d){},buttons:[{name:"ObtenPortapapel",location:"after",options:{stylingMode:"Contained",icon:"pasteplaintext",type:"normal",onClick(d){a.ObtenClipboard("Frm_MensajeRespuesta","RESPUESTA_DESCRIPCION")}}}]},validationRules:[{type:"required",message:"requerido"}]}]}).dxForm("instance");b.append(c)},
toolbarItems:[{widget:"dxButton",toolbar:"bottom",options:{icon:"save",type:"success",text:"Salvar",onClick(){var b=$("#Frm_BitacoraManual").dxForm("instance").option("formData"),c={};c.TIC_CSCTICKET=a.DataTicketOpen.TIC_CSCTICKET;c.ESTATUS_TICKET_CSC=a.DataTicketOpen.ESTATUS_TICKET_CSC;a.InsertaBitacoraManual(c,b.INFO_BITACORA,!1,1,1)}}},{widget:"dxButton",toolbar:"bottom",options:{text:"Cerrar",onClick(){$("#Pop_Insertar_BitacoraManual").dxPopup("hide");a.Get_Bitacora_tickets(a.DataTicketOpen.TIC_CSCTICKET)}}}],
onHiding:function(b){a.Get_Bitacora_tickets(a.DataTicketOpen.TIC_CSCTICKET);$("#Frm_BitacoraManual").dxForm("instance").resetValues()}}).dxPopup("instance");a.muestraPopComplementosTicket=function(b){$("#Pop_Agregar_DatosComplementarios").dxPopup({width:400,height:300,visible:!1,showTitle:!1,title:"Ingrese datos",hideOnOutsideClick:!1,contentTemplate:function(c){var d=$("<div id='Frm_DatosComplementarios'>");d.dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Validacion_Frm_DatosComplementarios",
labelMode:"static",labelLocation:"top",colCount:1,screenByWidth(e){return 700>e?"sm":"lg"},items:[{colSpan:2,dataField:"FechaAplicaString",editorType:"dxDateBox",label:{text:`FECHA DE ${b}`},editorOptions:{type:"date",width:"100%",placeholder:"DD/MM/AAAA",useMaskBehavior:!0,displayFormat:"dd/MM/yyyy",dateSerializationFormat:"yyyy-MM-dd",min:new Date,onValueChanged:function(e){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"MarcaString",editorType:"dxTextBox",label:{text:"MARCA"},
editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"ModeloString",editorType:"dxTextBox",label:{text:"MODELO"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"NumeroSerieString",editorType:"dxTextBox",label:{text:"NUMERO DE SERIE"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]}]}).dxForm("instance");c.append(d)},toolbarItems:[{widget:"dxButton",toolbar:"bottom",
options:{icon:"save",type:"success",text:"Agregar",onClick(){if(!1===$("#Frm_DatosComplementarios").dxForm("instance").validate().isValid)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Todos los campos marcados con * son obligatorios.",400,130);else{var c=$("#Frm_DatosComplementarios").dxForm("instance").option("formData");a._DatosComplementariosTicket=c;a.Frm_Ticket_Servicio_Instance.getEditor("TIC_JSON_EXTRA_PARAMS").option("value",JSON.stringify(a._DatosComplementariosTicket));
$("#Pop_Agregar_DatosComplementarios").dxPopup("hide")}}}},{widget:"dxButton",toolbar:"bottom",options:{text:"Cerrar",onClick(){$("#Pop_Agregar_DatosComplementarios").dxPopup("hide")}}}],onHiding:function(c){}}).dxPopup("instance");$("#Pop_Agregar_DatosComplementarios").dxPopup("show");"BAJA"==b?($("#Frm_DatosComplementarios").dxForm("instance").itemOption("FechaAplicaString","visible",!0),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("MarcaString","visible",!1),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("ModeloString",
"visible",!1),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("NumeroSerieString","visible",!1)):"CAMBIO"==b&&($("#Frm_DatosComplementarios").dxForm("instance").itemOption("FechaAplicaString","visible",!0),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("MarcaString","visible",!0),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("ModeloString","visible",!0),$("#Frm_DatosComplementarios").dxForm("instance").itemOption("NumeroSerieString","visible",!0))};a.popDatosSiadeconSrv=
function(b){$("#Pop_Agregar_DatosComplementarios_Siadeconsrv").dxPopup({width:400,height:450,visible:!1,showTitle:!1,title:"Ingrese datos",hideOnOutsideClick:!1,contentTemplate:function(c){var d=$("<div id='Frm_DatosComplementariosSiadeconSrv'>");d.dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Validacion_Frm_DatosComplementariosSiadeconSrv",labelMode:"static",labelLocation:"top",colCount:1,screenByWidth(e){return 700>e?"sm":"lg"},items:[{colSpan:2,dataField:"DATOS_SIADECONSRV_NOMBRES",
editorType:"dxTextBox",label:{text:"Nombre(s)"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_APELLIDO_PATERNO",editorType:"dxTextBox",label:{text:"Apellido Paterno"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_APELLIDO_MATERNO",editorType:"dxTextBox",label:{text:"Apellido Materno"},editorOptions:{readOnly:!1},validationRules:[{type:"required",
message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_RFC",editorType:"dxTextBox",label:{text:"RFC"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_EMAIL",editorType:"dxTextBox",label:{text:"Mail (institucional)"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_ADUANA_CSC",editorType:"dxSelectBox",label:{text:"Aduana"},editorOptions:{searchEnabled:!0,
displayExpr:"ADUANAS_DESCRIPCION",valueExpr:"SAMT_CAT_SIADECONSRV_ADUANAS_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_SIADECONSRV_ADUANAS"},getJSON(DeveloperType).ApiGeneral.token).then(e=>{if(1==e.success)return jslinq(e.JsonData).orderBy(function(f){return f.ADUANAS_DESCRIPCION}).toList();
console.log(e.message)})}})}),onOpened:function(e){e.component.getDataSource().load().done(function(f){a.CAT_SIADECONSRV_ADUANAS=f;f=jslinq(f).where(function(m){return 1==m.ADUANAS_ACTIVO}).toList();e.component.option("dataSource",f)})},onClosed:function(e){e.component.getDataSource().items()!==a.CAT_SIADECONSRV_ADUANAS&&e.component.option("dataSource",a.CAT_SIADECONSRV_ADUANAS)},onValueChanged:function(e){}}},{colSpan:2,dataField:"DATOS_SIADECONSRV_PUNTO_TACTICO",editorType:"dxTextBox",label:{text:"Punto t\u00e1ctico"},
editorOptions:{readOnly:!1}},{colSpan:2,dataField:"DATOS_SIADECONSRV_AREA",editorType:"dxTextBox",label:{text:"\u00c1rea"},editorOptions:{readOnly:!1}},{colSpan:2,dataField:"DATOS_SIADECONSRV_JERARQUIA_CSC",editorType:"dxSelectBox",label:{text:"Jerarqu\u00eda"},editorOptions:{searchEnabled:!0,displayExpr:"JERARQUIAS_DESCRIPCION",valueExpr:"SAMT_CAT_SIADECONSRV_JERARQUIAS_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,
load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_SIADECONSRV_JERARQUIAS"},getJSON(DeveloperType).ApiGeneral.token).then(e=>{if(1==e.success)return jslinq(e.JsonData).orderBy(function(f){return f.JERARQUIAS_DESCRIPCION}).toList();console.log(e.message)})}})}),onOpened:function(e){e.component.getDataSource().load().done(function(f){a.CAT_JERARQUIAS_DESCRIPCION=f;f=jslinq(f).where(function(m){return 1==m.JERARQUIAS_ACTIVO}).toList();
e.component.option("dataSource",f)})},onClosed:function(e){e.component.getDataSource().items()!==a.CAT_JERARQUIAS_DESCRIPCION&&e.component.option("dataSource",a.CAT_JERARQUIAS_DESCRIPCION)},onValueChanged:function(e){}}},{colSpan:2,dataField:"DATOS_SIADECONSRV_VIN",editorType:"dxTextBox",label:{text:"VIN"},editorOptions:{readOnly:!1},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_PLACA",editorType:"dxTextBox",label:{text:"Placa"},editorOptions:{readOnly:!1},
validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_PAIS_CSC",editorType:"dxSelectBox",label:{text:"Pa\u00eds"},editorOptions:{searchEnabled:!0,displayExpr:"PAIS_NOMBRE",valueExpr:"SAMT_CAT_SIADECONSRV_PAIS_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_SIADECONSRV_PAIS"},
getJSON(DeveloperType).ApiGeneral.token).then(e=>{if(1==e.success)return jslinq(e.JsonData).orderBy(function(f){return f.PAIS_NOMBRE}).toList();console.log(e.message)})}})}),onOpened:function(e){e.component.getDataSource().load().done(function(f){a.SAMT_CAT_SIADECONSRV_PAIS_CSC=f;f=jslinq(f).where(function(m){return 1==m.PAIS_ACTIVO}).toList();e.component.option("dataSource",f)})},onClosed:function(e){e.component.getDataSource().items()!==a.SAMT_CAT_SIADECONSRV_PAIS_CSC&&e.component.option("dataSource",
a.SAMT_CAT_SIADECONSRV_PAIS_CSC)},onValueChanged:function(e){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC",editorType:"dxSelectBox",label:{text:"Entidad Federativa"},editorOptions:{searchEnabled:!0,displayExpr:"ENTIDAD_FEDERATIVA_NOMBRE",valueExpr:"SAMT_CAT_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,
load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_SIADECONSRV_ENTIDAD_FEDERATIVA"},getJSON(DeveloperType).ApiGeneral.token).then(e=>{if(1==e.success)return jslinq(e.JsonData).orderBy(function(f){return f.ENTIDAD_FEDERATIVA_NOMBRE}).toList();console.log(e.message)})}})}),onOpened:function(e){e.component.getDataSource().load().done(function(f){a.SAMT_CAT_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC=f;let m=$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").getEditor("DATOS_SIADECONSRV_PAIS_CSC").option("selectedItem");
f=jslinq(f).where(function(h){return 1==h.ENTIDAD_FEDERATIVA_ACTIVO&&h.SAMT_CAT_SIADECONSRV_PAIS==m.SAMT_CAT_SIADECONSRV_PAIS_CSC}).toList();e.component.option("dataSource",f)})},onClosed:function(e){e.component.getDataSource().items()!==a.SAMT_CAT_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC&&e.component.option("dataSource",a.SAMT_CAT_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC)},onValueChanged:function(e){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"DATOS_SIADECONSRV_NOMBRE_LISTA_NEGRA_CSC",
editorType:"dxSelectBox",label:{text:"Nombre lista negra"},editorOptions:{searchEnabled:!0,displayExpr:"LISTA_NEGRA_DESCRIPCION",valueExpr:"SAMT_CAT_SIADECONSRV_LISTA_NEGRA_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_SIADECONSRV_LISTA_NEGRA"},getJSON(DeveloperType).ApiGeneral.token).then(e=>
{if(1==e.success)return jslinq(e.JsonData).orderBy(function(f){return f.ENTIDAD_FEDERATIVA_NOMBRE}).toList();console.log(e.message)})}})}),onOpened:function(e){e.component.getDataSource().load().done(function(f){a.LISTA_NEGRA_DESCRIPCION=f;f=jslinq(f).where(function(m){return 1==m.LISTA_NEGRA_ACTIVO}).toList();e.component.option("dataSource",f)})},onClosed:function(e){e.component.getDataSource().items()!==a.LISTA_NEGRA_DESCRIPCION&&e.component.option("dataSource",a.LISTA_NEGRA_DESCRIPCION)},onValueChanged:function(e){}},
validationRules:[{type:"required",message:"requerido"}]}]}).dxForm("instance");c.append(d)},toolbarItems:[{widget:"dxButton",toolbar:"bottom",options:{icon:"save",type:"success",text:"Agregar",onClick(){if(!1===$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").validate().isValid)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Todos los campos marcados con * son obligatorios.",400,130);else{var c=$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").option("formData");
a._DatosComplementariosTicket=c;var d=a.Frm_Ticket_Servicio_Instance.option("formData");c.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_FEC_ALTA=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");c.AUDITORIA_FEC_ULT_MOD=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");c.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");c.TIC_NEWID=d.TIC_NEWID;c={...ReturnDefaultData_Init(),DATA_INSERT:c};console.log(c);
__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_DataSiadecon","POST",JSON.stringify(c),getJSON(DeveloperType).ApiTickets_v2.token).then(e=>{1==e.success?$("#Pop_Agregar_DatosComplementarios_Siadeconsrv").dxPopup("hide"):p.hide();return e}).catch(function(e){console.log(e);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}}}},{widget:"dxButton",toolbar:"bottom",
options:{text:"Cerrar",onClick(){$("#Pop_Agregar_DatosComplementarios_Siadeconsrv").dxPopup("hide")}}}],onHiding:function(c){}}).dxPopup("instance");$("#Pop_Agregar_DatosComplementarios_Siadeconsrv").dxPopup("show");"ALTA DE USUARIO"==b&&($("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRES","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_PATERNO","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_MATERNO",
"visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_RFC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_EMAIL","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PUNTO_TACTICO","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC",
"visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_AREA","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_JERARQUIA_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_VIN","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PLACA","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PAIS_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRE_LISTA_NEGRA_CSC","visible",!1));"BAJA DE USUARIO"==b?($("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRES","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_PATERNO",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_MATERNO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_RFC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_EMAIL","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PUNTO_TACTICO",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_AREA","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_JERARQUIA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_VIN","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PLACA",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PAIS_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRE_LISTA_NEGRA_CSC","visible",!1)):"MONITOREO Y SEGUIMIENTO DE VEH\u00cdCULOS"==b?($("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRES",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_PATERNO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_MATERNO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_RFC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_EMAIL","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PUNTO_TACTICO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_AREA","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_JERARQUIA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_VIN",
"visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PLACA","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PAIS_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRE_LISTA_NEGRA_CSC","visible",!1)):'ACTUALIZACI\u00d3N DE LISTA: "MEDIDA DE CONTROL CPED"'==
b&&($("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRES","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_PATERNO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_APELLIDO_MATERNO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_RFC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_EMAIL",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PUNTO_TACTICO","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ADUANA_CSC","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_AREA","visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_JERARQUIA_CSC",
"visible",!1),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_VIN","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PLACA","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_ENTIDAD_FEDERATIVA_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_PAIS_CSC","visible",!0),$("#Frm_DatosComplementariosSiadeconSrv").dxForm("instance").itemOption("DATOS_SIADECONSRV_NOMBRE_LISTA_NEGRA_CSC",
"visible",!0))};$("#Pop_Open_Ot_desde_ticket").dxPopup({hideOnOutsideClick:!1,title:"Orden de trabajo",height:"100%",width:"100%",position:{my:"center",at:"center",of:window},onHiding:function(b){a.Get_Linkeo_ticket_ot(a.DataTicketOpen.TIC_CSCTICKET);a.Get_Autorizaciones_Ticket(a.DataTicketOpen.TIC_NEWID);document.getElementById("Mod_Embebed_Ot_desde_ticket").src=""},onShowing:function(b){},onShown:function(b){}});a.TabPanel_Ticket_Detalle=$("#Tab_Panel_Ticket_Detalle").dxTabPanel({onContentReady:function(){a.imageUploadToTicket=
$("#fUploadImageToTicket").dxFileUploader({selectButtonText:"Seleccione la imagen",multiple:!0,maxFileSize:1E7,accept:"image/*",uploadMode:"useButtons",visible:!0,disabled:!1,onValueChanged:function(b){var c=b.component.option("values");$.each(c,function(d,e){b.element.find(".dx-fileuploader-upload-button").hide()});b.element.find(".dx-fileuploader-upload-button").hide()}}).dxFileUploader("instance");a.documentsUploadToTicket=$("#documentsUploadToTicket").dxFileUploader({selectButtonText:"Seleccione archivo(s)",
multiple:!0,maxFileSize:1E7,allowedFileExtensions:a.extensionesDocumentos,uploadMode:"useButtons",visible:!0,disabled:!1,onValueChanged:function(b){var c=b.component.option("values");$.each(c,function(d,e){b.element.find(".dx-fileuploader-upload-button").hide()});b.element.find(".dx-fileuploader-upload-button").hide()}}).dxFileUploader("instance")},animationEnabled:!1,deferRendering:!1,repaintChangesOnly:!1,elementAttr:{id:"Tab-TicketDetalle"},dataSource:[],selectedIndex:0,showNavButtons:!0,scrollByContent:!0,
scrollingEnabled:!0,itemTitleTemplate:function(b,c,d){d.append($('<img src="'+b.icon+'" class="navIcon" alt="Icon Menu"/>')).append($("<span>").text(b.title))},onSelectionChanged:function(b){b=b.addedItems[0];if("ALTA"==getUrlParam("TIPO"))1==a.setDefaultValues&&($_Btn_Cargar_Imagen_Sistema.option("visible",!1),$_Btn_Agregar_Documento.option("visible",!1));else switch(b.template){case "tab_frmticketservicio":a.Get_Ticket_Documentos(!1);break;case "tab_add_empleados":a.Get_Emp_Ticket(a.DataTicketOpen.TIC_NEWID);
break;case "tab_RepFotograf":a.Get_Ticket_Foto();break;case "tab_DocumentosTk":a.Get_Ticket_Documentos(!1);break;case "tab_respuestas_rapidas":a.Get_Respuesta_Mensaje(a.DataTicketOpen.TIC_CSCTICKET);break;case "tab_bitacoras":a.Get_Bitacora_tickets(a.DataTicketOpen.TIC_CSCTICKET);break;case "tab_participantes":a.Get_Ticket_Participantes(a.DataTicketOpen.TIC_NEWID);break;case "tab_Empleado_Solicita":null!=a.DatosEmpleadosGet&&void 0!=a.DatosEmpleadosGet||a.Get_Datos_Empleado_Solicita(a.DataTicketOpen.EMPLEADO_CSC_SOLICITA)}}}).dxTabPanel("instance");
a.VistaSegunCondicion=()=>{switch(a.TipoOrigenCreacion){case 1:a.TabPanel_Ticket_Detalle.option("dataSource",[{icon:"../../images/Icons/surveys128.png",title:Globalize.formatMessage("tabGeneralTitleTicket"),template:"tab_frmticketservicio"},{icon:"../../images/Icons/Card-file-icon64.png",title:Globalize.formatMessage("tabGeneralTitleRepFoto"),template:"tab_RepFotograf"},{icon:"../../images/Icons/Card-file-icon64.png",title:Globalize.formatMessage("tabGeneralTitleDocumentos"),template:"tab_DocumentosTk"}]);
a.CamposVisiblesDG=!0;a.BotonesDisponibles=!1;break;case 2:a.TabPanel_Ticket_Detalle.option("dataSource",[{icon:"../../images/Icons/surveys128.png",title:Globalize.formatMessage("tabGeneralTitleTicket"),template:"tab_frmticketservicio"},{icon:"../../images/Icons/Card-file-icon64.png",title:Globalize.formatMessage("tabGeneralTitleRepFoto"),template:"tab_RepFotograf"},{icon:"../../images/Icons/Card-file-icon64.png",title:Globalize.formatMessage("tabGeneralTitleDocumentos"),template:"tab_DocumentosTk"}]),
a.CamposVisiblesDG=!0,a.BotonesDisponibles=!0}};a.VistaSegunCondicion();$("#Frm_Btn_AgregarBitacora").dxForm({showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",labelLocation:"top",screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:1,colCount:1,items:[{colSpan:1,itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Agregar Bitacora",icon:"add",type:"success",width:"100%",visible:!0,disabled:!1,onInitialized:function(b){$_Btn_Agregar_Bitacora=
b.component},onClick(){1==a.DataTicketOpen.TIC_CERRADO?DevExpress.ui.notify({message:"LA SOLICITUD YA SE ENCUENTRA CERRADO.",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"}):$("#Pop_Insertar_BitacoraManual").dxPopup("show")}}},{colSpan:9,template:" "}]}]});$("#Form_Btn_Cargar_Imagen_Sistema").dxForm({showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",labelLocation:"top",screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:1,
colCount:1,items:[{colSpan:1,itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:Globalize.formatMessage("Add_Document"),icon:"upload",type:"success",width:"100%",visible:!0,disabled:!1,onInitialized:function(b){$_Btn_Cargar_Imagen_Sistema=b.component},onClick(){1==a.DataTicketOpen?.TIC_CERRADO?DevExpress.ui.notify({message:`${Globalize.formatMessage("infoTicketClosed")}`,minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"}):(1==a.setDefaultValues&&
a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Las im\u00e1genes se dar\u00e1n de alta autom\u00e1ticamente cuando salve el ticket.",400,130),a.uploadImageToTicket(!0))}}},{colSpan:9,template:" "}]}]});a.uploadImageToTicket=async function(b=!1){if(null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Selecciona el proveedor en el detalle de solicitud",
400,130);else{var c=a.imageUploadToTicket.option("value"),d=a.imageUploadToTicket._files;if(0!=c.length)if(1==b&&0==c.length)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debe seleccionar al menos 1 imagen",400,130);else{if(0<d.length)for(b=0;b<d.length;b++)if(0==d[b].isValid()){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Un archivo no cumple con las reglas",400,130);return}d=[];b=new FormData;var e=new FormData,
f={},m={Authorization:"Bearer YOUR_ACCESS_TOKEN","Custom-Header":"YourHeaderValue"};if(5==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){f={ClaveEmp:"CREATIF",EmpresaHost:"1",TypeCon:"Pro",ClaveDoc:"TICKET",IdEmpleado:1,cscEmpleado:1,NewIdEquipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),OrigenCrea:1};e.append("extra",JSON.stringify(f));if(0<c.length)for(f=0;f<c.length;f++)e.append("fileToUpload",c[f]);d.push(a.cargaImagenServidores("https://objecstorage.dnasystem.io/UploadImagenTicketOts",
e,m))}if(38==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){f={ClaveEmp:"SRMSOTIC",EmpresaHost:"1",TypeCon:"Pro",ClaveDoc:"TICKET",IdEmpleado:1,cscEmpleado:1,NewIdEquipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),OrigenCrea:1};e.append("extra",JSON.stringify(f));if(0<c.length)for(f=0;f<c.length;f++)e.append("fileToUpload",c[f]);d.push(a.cargaImagenServidores("https://objecstorage.dnasystem.io/UploadImagenTicketOts",e,m))}if(8==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&
0<c.length){e=[];for(f=0;f<c.length;f++){var h=c[f];if(3145728<h.size){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El archivo ${h.name} excede el l\u00edmite de tama\u00f1o de 3 MB. Por favor, sube archivos m\u00e1s peque\u00f1os.`,400,130);return}var r=await a.readFileAsBase64(h);r=a.extractBase64Data(r);e.push({AttachmenType:h.type,AttachmenName:h.name,AttachmenSize:h.size,AttachmenBlob:r})}e={...ReturnDefaultData_Init(),TIC_NEWID:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),
TIC_ID_EXTERNO_PROVEEDOR:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),aryImages:e};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"uploadImagesTicketUninetCosci","POST",JSON.stringify(e),getJSON(DeveloperType).ApiTickets_v2.token).then(t=>{console.log(t)})}if(11==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&0<c.length){e=[];for(f=0;f<c.length;f++){h=c[f];if(3145728<h.size){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
`El archivo ${h.name} excede el l\u00edmite de tama\u00f1o de 3 MB. Por favor, sube archivos m\u00e1s peque\u00f1os.`,400,130);return}r=await a.readFileAsBase64(h);r=a.extractBase64Data(r);e.push({AttachmenType:h.type,AttachmenName:h.name,AttachmenSize:h.size,AttachmenBlob:r})}e={...ReturnDefaultData_Init(),TIC_NEWID:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),TIC_ID_EXTERNO_PROVEEDOR:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),aryImages:e};
__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"uploadImagesTicketUninetWlanEndPoint","POST",JSON.stringify(e),getJSON(DeveloperType).ApiTickets_v2.token).then(t=>{console.log(t)})}if(20==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&0<c.length){e=[];for(f=0;f<c.length;f++){h=c[f];if(3145728<h.size){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El archivo ${h.name} excede el l\u00edmite de tama\u00f1o de 3 MB. Por favor, sube archivos m\u00e1s peque\u00f1os.`,
400,130);return}r=await a.readFileAsBase64(h);r=a.extractBase64Data(r,!1);e.push({AttachmenType:h.type,AttachmenName:h.name,AttachmenSize:h.size,AttachmenBlob:r})}e={...ReturnDefaultData_Init(),TIC_NEWID:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),TIC_ID_EXTERNO_PROVEEDOR:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),aryImages:e};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"uploadFilesTicketAsNice","POST",JSON.stringify(e),
getJSON(DeveloperType).ApiTickets_v2.token).then(t=>{console.log(t)})}e={ClaveEmp:localStorage.getItem("EMP_CLV_EMPRESA"),idEmpleadoProvider:q.EMPLEADO_CSC_EMPLEADO,newIdTicket:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value")};b.append("extra",JSON.stringify(e));if(0<c.length)for(e=0;e<c.length;e++)b.append("fileToUpload",c[e]);d.push(a.cargaImagenServidores(`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}uploadImagesToTicket/${a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}`,
b,m));try{(await Promise.allSettled(d)).forEach((t,u)=>{"fulfilled"===t.status?(console.log(`Promesa ${u+1} se resolvi\u00f3 correctamente.`),a.imageUploadToTicket.reset(),a.Get_Ticket_Foto()):console.log(`Promesa ${u+1} fall\u00f3.`)})}catch(t){console.error("Error en el proceso de carga",t),DevExpress.ui.notify({message:"Ocurri\u00f3 un error en el proceso de carga.",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})}}}};a.cargaImagenServidores=async function(b,
c,d={}){try{const e=new XMLHttpRequest;e.open("POST",b);for(const [f,m]of Object.entries(d))e.setRequestHeader(f,m);e.upload.addEventListener("progress",function(f){f.lengthComputable&&(f=f.loaded/f.total,f=parseInt(100*f),console.log(`Progreso: ${f}%`))},!1);return new Promise((f,m)=>{e.onload=()=>{if(200===e.status){const h=JSON.parse(e.responseText);!0===h.success?(DevExpress.ui.notify({message:"Imagen(es) cargada(s) correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",
direction:"up-push"}),f(h)):m("Error al subir la imagen")}else m("Error de comunicaci\u00f3n con el servidor")};e.onerror=()=>{m("Error de comunicaci\u00f3n con el servidor")};e.send(c)})}catch(e){console.error(e),DevExpress.ui.notify({message:"Error de comunicaci\u00f3n con servidor",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})}};$("#Form_Btn_Agregar_Documento").dxForm({showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",labelLocation:"top",
screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:1,colCount:1,items:[{colSpan:1,itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:Globalize.formatMessage("Add_Document"),icon:"upload",type:"success",width:"100%",visible:!0,disabled:!1,onInitialized:function(b){$_Btn_Agregar_Documento=b.component},onClick(){1==a.DataTicketOpen?.TIC_CERRADO?DevExpress.ui.notify({message:`${Globalize.formatMessage("infoTicketClosed")}`,minWidth:150,type:"info",displayTime:5E3},
{position:"bottom right",direction:"up-push"}):a.uploadFileToTicket(!0)}}},{colSpan:9,template:" "}]}]});a.uploadFileToTicket=async function(b=!1){if(null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Selecciona el proveedor en el detalle de solicitud",400,130);else{var c=a.documentsUploadToTicket.option("value"),d=a.documentsUploadToTicket._files;if(0!=c.length)if(1==
b&&0==c.length)a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debe seleccionar al menos 1 archivo",400,130);else{if(0<d.length)for(b=0;b<d.length;b++)if(0==d[b].isValid()){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Un archivo no cumple con las reglas",400,130);return}d=[];b=new FormData;var e=new FormData,f={},m={Authorization:"Bearer YOUR_ACCESS_TOKEN","Custom-Header":"YourHeaderValue"};if(5==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){f=
{ClaveEmp:"CREATIF",EmpresaHost:"1",TypeCon:"Pro",ClaveDoc:"TICKET",IdEmpleado:1,cscEmpleado:1,NewIdEquipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),OrigenCrea:1};e.append("extra",JSON.stringify(f));if(0<c.length)for(f=0;f<c.length;f++)e.append("fileToUpload",c[f]);d.push(a.cargaDocumentosServidores("https://objecstorage.dnasystem.io/UploadDocumentosTicketOts",e,m))}if(38==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){f={ClaveEmp:"SRMSOTIC",
EmpresaHost:"1",TypeCon:"Pro",ClaveDoc:"TICKET",IdEmpleado:1,cscEmpleado:1,NewIdEquipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),OrigenCrea:1};e.append("extra",JSON.stringify(f));if(0<c.length)for(f=0;f<c.length;f++)e.append("fileToUpload",c[f]);d.push(a.cargaDocumentosServidores("https://objecstorage.dnasystem.io/UploadDocumentosTicketOts",e,m))}if(20==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&0<c.length){e=[];for(f=0;f<c.length;f++){let r=
c[f];if(3145728<r.size){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El archivo ${r.name} excede el l\u00edmite de tama\u00f1o de 3 MB. Por favor, sube archivos m\u00e1s peque\u00f1os.`,400,130);return}var h=await a.readFileAsBase64(r);h=a.extractBase64Data(h,!1);e.push({AttachmenType:r.type,AttachmenName:r.name,AttachmenSize:r.size,AttachmenBlob:h})}e={...ReturnDefaultData_Init(),TIC_NEWID:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value"),
TIC_ID_EXTERNO_PROVEEDOR:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ID_EXTERNO_PROVEEDOR").option("value"),aryImages:e};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"uploadFilesTicketAsNice","POST",JSON.stringify(e),getJSON(DeveloperType).ApiTickets_v2.token).then(r=>{console.log(r)})}e={ClaveEmp:localStorage.getItem("EMP_CLV_EMPRESA"),idEmpleadoProvider:q.EMPLEADO_CSC_EMPLEADO,newIdTicket:a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value")};b.append("extra",JSON.stringify(e));
if(0<c.length)for(e=0;e<c.length;e++)b.append("fileToUpload",c[e]);d.push(a.cargaDocumentosServidores(`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}uploadDocumentToTicket/${a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}`,b,m));try{(await Promise.allSettled(d)).forEach((r,t)=>{"fulfilled"===r.status?(console.log(`Promesa ${t+1} se resolvi\u00f3 correctamente.`),a.documentsUploadToTicket.reset(),a.Get_Ticket_Documentos(!1)):console.log(`Promesa ${t+
1} fall\u00f3.`)})}catch(r){console.error("Error en el proceso de carga",r),DevExpress.ui.notify({message:"Ocurri\u00f3 un error en el proceso de carga.",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})}}}};a.cargaDocumentosServidores=async function(b,c,d={}){try{const e=new XMLHttpRequest;e.open("POST",b);for(const [f,m]of Object.entries(d))e.setRequestHeader(f,m);e.upload.addEventListener("progress",function(f){f.lengthComputable&&(f=f.loaded/f.total,f=parseInt(100*
f),console.log(`Progreso: ${f}%`))},!1);return new Promise((f,m)=>{e.onload=()=>{if(200===e.status){const h=JSON.parse(e.responseText);!0===h.success?(DevExpress.ui.notify({message:"Documento(s) cargada(s) correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}),f(h)):m("Error al subir documento(s)")}else m("Error de comunicaci\u00f3n con el servidor")};e.onerror=()=>{m("Error de comunicaci\u00f3n con el servidor")};e.send(c)})}catch(e){console.error(e),
DevExpress.ui.notify({message:"Error de comunicaci\u00f3n con servidor",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})}};$("#Form_Btn_Agregar_Mensaje").dxForm({showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",labelLocation:"top",screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:1,colCount:1,items:[{colSpan:1,itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Agregar Respuesta",icon:"add",
type:"success",width:"100%",visible:!0,disabled:!1,onInitialized:function(b){$_Btn_Agregar_Respuesta=b.component},onClick(){1==a.DataTicketOpen.TIC_CERRADO?DevExpress.ui.notify({message:"LA SOLICITUD YA SE ENCUENTRA CERRADO.",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"}):$("#Pop_CrearVerRespuesta").dxPopup("show")}}},{colSpan:9,template:" "}]}]});$("#Form_Btn_Alta_Ticket_Ot").dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,labelMode:"static",
labelLocation:"top",colCount:1,screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:1,colCount:1,items:[{colSpan:1,itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Agregar Orden de trabajo",icon:"add",type:"success",width:"100%",visible:!0,onInitialized:function(b){$_btn_Alta_Ticket_Ot=b.component},onClick(){1==a.DataTicketOpen.TIC_CERRADO?DevExpress.ui.notify({message:"LA SOLICITUD YA SE ENCUENTRA CERRADO.",minWidth:150,type:"info",displayTime:5E3},
{position:"bottom right",direction:"up-push"}):g("ALTA",null,a.DataTicketOpen.TIC_CSCTICKET)}}},{colSpan:9,template:" "}]}]});a.Frm_Autoriza_Instance=$("#Form_Btn_Alta_Autorizacion").dxForm({readOnly:!1,showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"Form_Btn_Alta_Autorizacion",labelMode:"static",labelLocation:"top",colCount:4,screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",colSpan:4,colCount:4,items:[{colSpan:4,dataField:"TIPO_AREA_CSC_RESPONSABLE",editorType:"dxSelectBox",
label:{text:"Area"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_AREA_IDIOMA1",valueExpr:"TIPO_AREA_CSC",dataSource:new DevExpress.data.DataSource({store:new DevExpress.data.CustomStore({key:"TIPO_AREA_CSC",loadMode:"raw",paginate:!1,load:async function(){return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_AREA"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return jslinq(b.JsonData).where(function(c){return c.CAM_CSC_MESA==
q.CAM_CSC_MESA}).orderBy(function(c){return c.TIPO_AREA_IDIOMA1}).toList();console.log(b.message)})}})}),onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPO_AREA_CSC=c;c=jslinq(c).where(function(d){return 1==d.TIPO_AREA_ACTIVO}).toList();b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPO_AREA_CSC&&b.component.option("dataSource",a.TIPO_AREA_CSC)},onValueChanged:function(b){b=b.value;var c=a.Frm_Autoriza_Instance.getEditor("CAT_DEPTO_CSC_RESPONSABLE");
c.option("value",null);b={Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_AREA_CSC = "+b};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",b,getJSON(DeveloperType).ApiGeneral.token).then(d=>{1==d.success?c.option("dataSource",d.JsonData):c.option("dataSource",[])})}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:4,dataField:"CAT_DEPTO_CSC_RESPONSABLE",editorType:"dxSelectBox",label:{text:"Departamento"},
editorOptions:{searchEnabled:!0,displayExpr:"SAMT_TIPO_DEPARTAMENTO_IDIOMA1",valueExpr:"EMPLEADO_DEPARTAMENTO_CSC",onValueChanged:function(b){b=b.value;var c=a.Frm_Autoriza_Instance.getEditor("EMPLEADO_CSC_EMPLEADO");b={...ReturnDefaultData_Init(),...ReturnProcSubProcEstatus(),TIPO_CONSULTA:"AVANZADO",INFO:"ALLEMP",CAT_DEPARTAMENTO_CSC:b};__Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+"GetEmpleado","GET",b,getJSON(DeveloperType).ApiRecursosHumanos.token).then(d=>{1==d.success&&c.option("dataSource",
d.JsonData);p.hide()}).catch(function(d){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);p.hide()})}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:4,dataField:"EMPLEADO_CSC_EMPLEADO",editorType:"dxSelectBox",label:{text:"Empleado Asignado"},editorOptions:{searchEnabled:!0,displayExpr:"NOMBRE",valueExpr:"EMPLEADO_CSC_EMPLEADO",deferRendering:!1,onValueChanged:function(b){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:4,
itemType:"button",location:"before",locateInMenu:"auto",buttonOptions:{text:"Solicitar autorizaci\u00f3n",icon:"add",type:"success",width:"100%",visible:!0,onInitialized:function(b){$btn_Alta_Ticket_Autorizacion=b.component},onClick(){if(1==a.DataTicketOpen.TIC_CERRADO)DevExpress.ui.notify({message:"LA SOLICITUD YA SE ENCUENTRA CERRADO.",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"});else if(!0===a.Frm_Autoriza_Instance.validate().isValid){p.show();var b=
a.Frm_Ticket_Servicio_Instance.option("formData"),c=GetInsertData(a.Frm_Autoriza_Instance.option("formData"),a.Frm_Autoriza_Instance);c.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_FEC_ALTA=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");c.AUDITORIA_FEC_ULT_MOD=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");c.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");c.AUTORIZACIONES_TIC_NEWID=b.TIC_NEWID;
c.CAM_MESA_CSC=b.CAM_MESA_CSC;c.SAMT_TIPO_RESPUESTA_AUTORIZA_CSC=2;c.AUTORIZACIONES_NEWID=createUUID(36);c.AUTORIZADO_ACTIVO=1;delete c.CAT_DEPTO_CSC_RESPONSABLE;delete c.TIPO_AREA_CSC_RESPONSABLE;c={...ReturnDefaultData_Init(),DATA_INSERT:c};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Autoriza_Ticket","POST",JSON.stringify(c),getJSON(DeveloperType).ApiTickets_v2.token).then(d=>{1==d.success&&(a.Frm_Autoriza_Instance.resetValues(),DevExpress.ui.notify({message:"Solicitud de autorizaci\u00f3n agregada correctamente",
minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}),a.Get_Autorizaciones_Ticket(b.TIC_NEWID),b.TIC_FECHA_ALTA&&ConvertDatetimeToStringBD(b.TIC_FECHA_ALTA),b.TIC_FECHA_PROMESA&&ConvertDatetimeToStringBD(b.TIC_FECHA_PROMESA),b.TIC_FECHA_SOLICITA&&ConvertDatetimeToStringBD(b.TIC_FECHA_SOLICITA));p.hide();return d}).catch(function(d){console.log(d);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",
displayTime:5E3},{position:"bottom right",direction:"up-push"})})}}}},{colSpan:9,template:" "}]}]}).dxForm("instance");a.Frm_Ticket_Servicio_Instance=$("#__Frm_Ticket_Servicio").dxForm({onContentReady:function(){setTimeout(()=>{if("EDITAR"==getUrlParam("TIPO")){var b={...ReturnDefaultData_Init(),TIC_NEWID:getUrlParam("TK_ID")};a.Get_Tickets(b,!1,null)}else if("ALTA"==getUrlParam("TIPO")){try{a.ClickAlta()}catch(c){console.log(c)}$("#__Frm_Ticket_Servicio").dxForm("instance").getEditor("CAM_MESA_CSC").option("value",
getUrlParam("CSC_MESA"))}else"LECTURA"==getUrlParam("TIPO")&&(b={...ReturnDefaultData_Init(),TIC_NEWID:getUrlParam("TK_ID")},a.Get_Tickets(b,!1,null),$("#___Tb_Tickets").dxToolbar("instance").option("visible",!1));$("#splashscreen").fadeOut(1E3)},1E3)},readOnly:!0,height:"100%",showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"__Frm_Ticket_Servicio_Validation",labelMode:"outside",labelLocation:"top",screenByWidth(b){return 700>b?"sm":"lg"},items:[{itemType:"group",cssClass:"hidden_box",
colCount:6,items:[{colSpan:6,dataField:"TIC_JSON_EXTRA_PARAMS",label:{text:"JSONPARAMSEX"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:6,dataField:"TIC_TIEMPO_RECEPCION",label:{text:"TRECEPCION"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:6,dataField:"TIC_TIEMPO_EJECUCION",label:{text:"TEJECUTA"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:6,dataField:"TIC_TIEMPO_CONFIRMACION",label:{text:"TCONFIRMA"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:6,dataField:"TIC_NEWID",label:{text:"UUID"},
editorOptions:{readOnly:!0,disabled:!1}}]},{itemType:"group",colCount:6,items:[{colSpan:2,dataField:"TIC_FECHA_ALTA",editorType:"dxDateBox",label:{text:"Fecha de alta"},editorOptions:{type:"datetime",readOnly:!0,width:"100%",placeholder:"DD/MM/AAAA HH:mm:ss",useMaskBehavior:!0,displayFormat:"dd/MM/yyyy HH:mm:ss",dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss",onValueChanged:function(b){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:1,dataField:"TIC_CSCTICKET",label:{text:`${Globalize.formatMessage("ticketNumber")}`},
editorOptions:{readOnly:!0,disabled:!1}},{colSpan:1,dataField:"TIC_ID_EXTERNO_PROVEEDOR",label:{text:"Ticket Externo"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"TIC_CERRADO",editorType:"dxSwitch",label:{text:"Abierto/Cerrado"},editorOptions:{readOnly:!0,switchedOffText:"Abierto",switchedOnText:"Cerrado",width:"100%",onValueChanged:function(b){}}},{colSpan:2,dataField:"CAM_MESA_CSC",editorType:"dxSelectBox",label:{text:`${Globalize.formatMessage("lblMesaCsc")}`},editorOptions:{searchEnabled:!0,
displayExpr:"CAM_MESA_IDIOMA1",valueExpr:"CAM_MESA_CSC",dataSource:a._CMB_SAMT_CAM_MESA_DE_AYUDA_OBJDATA,readOnly:!0,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.CAM_MESA_CSC=c;c=jslinq(c).where(function(d){return 1==d.CAM_MESA_ACTIVO}).toList();b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.CAM_MESA_CSC&&b.component.option("dataSource",a.CAM_MESA_CSC)},onValueChanged:function(b){}},validationRules:[{type:"required",
message:"requerido"}]},{colSpan:2,dataField:"CLIENTE_CSC_SOLICITA",editorType:"dxSelectBox",label:{text:Globalize.formatMessage(`Etiquetas_${localStorage.getItem("EMP_CLV_EMPRESA")}_ticketCliente`)},editorOptions:{readOnly:!0,searchEnabled:!0,displayExpr:"CLIENTE_NOMBRE",valueExpr:"CLIENTE_CSC",deferRendering:!1,dataSource:a._CMB_SAMT_CLIENTES_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.CLIENTE_CSC=c;c=jslinq(c).where(function(d){return 1==d.TIPO_ESTATUS_CLIENTE_CSC}).toList();
b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.CLIENTE_CSC&&b.component.option("dataSource",a.CLIENTE_CSC)},onValueChanged:function(b){a.Frm_Ticket_Servicio_Instance.getEditor("PM_CSC_PROYECTO_SOLICITA").option("value",null)}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"PM_CSC_PROYECTO_SOLICITA",editorType:"dxSelectBox",label:{text:Globalize.formatMessage(`Etiquetas_${localStorage.getItem("EMP_CLV_EMPRESA")}_ticketCampania`)},
editorOptions:{searchEnabled:!0,displayExpr:"PM_NOMBRE",valueExpr:"PM_CSC_PROYECTO",dataSource:a._CMB_SAMT_PROYECTOS_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.PM_CSC_PROYECTO_SOLICITA=c;c=jslinq(a._ClienteProyectoCampania_ObjData._array).where(function(d){return 3==d.CAM_CSC_SERVICIO||25==d.CAM_CSC_SERVICIO||6==d.CAM_CSC_SERVICIO||2==d.CAM_CSC_SERVICIO}).toList();b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==
a.PM_CSC_PROYECTO_SOLICITA&&b.component.option("dataSource",a.PM_CSC_PROYECTO_SOLICITA)},onValueChanged:function(b){let c=b.value;null!=b.component.option("selectedItem")&&(b=jslinq(a._CMB_SAMT_CAM_SERVICIO_OBJDATA._array).where(function(d){return d.PM_CSC_PROYECTO==c}).toList(),a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value",b[0].CAM_CSC_SERVICIO))}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"CAM_CSC_SERVICIO_SOLICITA",editorType:"dxSelectBox",
label:{text:Globalize.formatMessage(`Etiquetas_${localStorage.getItem("EMP_CLV_EMPRESA")}_ticketSubCampania`)},editorOptions:{searchEnabled:!0,displayExpr:"CAM_SERVICIO_NOMBRE",valueExpr:"CAM_CSC_SERVICIO",dataSource:a._CMB_SAMT_CAM_SERVICIO_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.CAM_CSC_SERVICIO_SOLICITA=c;c=jslinq(c).where(function(d){return 1==d.TIPO_ESTATUS_CAM_CSC&&d.PM_CSC_PROYECTO==a.Frm_Ticket_Servicio_Instance.getEditor("PM_CSC_PROYECTO_SOLICITA").option("value")}).toList();
b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.CAM_CSC_SERVICIO_SOLICITA&&b.component.option("dataSource",a.CAM_CSC_SERVICIO_SOLICITA)},onValueChanged:function(b){var c=b.value;console.log(c);11==parseInt(c)||8==parseInt(c)?a.Frm_Ticket_Servicio_Instance.itemOption("TAG_COMPONENTE","isRequired",!1):a.Frm_Ticket_Servicio_Instance.itemOption("TAG_COMPONENTE","isRequired",!0);7793==parseInt(c)?a.Frm_Ticket_Servicio_Instance.itemOption("TIC_AUXS3",{validationRules:[{type:"required",
message:"Este campo es obligatorio"},{type:"pattern",pattern:/^\+[0-9]{5}$/,message:"Debe ser un '+' seguido de 5 d\u00edgitos"},{type:"stringLength",min:6,max:6,message:"Debe tener exactamente 6 caracteres (incluyendo el '+')"}]}):a.Frm_Ticket_Servicio_Instance.itemOption("TIC_AUXS3",{validationRules:[{type:"pattern",pattern:/^\+[0-9]{5}$/,message:"Debe ser un '+' seguido de 5 d\u00edgitos"}]});if(1==a.setDefaultValues){var d=jslinq(a._CMB_SAMT_ESTATUS_TICKET_OBJDATA._array).where(function(e){return e.CAM_CSC_SERVICIO==
c&&"DEFAULT"==e.ESTATUS_TICKET_CLAVE}).toList();a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("value",d[0].ESTATUS_TICKET_CSC);d=jslinq(a._CMB_SAMT_TIPO_TICKET_OBJDATA._array).where(function(e){return e.CAM_CSC_SERVICIO==c&&1==e.TIPO_TICKET_DEFAULT}).toList();a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_TICKET_CSC").option("value",d[0].TIPO_TICKET_CSC);d=jslinq(a._CMB_SAMT_TIPO_PRIORIDAD_TICKET_OBJDATA._array).where(function(e){return e.CAM_CSC_SERVICIO==c&&1==e.TIPO_PRIORIDAD_DEFAULT}).toList();
a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("value",d[0].TIPO_PRIORIDAD_CSC);d=jslinq(a._CMB_SAMT_TIPO_SEVERIDAD_OBJDATA._array).where(function(e){return e.CAM_CSC_SERVICIO==c&&1==e.TIPO_SEVERIDAD_TICKET_DEFAULT}).toList();a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_SEVERIDAD_CSC").option("value",d[0].TIPO_SEVERIDAD_CSC);d=jslinq(a._CMB_SAMT_CAM_TIPO_SERVICIO_OBJDATA._array).where(function(e){return 1==e.TIPO_SERVICIO_DEFAULT}).toList();a.Frm_Ticket_Servicio_Instance.getEditor("SAMT_CAM_TIPO_SERVICIO_CSC").option("value",
d[0].SAMT_CAM_TIPO_SERVICIO_CSC);b=b.component.option("selectedItem");null!=b&&a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("value",b.CAM_SERVICIO_NOMBRE)}b={Tbl:"SAMT_REQUISICION_PROVEEDORES",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND CAM_CSC_SERVICIO = "+c};__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",b,getJSON(DeveloperType).ApiGeneral.token).then(e=>{!0===e.success&&(jslinq(e.JsonData).toList().forEach(function(f){a._CMB_SAMT_REQUISICIONES_OBJDATA.insert(f)}),
a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("dataSource",e.JsonData))})}}},{colSpan:2,dataField:"ESTATUS_TICKET_CSC",editorType:"dxSelectBox",label:{text:"Estado"},editorOptions:{searchEnabled:!0,displayExpr:"ESTATUS_TICKET_IDIOMA1",valueExpr:"ESTATUS_TICKET_CSC",dataSource:a._CMB_SAMT_ESTATUS_TICKET_OBJDATA,readOnly:!0,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.ESTATUS_TICKET_CSC=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?
(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){return 1==d.ESTATUS_TICKET_ACTIVO&&d.CAM_CSC_SERVICIO==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.ESTATUS_TICKET_CSC&&b.component.option("dataSource",
a.ESTATUS_TICKET_CSC)},onValueChanged:function(b){var c=b.component.option("selectedItem");if(null!=c){console.log(c);1==a.editandoForma&&1==c.ESTATUS_TICKET_PAUSAR&&(a.pauseTicket=!0);1==c.ESTATUS_TICKET_CERRAR&&"CANCELADO"==c.ESTATUS_TICKET_CLAVE?(a.Frm_Ticket_Servicio_Instance.getEditor("TIC_CERRADO").option("value",!0),a.Frm_Ticket_Servicio_Instance.itemOption("TIC_DESCRIPCION_SOLUCION","isRequired",!0)):(a.Frm_Ticket_Servicio_Instance.getEditor("TIC_CERRADO").option("value",!1),a.Frm_Ticket_Servicio_Instance.itemOption("TIC_DESCRIPCION_SOLUCION",
"isRequired",!1));if("RESUELTO"==c.ESTATUS_TICKET_CLAVE||"CANCELADO"==c.ESTATUS_TICKET_CLAVE)if(void 0==a._Datagrid_Ot_Ticket||void 0==a._DataGrid_Autorizacion){b=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_CALIFICACION_CSC");var d=b.option("dataSource");d=jslinq(d.items()).where(function(m){return"NA"==m.TIPO_CALIFICACION_CLAVE}).toList();b.option("value",d[0].TIPO_CALIFICACION_CSC);a.Frm_Ticket_Servicio_Instance.itemOption("TIC_DESCRIPCION_SOLUCION","isRequired",!0)}else{if(null!=a._DataGrid_Autorizacion.getDataSource()&&
null!=a._Datagrid_Ot_Ticket.getDataSource()){d=a._DataGrid_Autorizacion.getVisibleRows();var e=[];$.each(d,function(m,h){m=a._DataGrid_Autorizacion.columnOption("SAMT_TIPO_RESPUESTA_AUTORIZA_CSC","lookup.dataSource");m=jslinq(m.store.__rawData).where(function(r){return r.SAMT_TIPO_RESPUESTA_AUTORIZA_CSC==h.data.SAMT_TIPO_RESPUESTA_AUTORIZA_CSC}).toList();e.push("PEND"===m[0].TIPO_RESPUESTA_AUTORIZA_CLAVE?!0:!1)});d=e.some(function(m){return!0===m});var f=a._Datagrid_Ot_Ticket.getDataSource().items();
if(1<=jslinq(f).where(function(m){return 0==m.OTR_CERRADA}).toList().length||1==d){DevExpress.ui.notify({message:"AUN HAY OTS ABIERTAS O AUTORIZACIONES PENDIENTES, NO ES POSIBLE REALIZAR MODIFICACION",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"});b.component.option("value",b.previousValue);return}b=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_CALIFICACION_CSC");d=b.option("dataSource");d=jslinq(d.items()).where(function(m){return"NA"==m.TIPO_CALIFICACION_CLAVE}).toList();
b.option("value",d[0].TIPO_CALIFICACION_CSC)}}else a.Frm_Ticket_Servicio_Instance.getEditor("TIC_CERRADO").option("value",!1),a.Frm_Ticket_Servicio_Instance.itemOption("TIC_DESCRIPCION_SOLUCION","isRequired",!1);"NUEVO"!=c.ESTATUS_TICKET_CLAVE?null==a.Frm_Ticket_Servicio_Instance.option("formData").EMPLEADO_CSC_ATIENDE?(console.log("SE BUSCA QUE NO ESTE ASIGNADO Y SE ASIGNA AL QUE MODIFICA"),"GENERA"!=getUrlParam("TPO_USUARIO")&&(a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_ATIENDE").option("value",
q.EMPLEADO_CSC_EMPLEADO),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("value",q.EMPLEADO_NOMBREEMPLEADO+" "+q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO))):console.log("YA ESTA ASIGNADO"):console.log("NO SE BUSCA A NADIE")}}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"TIPO_TICKET_CSC",editorType:"dxSelectBox",label:{text:`${Globalize.formatMessage("lblTipoCsc")}`},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_TICKET_IDIOMA1",
valueExpr:"TIPO_TICKET_CSC",dataSource:a._CMB_SAMT_TIPO_TICKET_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPO_TICKET_CSC=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){return 1==d.TIPO_TICKET_ACTIVO&&
d.CAM_CSC_SERVICIO==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPO_TICKET_CSC&&b.component.option("dataSource",a.TIPO_TICKET_CSC)},onValueChanged:function(b){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"TIPO_PRIORIDAD_CSC",editorType:"dxSelectBox",label:{text:"Prioridad"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_PRIORIDAD_IDIOMA1",
valueExpr:"TIPO_PRIORIDAD_CSC",dataSource:a._CMB_SAMT_TIPO_PRIORIDAD_TICKET_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPO_PRIORIDAD_CSC=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){return 1==d.TIPO_PRIORIDAD_ACTIVO&&
d.CAM_CSC_SERVICIO==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPO_PRIORIDAD_CSC&&b.component.option("dataSource",a.TIPO_PRIORIDAD_CSC)},onValueChanged:function(b){}}},{colSpan:2,dataField:"SAMT_CAM_TIPO_SERVICIO_CSC",editorType:"dxSelectBox",label:{text:"Canal"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_SERVICIO_IDIOMA1",valueExpr:"SAMT_CAM_TIPO_SERVICIO_CSC",
dataSource:a._CMB_SAMT_CAM_TIPO_SERVICIO_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.SAMT_CAM_TIPO_SERVICIO_CSC=c;c=jslinq(c).where(function(d){return 1==d.TIPO_SERVICIO_ACTIVO}).toList();b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.SAMT_CAM_TIPO_SERVICIO_CSC&&b.component.option("dataSource",a.SAMT_CAM_TIPO_SERVICIO_CSC)},onValueChanged:function(b){}},validationRules:[{type:"required",message:"requerido"}]},
{colSpan:2,dataField:"TIPO_SEVERIDAD_CSC",editorType:"dxSelectBox",label:{text:"Severidad"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_SEVERIDAD_TICKET_IDIOMA1",valueExpr:"TIPO_SEVERIDAD_CSC",dataSource:a._CMB_SAMT_TIPO_SEVERIDAD_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPO_SEVERIDAD_CSC=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){return 1==d.TIPO_SEVERIDAD_TICKET_ACTIVO&&d.CAM_CSC_SERVICIO==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPO_SEVERIDAD_CSC&&b.component.option("dataSource",a.TIPO_SEVERIDAD_CSC)},onValueChanged:function(b){}}},{colSpan:6,template:"<div class='heading_InnerFrm'><h2>Solicitante</h2></div>"},
{colSpan:2,dataField:"EMPLEADO_CSC_SOLICITA",editorType:"dxTextBox",label:{text:"Id Solicitante"},editorOptions:{readOnly:!0}},{colSpan:2,dataField:"TIC_SOLICITA",editorType:"dxTextBox",label:{text:"Nombre Solicitante"},editorOptions:{buttons:[{name:"btn_BuscarEmpleado",location:"after",options:{stylingMode:"Contained",icon:"search",type:"normal",onClick(b){a.BusquedaEmpleado("Solicita","single")}}}]}},{colSpan:2,dataField:"TIC_EMAIL_SOLICITANTE",editorType:"dxTextBox",label:{text:"Correo electr\u00f3nico"},
editorOptions:{mode:"email",valueChangeEvent:"keyup",onValueChanged:function(b){null!=b.value&&""!=b.value&&b.component.option("value",b.value.toLowerCase())}},validationRules:[{type:"required",message:"requerido"},{type:"email",message:"Formato de correo incorrecto."}]},{colSpan:2,dataField:"TIC_TELEFONO_SOLICITANTE",editorType:"dxTextBox",label:{text:"Tel\u00e9fono"},editorOptions:{},validationRules:[{type:"required",message:"requerido"},{type:"stringLength",max:10,message:"Maximo 10 caractres"},
{type:"stringLength",min:10,message:"Minimo 10 caractres"}]},{colSpan:2,dataField:"TIC_AUXS3",editorType:"dxTextBox",label:{text:"Extensi\u00f3n (Utilizar el simbolo de + y 5 digitos)"},editorOptions:{placeholder:"Ejemplo +12345"}},{colSpan:2,dataField:"REQ_CSCREQUISICION",editorType:"dxSelectBox",label:{text:"Ubicaci\u00f3n/Aduana/Almacen"},editorOptions:{searchEnabled:!0,displayExpr:"REQUISICION_PROVEEDORES_NOMBRE",valueExpr:"SAMT_REQUISICION_PROVEEDORES_CSC",dataSource:a._CMB_SAMT_REQUISICIONES_OBJDATA,
onOpened:function(b){b.component.getDataSource().load().done(function(c){a.REQ_CSCREQUISICION=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){return 1==d.REQUISICION_PROVEEDORES_ACTIVO&&d.CAM_CSC_SERVICIO==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")}).toList(),
b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.REQ_CSCREQUISICION&&b.component.option("dataSource",a.REQ_CSCREQUISICION)},onValueChanged:function(b){b=b.component.option("selectedItem");null!=b&&a.Frm_Ticket_Servicio_Instance.getEditor("TIC_CODIGO_VPN").option("value",b.REQUISICION_PROVEEDORES_CODIGO_VPN)}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:2,dataField:"TIC_SEGMENTACION_INM_DES",editorType:"dxTextBox",label:{text:"Ubicaci\u00f3n"},
editorOptions:{valueChangeEvent:"keyup",onValueChanged:function(b){null!=b.value&&""!=b.value&&b.component.option("value",b.value.toUpperCase())}}}]},{colSpan:6,template:"<div class='heading_InnerFrm'><h2>Detalle de solicitud</h2></div>"},{itemType:"group",colCount:6,items:[{itemType:"group",colSpan:2,colCount:2,items:[{colSpan:2,template:"<div class='heading_InnerFrm'><h2>Categorizaci\u00f3n</h2></div>"},{colSpan:2,dataField:"TIPIFICA_CSC_PARENT_PARENT",editorType:"dxSelectBox",label:{text:"Categor\u00eda"},
validationRules:[{type:"required",message:"Tipificaci\u00f3n requerida"}],editorOptions:{searchEnabled:!0,displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC",dataSource:a._CMB_SAMT_CAM_TIPIFICACIONES_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPIFICA_CSC_PARENT_PARENT=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
"Debes seleccionar el servicio",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){let e=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem");return 1==d.TIPIFCA_ACTIVO&&null==d.TIPIFICA_PARENT&&d.CAT_TIPO_TIPIFICA_CSC==e.TIPIFICA_CSC}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPIFICA_CSC_PARENT_PARENT&&b.component.option("dataSource",a.TIPIFICA_CSC_PARENT_PARENT)},
onValueChanged:function(b){}}},{colSpan:2,dataField:"TIPIFICA_CSC_PARENT",editorType:"dxSelectBox",label:{text:"Categor\u00eda nivel 2"},validationRules:[{type:"required",message:"Tipificaci\u00f3n requerida"}],editorOptions:{searchEnabled:!0,displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC",dataSource:a._CMB_SAMT_CAM_TIPIFICACIONES_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPIFICA_CSC_PARENT=c;null==a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("selectedItem")?
(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar la categoria",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){let e=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem");return 1==d.TIPIFCA_ACTIVO&&d.TIPIFICA_PARENT==a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("value")&&d.CAT_TIPO_TIPIFICA_CSC==e.TIPIFICA_CSC}).toList(),b.component.option("dataSource",
c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPIFICA_CSC_PARENT&&b.component.option("dataSource",a.TIPIFICA_CSC_PARENT)},onValueChanged:function(b){}}},{colSpan:2,dataField:"TIPIFICA_CSC",editorType:"dxSelectBox",label:{text:"Categor\u00eda nivel 3"},validationRules:[{type:"required",message:"Tipificaci\u00f3n requerida"}],editorOptions:{searchEnabled:!0,displayExpr:"TIPIFICA_IDIOMA1",valueExpr:"TIPIFICA_CSC",dataSource:a._CMB_SAMT_CAM_TIPIFICACIONES_OBJDATA,onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPIFICA_CSC=
c;null==a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("selectedItem")?(a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Debes seleccionar la categoria Nivel 2",400,130),b.component.option("dataSource",[])):(c=jslinq(c).where(function(d){let e=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem");return 1==d.TIPIFCA_ACTIVO&&d.TIPIFICA_PARENT==a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("value")&&
d.CAT_TIPO_TIPIFICA_CSC==e.TIPIFICA_CSC}).toList(),b.component.option("dataSource",c))})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPIFICA_CSC&&b.component.option("dataSource",a.TIPIFICA_CSC);b=b.component.option("selectedItem");if(null!=b){var c=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_TIEMPO_EJECUCION"),d=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_TIEMPO_RECEPCION"),e=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_TIEMPO_CONFIRMACION");c.option("value",0==b.TIPIFICA_TIEMPO_EJECUCION?
a.TimeDefault:b.TIPIFICA_TIEMPO_EJECUCION);d.option("value",b.TIPIFICA_TIEMPO_RECEPCION);e.option("value",b.TIPIFICA_TIEMPO_CONFIRMACION)}}}},{colSpan:2,dataField:"TIC_CODIGO_VPN",editorType:"dxTextBox",label:{text:"CODIGO VPN"},editorOptions:{},validationRules:[{type:"required",message:"Codigo VPN requerida"}]},{colSpan:2,dataField:"TAG_COMPONENTE",editorType:"dxTextBox",label:{text:"TAG/COMPONENTE/NO. DE SERIE/HOSTNAME"},editorOptions:{buttons:[{name:"btn_BuscarActivos",location:"after",options:{stylingMode:"Contained",
icon:"search",type:"normal",onClick(b){p.show();if(null==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")||""==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione el proveedor y el servicio",400,130),p.hide();else{a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("selectedItem");b=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("selectedItem");
let c=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("selectedItem"),d=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem");if(12==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(null==c){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione la categoria de Nivel 3",400,130);p.hide();return}}else if(25==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(null==
d){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione el Ubicaci\u00f3n/Aduana/Almacen",400,130);p.hide();return}}else if(6==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(null==d){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione el Ubicaci\u00f3n/Aduana/Almacen",400,130);p.hide();return}}else if(3==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(null==
d){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione el Ubicaci\u00f3n/Aduana/Almacen",400,130);p.hide();return}if(null==b){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione la categoria de Nivel 2",400,130);p.hide();return}}else if(20==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&null==d){a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
"Seleccione el Ubicaci\u00f3n/Aduana/Almacen",400,130);p.hide();return}a.BusquedaActivoFijo()}}}}]}},{colSpan:2,itemType:"button",horizontalAlignment:"right",buttonOptions:{type:"default",text:"Agregar informaci\u00f3n complementar\u00eda",onClick:function(){var b=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value");12==b||3==b?(b=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("selectedItem"),null==b?a.notificaPantalla("Informaci\u00f3n",
moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione la categoria en la parte superior",400,130):a.muestraPopComplementosTicket(b.TIPIFICA_IDIOMA1)):23==b?(b=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("selectedItem"),null==b?a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Seleccione la categoria nivel 3 en la parte superior",400,130):a.popDatosSiadeconSrv(b.TIPIFICA_IDIOMA1)):a.notificaPantalla("Informaci\u00f3n",
moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"Este servicio no requiere de informaci\u00f3n complementaria.",400,130)}}}]},{dataField:"TIC_DESCRIPCION",editorType:"dxTextArea",colSpan:4,label:{text:"Descripci\u00f3n/Observaciones"},editorOptions:{readOnly:!0,height:205,valueChangeEvent:"keyup",onValueChanged:function(b){}},validationRules:[{type:"required",message:"requerido"}]},{colSpan:6,cssClass:"hidden_box",template:"<div class='heading_InnerFrm'><h2>Detalle de atenci\u00f3n</h2></div>"},
{itemType:"group",colSpan:2,colCount:2,cssClass:"hidden_box",items:[{colSpan:2,dataField:"TIC_ATIENDE",editorType:"dxTextBox",label:{text:"Empleado Atiende"},editorOptions:{buttons:[{name:"btn_BuscarEmpleado",location:"after",options:{stylingMode:"Contained",icon:"search",type:"normal",onClick(b){a.BusquedaEmpleado("Atiende","single")}}}]}},{colSpan:2,template:"<div class='heading_InnerFrm'><h2>Calendario</h2></div>"},{colSpan:2,dataField:"TIC_FECHA_CIERRE",label:{text:"Fecha Cierre"},editorType:"dxDateBox",
editorOptions:{readOnly:!0,type:"datetime",disabled:!1,width:"100%",placeholder:"DD/MM/AAAA HH:mm:ss",useMaskBehavior:!0,displayFormat:"dd/MM/yyyy HH:mm:ss",dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss",onValueChanged:function(b){}}},{colSpan:2,dataField:"TIPO_CALIFICACION_CSC",editorType:"dxSelectBox",label:{text:"Calificaci\u00f3n"},editorOptions:{searchEnabled:!0,readOnly:!0,displayExpr:"TIPO_CALIFICACION_IDIOMA1",valueExpr:"TIPO_CALIFICACION_CSC",deferRendering:!1,dataSource:new DevExpress.data.DataSource({loadMode:"raw",
paginate:!1,load:async function(){try{var b={Tbl:"SAMT_TIPO_CALIFICACION",WHR:"EMP_CSC_EMPRESA_HOST = "+localStorage.getItem("EMP_CSC_EMPRESA_HOST")+" AND TIPO_CALIFICACION_ACTIVO = 1 "};return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Whr","GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}}}),onOpened:function(b){b.component.getDataSource().load().done(function(c){a.TIPO_CALIFICACION_CSC=
c;c=jslinq(c).where(function(d){return 1==d.TIPO_CALIFICACION_ACTIVO}).toList();b.component.option("dataSource",c)})},onClosed:function(b){b.component.getDataSource().items()!==a.TIPO_CALIFICACION_CSC&&b.component.option("dataSource",a.TIPO_CALIFICACION_CSC)},onValueChanged:function(b){b.component.option("selectedItem")}}},{colSpan:2,cssClass:"hidden_box",dataField:"EMPLEADO_CSC_ATIENDE",editorType:"dxTextBox",label:{text:"Id Empleado Atiende"},editorOptions:{readOnly:!0}}]},{cssClass:"hidden_box",
itemType:"group",colSpan:4,colCount:1,items:[{dataField:"TIC_DESCRIPCION_SOLUCION",editorType:"dxTextArea",label:{text:"Detalle de soluci\u00f3n"},editorOptions:{height:205,valueChangeEvent:"keyup",onValueChanged:function(b){},buttons:[{name:"ObtenPortapapel",location:"after",options:{stylingMode:"Contained",icon:"pasteplaintext",type:"normal",onClick(b){a.ObtenClipboard("__Frm_Ticket_Servicio","TIC_DESCRIPCION_SOLUCION")}}}]}}]}]}]}).dxForm("instance");a.Frm_Ticket_Empleado_Solita_Instance=$("#__Frm_Ticket_Empleado_Solicita").dxForm({readOnly:!0,
height:"100%",showColonAfterLabel:!0,showValidationSummary:!1,validationGroup:"__Frm_Ticket_Empleado_Solicita_Validation",labelMode:"outside",labelLocation:"top",screenByWidth(b){return 700>b?"sm":"lg"},items:[{colSpan:6,template:"<div class='heading_InnerFrm'><h2>Informacion General del Empleado que Solicita</h2></div>"},{itemType:"group",colCount:6,items:[{colSpan:2,dataField:"EMPLEADO_CSC_EMPLEADO",label:{text:"Id Empleado"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_ID_EXTERNO",
label:{text:"No. Empleado"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"REQ_CSCREQUISICION",editorType:"dxSelectBox",label:{text:"Site Labora"},editorOptions:{searchEnabled:!0,displayExpr:"REQ_NOMBREAREA",valueExpr:"REQ_CSCREQUISICION",dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_REQUISICIONES"},getJSON(DeveloperType).ApiGeneral.token).then(c=>
{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}},onError:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_REQUISICIONES"},getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}}})}},{colSpan:2,dataField:"EMPLEADO_NOMBREEMPLEADO",label:{text:"Nombre"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_APATERNOEMPLEADO",
label:{text:"Apellido Paterno"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_AMATERNOEMPLEADO",label:{text:"Apellido Materno"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_TELEFONO1",label:{text:"Telefono Casa"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_CELULAR",label:{text:"Telefono Celular"},editorOptions:{readOnly:!0,disabled:!1}},{colSpan:2,dataField:"EMPLEADO_EMAILLABORAL",label:{text:"Correo Laboral"},editorOptions:{readOnly:!0,
disabled:!1}},{colSpan:2,dataField:"CAT_PUESTO_CSCEMPLEADO",editorType:"dxSelectBox",label:{text:"Puesto"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_PUESTO_IDIOMA1",valueExpr:"TIPO_PUESTO_CSCEMPLEADO",dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_TIPO_PUESTO_EMPLEADO"},getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;
console.log(c.message)})}catch(c){console.log(c)}},onError:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_TIPO_PUESTO_EMPLEADO"},getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}}})}},{colSpan:2,dataField:"CAT_AREA_CSC",editorType:"dxSelectBox",label:{text:"Area"},editorOptions:{searchEnabled:!0,displayExpr:"TIPO_AREA_IDIOMA1",valueExpr:"TIPO_AREA_CSC",
dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_AREA"},getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}},onError:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_AREA"},getJSON(DeveloperType).ApiGeneral.token).then(c=>
{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}}})}},{colSpan:2,dataField:"CAT_DEPARTAMENTO_CSC",editorType:"dxSelectBox",label:{text:"Departamento"},editorOptions:{searchEnabled:!0,displayExpr:"SAMT_TIPO_DEPARTAMENTO_IDIOMA1",valueExpr:"EMPLEADO_DEPARTAMENTO_CSC",dataSource:new DevExpress.data.DataSource({loadMode:"raw",paginate:!1,load:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO"},
getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}},onError:async function(b){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO"},getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success)return c.JsonData;console.log(c.message)})}catch(c){console.log(c)}}})}}]}]}).dxForm("instance");a.ObtenSelectBoxFrm=b=>{a._SelectBox_OriginalDts=[];
let c=b.option("formData");Object.entries(c).forEach(([d])=>{var e=b.itemOption(d);if(void 0!=e){var f=e.editorType;e=e.label.text;"dxSelectBox"==f?(f=b.getEditor(d),a._SelectBox_OriginalDts.push({[d]:f.option("text"),Label:e})):"dxTextBox"==f||"dxNumberBox"==f||"dxTextArea"==f||"dxDateBox"==f?(f=b.getEditor(d),a._SelectBox_OriginalDts.push({[d]:f.option("text"),Label:e})):"dxHtmlEditor"==f&&(f=b.getEditor(d),a._SelectBox_OriginalDts.push({[d]:f.option("value"),Label:e}))}else if(e=b.itemOption("__Detalle_Edificio."+
d),void 0!=e)if(f=e.editorType,e=e.label.text,"dxSelectBox"==f)f=b.getEditor(d),a._SelectBox_OriginalDts.push({[d]:f.option("text"),Label:e});else if("dxTextBox"==f||"dxNumberBox"==f||"dxTextArea"==f||"dxDateBox"==f)f=b.getEditor(d),a._SelectBox_OriginalDts.push({[d]:f.option("text"),Label:e})})};a.readFileAsBase64=b=>new Promise((c,d)=>{const e=new FileReader;e.onload=function(f){c(f.target.result)};e.onerror=function(f){d(f)};e.readAsDataURL(b)});a.extractBase64Data=(b,c=!1)=>c?b:b.split(",")[1];
a.TestBitacoraInsert=b=>{console.log(b);return new Promise((c,d)=>{try{__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Bitacora_Ticket","POST",JSON.stringify(b),getJSON(DeveloperType).ApiGeneral.token).then(e=>{c(e)})}catch(e){d(e)}})};a.InsertaBitacoraManual=function(b,c,d,e,f){1==d&&p.show();b={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),DATA_INSERT:{EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),AUDITORIA_USU_ALTA:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,
AUDITORIA_USU_ULT_MOD:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO,AUDITORIA_FEC_ALTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),AUDITORIA_FEC_ULT_MOD:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),TIC_CSCTICKET:b.TIC_CSCTICKET,ESTATUS_TICKET_CSC:b.ESTATUS_TICKET_CSC,TIB_NOMBRE:q.EMPLEADO_NOMBREEMPLEADO+" "+q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO,TIB_DESCRIPCION:c,TIB_FECHAHORA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),
SAMT_TICKET_TIPO_BITACORA_CSC:e,SAMT_TICKET_SUBTIPO_BITACORA_CSC:f,EMPLEADO_CSC_EMPLEADO:JSON.parse(localStorage.getItem("obj_DatosEmpleado")).EMPLEADO_CSC_EMPLEADO}};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Bitacora_Ticket","POST",JSON.stringify(b),getJSON(DeveloperType).ApiTickets_v2.token).then(m=>{1==m.success?(1==d&&p.hide(),setTimeout(()=>{$("#Pop_Insertar_BitacoraManual").dxPopup("hide")},1E3),DevExpress.ui.notify({message:"BITACORA AGREGADA CORRECTAMENTE",minWidth:150,
type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"})):1==d&&p.hide();return m}).catch(function(m){1==d&&p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})};$("#Dg_RepFoto_Ticket").dxDataGrid({headerFilter:{visible:!1},keyExpr:"TICKET_FOTO_CSC",selection:{mode:"single"},scrolling:{useNative:!1,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always"},
groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},hoverStateEnabled:!0,showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"IdI",dataField:"TICKET_FOTO_CSC",alignment:"left",sortIndex:1,sortOrder:"desc",visible:!1},{caption:"IMAGEN",dataField:"TICKET_DESCRIPCION",alignment:"left",allowSorting:!1},{caption:"FECHA DE ALTA",dataField:"TICKET_FECHA_ALTA",alignment:"left",dataType:"date",calculateCellValue:function(b){return moment(b.TICKET_FECHA_ALTA).add(a.TiempoUTCEmpleado,
"hours").format("DD/MM/YYYY HH:mm:ss")},allowSorting:!1},{caption:"GENERADO POR",dataField:"TICKET_ORIGEN_CREACION",alignment:"left",cellTemplate(b,c){2==c.value?$("<div>").append($('<div">Operador</div>')).appendTo(b):$("<div>").append($('<div">Cliente</div>')).appendTo(b)},allowSorting:!1}],onRowDblClick:function(b){console.log(b.data);b={ClaveEmpresa:localStorage.getItem("EMP_CLV_EMPRESA"),newIdTicket:b.data.TIC_NEWID,idImagen:b.data.TICKET_FOTO_CSC};__Reques_ajax(`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}getImageTicketById/${a.DataTicketOpen.SAMT_CAM_TIPO_SERVICIO_CSC}`,
"GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success){p.hide();console.log(c);var d=c.urlTemporal;$("#Pop_Notificacion_Success").dxPopup("instance").option("height","85%");$("#Pop_Notificacion_Success").dxPopup("instance").option("width","90%");$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(e){return $('<div style="height:100%;">').append("<iframe src="+d+' width="100%" height="100%" scrolling="auto" frameBorder="0" style=" flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;"></iframe>')});
$("#Pop_Notificacion_Success").dxPopup("show")}else a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${c.message}`,400,130),p.hide()})}});$("#Dg_Documento_Ticket").dxDataGrid({headerFilter:{visible:!1},keyExpr:"TICKET_FILE_CSC",selection:{mode:"single"},scrolling:{useNative:!1,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always"},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},hoverStateEnabled:!0,
showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"Id",dataField:"TICKET_FILE_CSC",alignment:"left",sortIndex:1,sortOrder:"desc",visible:!1},{caption:"DOCUMENTO",dataField:"TICKET_FILE_DESCRIPCION",alignment:"left",allowSorting:!1},{caption:"FECHA DE ALTA",dataField:"TICKET_FILE_FECHA_ALTA",alignment:"left",dataType:"date",allowSorting:!1,calculateCellValue:function(b){return moment(b.TICKET_FILE_FECHA_ALTA).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")}},
{caption:"GENERADO POR",dataField:"TICKET_FILE_ORIGEN_CREACION",alignment:"left",allowSorting:!1,cellTemplate(b,c){2==c.value?$("<div>").append($('<div">Operador</div>')).appendTo(b):$("<div>").append($('<div">Cliente</div>')).appendTo(b)}}],onRowDblClick:function(b){console.log(b.data);b={ClaveEmpresa:localStorage.getItem("EMP_CLV_EMPRESA"),newIdTicket:b.data.TIC_NEWID,idDocumento:b.data.TICKET_FILE_CSC};__Reques_ajax(`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}getDocumentTicketById/${a.DataTicketOpen.SAMT_CAM_TIPO_SERVICIO_CSC}`,
"GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{if(1==c.success){p.hide();console.log(c);var d=c.urlTemporal;$("#Pop_Notificacion_Success").dxPopup("instance").option("height","85%");$("#Pop_Notificacion_Success").dxPopup("instance").option("width","90%");$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(e){return $('<div style="height:100%;">').append("<iframe src="+d+' width="100%" height="100%" scrolling="auto" frameBorder="0" style=" flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;"></iframe>')});
$("#Pop_Notificacion_Success").dxPopup("show")}else a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${c.message}`,400,130),p.hide()})}});$("#Dg_Bitacora_Ticket").dxDataGrid({deferRendering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},keyExpr:"TIB_CSCTICKETBITACORA",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},
grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"NOMBRE",dataField:"TIB_NOMBRE"},{caption:"DESCRIPCION",dataField:"TIB_DESCRIPCION"},{caption:"FECHA DE CAMBIO",dataField:"TIB_FECHAHORA",dataType:"date",format:"dd-MM-yyyy HH:mm:ss",calculateCellValue:function(b){return moment(b.TIB_FECHAHORA).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")}}],onRowDblClick:function(b){$("#Pop_Notificacion_Success").dxPopup("instance").option("height",
420);$("#Pop_Notificacion_Success").dxPopup("instance").option("width",420);$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(){return $("<div>").append($("<div class='popup-property-details'>").append($('<div class="Nice-Shadow-1" style="padding: 9px;">Detalle de Bitacora</div>'),$('<div style="padding: 9px; background: #FFFFFF; color: #000000;">').append($('<div style="flex-grow: 1; font-size: 12px; font-weight: bold; text-align:left;">FECHA DE ALTA: <span style="font-weight: normal;">'+
moment(b.data.TIB_FECHAHORA).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")+"</span></div>"),$('<div style="flex-grow: 1; font-size: 12px; font-weight: bold; text-align:left;">GENERADO POR: <span style="font-weight: normal;">'+b.data.TIB_NOMBRE+"</span></div>"),$('<div style="flex-grow: 1; font-size: 12px; font-weight: bold; text-align:left;">DETALLE: <span style="font-weight: normal;">'+b.data.TIB_DESCRIPCION+"</span></div>"))))});$("#Pop_Notificacion_Success").dxPopup("show")}});
a.Dg_MensajesClienteOperador=$("#Dg_MensajesClienteOperador").dxDataGrid({deferRendering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},keyExpr:"CSC_RESPUESTA",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!1,showRowLines:!1,showColumnLines:!1,rowAlternationEnabled:!1,columnAutoWidth:!1,
columns:[{dataField:"DETALLE",allowFiltering:!1,allowSorting:!1,cellTemplate(b,c){({data:c}=c);var d=null;1===c.RESPUESTA_LEIDO_CLIENTE?d="Si":d="No";var e=null;1===c.RESPUESTA_LEIDO_OPERADOR?e="Si":e="No";$('<div class="FlexContainer-Column MensajesRespuestaContent-'+c.RESPUESTA_CLAVE+'">').append($('<span style="width: 100%; font-weight: bold;">').text(`${c.RESPUESTA_NOMBRE} - ${c.RESPUESTA_CLAVE}`)).append($('<span  style="width: 100%; font-style: italic;">').text(`${moment(c.RESPUESTA_FECHAHORA_ALTA).add(a.TiempoUTCEmpleado,
"hours").format("DD/MM/YYYY HH:mm:ss")}`)).append($('<span style="width: 100%; font-weight: bold;">').text(`Asunto: ${c.RESPUESTA_ASUNTO}`)).append($('<span  style="width: 100%; font-size: 9px; font-weight: bold;">').text(`Leido Cliente - ${d} / Fecha - ${moment(c.RESPUESTA_FEC_LEIDO_CLIENTE).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")}`)).append($('<span  style="width: 100%; font-size: 9px; font-weight: bold;">').text(`Leido Operador - ${e} / Fecha - ${moment(c.RESPUESTA_FEC_LEIDO_OPERADOR).add(a.TiempoUTCEmpleado,
"hours").format("DD/MM/YYYY HH:mm:ss")}`)).appendTo(b)}}],onRowDblClick:function(b){var c=b.data.RESPUESTA_FEC_LEIDO_CLIENTE,d=moment(b.data.RESPUESTA_FEC_LEIDO_OPERADOR).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")||null,e=moment(c).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")||null,f=moment(b.data.AUDITORIA_FEC_ALTA).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")||null;d="Invalid date"==d?"S/D":d;e="Invalid date"==e?"S/D":e;"GENERA"==getUrlParam("TPO_USUARIO")?
null==b.data.RESPUESTA_LEIDO_CLIENTE&&a.ActualizaRespuestaLectura(b.data.CSC_RESPUESTA,b.data.TIC_CSCTICKET):null==b.data.RESPUESTA_LEIDO_OPERADOR&&a.ActualizaRespuestaLectura(b.data.CSC_RESPUESTA,b.data.TIC_CSCTICKET);$("#Pop_Notificacion_Success").dxPopup("instance").option("height","510");$("#Pop_Notificacion_Success").dxPopup("instance").option("width","90%");$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(){return $("<div>").append($("<div class='popup-property-details'>").append($('<div class="Nice-Shadow-1" style="padding: 9px;">Detalle de Mensaje/Respuesta</div>'),
$('<div  class="FlexContainer-Row" style="padding: 3px; background: #FFFFFF; color: #000000;">').append($('<div class="FlexContainer-Column" style="padding: 9px; background: #FFFFFF; color: #000000; position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;">').append($('<div class="FlexContainer-Row" style="padding: 9px; background: #FFFFFF; color: #000000;font-size: 11px;">').append($('<div style="position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;font-weight: bold;">ASUNTO: <span style="font-weight: normal;">'+
b.data.RESPUESTA_ASUNTO+"</span></div>"),$('<div style="position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;font-weight: bold; text-align: right;">FECHA DE ALTA: <span style="font-weight: normal;">'+f+"</span></br></div>")),$('<div id="contentAdjuntos" class="FlexContainer-Row" style="font-weight: bold; text-align:left;font-size: 9px;"></div>'),$('<div style="flex-grow: 1; overflow: scroll; height: 300px; padding: 3px; margin:5px; border: solid gray 1px;">'+b.data.RESPUESTA_DESCRIPCION+
"</div>"),$('<div class="FlexContainer-Row" style="padding: 9px; background: #FFFFFF; color: #000000;font-size: 11px;">').append($('<div style="position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;font-weight: bold;">GENERADO POR: <span style="font-weight: normal;">'+b.data.RESPUESTA_CLAVE+"</span></br></div>"),$('<div style="position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;font-weight: bold;">LECTURA POR CLIENTE: <span style="font-weight: normal;">'+e+
"</span></br></div>"),$('<div style="position: relative;flex-shrink: 1;flex-basis: auto;flex: 1; flex-grow: 1;font-weight: bold;">LECTURA POR OPERADOR:<span style="font-weight: normal;">'+d+"</span></br></div>"))))))});$("#Pop_Notificacion_Success").dxPopup("show");a.Get_Mensaje_Files(b.data.TICKET_MENSAJE_NEWID)}});a.Get_Mensaje_Files=function(b){b={...ReturnDefaultData_Init(),TICKET_MENSAJE_NEWID:b};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Respuesta_Mensaje_Files","GET",b,getJSON(DeveloperType).ApiTickets_v2.token).then(c=>
{if(1==c.success){c=c.JsonData;const d=document.getElementById("contentAdjuntos");c.forEach(e=>{const f=document.createElement("div");f.style.width="260px";f.style.height="24px";f.style.padding="3px";f.style.borderRadius="5px";f.style.border="solid #1f5e26 1px";f.style.margin="3px";f.style.cursor="pointer";var m=e.TICKET_MENSAJE_FILE_MIMETYPE_SISTEMA;const h=document.createElement("img");h.src=a.getIconoPorMimetype(m);h.alt="Icono";h.style.float="left";h.width=16;f.appendChild(h);m=document.createElement("p");
m.textContent=e.TICKET_MENSAJE_FILE_DESCRIPCION;m.style.lineHeight="2";f.appendChild(m);f.onclick=function(){a.obtenDocumentoMensaje(e)};d.appendChild(f)})}}).catch(function(c){console.log(c);DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)})};a.getIconoPorMimetype=b=>({jpg:"../../images/Icons/IconMimeType/48px/jpg.png",png:"../../images/Icons/IconMimeType/48px/png.png",pdf:"../../images/Icons/IconMimeType/48px/pdf.png",xlsx:"../../images/Icons/IconMimeType/48px/xlsx.png",
xls:"../../images/Icons/IconMimeType/48px/xls.png"})[b]||"../../images/Icons/IconMimeType/48px/_blank.png";a.obtenDocumentoMensaje=b=>{console.log(b);b={clveEmpresa:localStorage.getItem("EMP_CLV_EMPRESA"),TypeCon:localStorage.getItem("Type"),imageKey:`TICKET_MENSAJE/${b.TIC_NEWID}/${b.TICKET_MENSAJE_NEWID}/${b.TICKET_MENSAJE_FILE_RUTA}.${b.TICKET_MENSAJE_FILE_MIMETYPE_SISTEMA}`,contentType:b.TICKET_MENSAJE_FILE_MIMETYPE_ORIGINAL,filename:b.TICKET_MENSAJE_FILE_DESCRIPCION};console.log(b);__Reques_ajax(`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}getImageTicketById`,
"GET",b,getJSON(DeveloperType).ApiGeneral.token).then(c=>{1==c.success?(p.hide(),c=c.urlTemporal,console.log(c),window.open(c)):p.hide()})};a.Dg_Empleados_Ticket=$("#Dg_Empleados_Ticket").dxDataGrid({deferRendering:!0,dataSource:a._Obj_Agrega_Emp_Ticket,allowColumnResizing:!0,headerFilter:{visible:!1},remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"multiple"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},
paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"NO. EMPLEADO",dataField:"EMPLEADO_ID_EXTERNO",width:90},{caption:"NOMBRE",dataField:"NOMBRE"}],toolbar:{items:[{location:"after",widget:"dxButton",options:{text:"Agregar Empleado(s)",icon:"add",disabled:!1,onClick(){a.BusquedaEmpleado("AsignaTicket","multiple")}}},{location:"after",widget:"dxButton",options:{text:"Quitar empleados seleccionados",
icon:"trash",disabled:!0,onClick(){a.Dg_Empleados_Ticket.getSelectedRowKeys().forEach(b=>{a._Obj_Agrega_Emp_Ticket.remove(b)});a.Dg_Empleados_Ticket.refresh()}}}]},onSelectionChanged(b){"EDITAR"==getUrlParam("TIPO")||getUrlParam("TIPO")}}).dxDataGrid("instance");a._DataGrid_Autorizacion=$("#Dg_Ticket_Autorizaciones").dxDataGrid({deferRendering:!0,headerFilter:{visible:!1},dataSource:a._Obj_Autorizaciones_Grid,keyExpr:"SAMT_TICKET_AUTORIZACIONES_CSC",searchPanel:{visible:!1,highlightCaseSensitive:!0},
selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,height:165,width:280,columns:[{caption:"ID",dataField:"SAMT_TICKET_AUTORIZACIONES_CSC",width:100},{caption:"ESTATUS",dataField:"SAMT_TIPO_RESPUESTA_AUTORIZA_CSC",width:150,lookup:{displayExpr:"TIPO_RESPUESTA_AUTORIZA_IDIOMA1",
valueExpr:"SAMT_TIPO_RESPUESTA_AUTORIZA_CSC",dataSource:{store:new DevExpress.data.CustomStore({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_TIPO_RESPUESTA_AUTORIZA"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return b.JsonData;console.log(b.message)})}catch(b){console.log(b)}}})}}},{caption:"RESPONSABLE",dataField:"NOMBRE",width:180},{caption:"FECHA ALTA",dataField:"AUDITORIA_FEC_ALTA",
alignment:"center",dataType:"date",width:150,calculateCellValue:function(b){return moment(b.AUDITORIA_FEC_ALTA).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")}},{caption:"COMENTARIOS",dataField:"AUTORIZADO_COMENTARIOS",width:200},{caption:"FECHA ACTUALIZACION",dataField:"AUDITORIA_FEC_ULT_MOD",alignment:"center",dataType:"date",width:150,calculateCellValue:function(b){return moment(b.AUDITORIA_FEC_ULT_MOD).add(a.TiempoUTCEmpleado,"hours").format("DD/MM/YYYY HH:mm:ss")}}],onRowDblClick:function(b){console.log(b.data)}}).dxDataGrid("instance");
a._Datagrid_Ot_Ticket=$("#Dg_Ot_Ticket_rel").dxDataGrid({deferRendering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},dataSource:a._Obj_Ot_Ticket_Grid,keyExpr:"OTR_CSCORDENTRABAJO",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},selection:{mode:"single"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,
columnAutoWidth:!1,columns:[{caption:"OT",dataField:"OTR_CSCORDENTRABAJO"},{caption:"ESTATUS",dataField:"ESTATUS_ORDEN_CSC",lookup:{displayExpr:"ESTATUS_ORDEN_IDIOMA1",valueExpr:"ESTATUS_ORDEN_CSC",dataSource:{store:new DevExpress.data.CustomStore({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_ESTATUS_ORDEN_TRABAJO"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return b.JsonData;
console.log(b.message)})}catch(b){console.log(b)}}})}}},{caption:"AREA",dataField:"TIPO_AREA_CSC_RESPONSABLE",lookup:{displayExpr:"TIPO_AREA_IDIOMA1",valueExpr:"TIPO_AREA_CSC",dataSource:{store:new DevExpress.data.CustomStore({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_AREA"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return b.JsonData;console.log(b.message)})}catch(b){console.log(b)}}})}}},
{caption:"DEPARTAMENTO",dataField:"CAT_DEPTO_CSC_RESPONSABLE",lookup:{displayExpr:"SAMT_TIPO_DEPARTAMENTO_IDIOMA1",valueExpr:"EMPLEADO_DEPARTAMENTO_CSC",dataSource:{store:new DevExpress.data.CustomStore({loadMode:"raw",paginate:!1,load:async function(){try{return __Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+"Get_Cat_Full","GET",{Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO"},getJSON(DeveloperType).ApiGeneral.token).then(b=>{if(1==b.success)return b.JsonData;console.log(b.message)})}catch(b){console.log(b)}}})}}},
{caption:"RESPONSABLE",dataField:"EMPLEADO_CSC_RESPONSABLE"},{caption:"CERRADA",dataField:"OTR_CERRADA"}],onRowDblClick:function(b){console.log(b.data);setTimeout(()=>{g("EDITAR",b.data.OTR_NEWID)},1E3)}}).dxDataGrid("instance");a._DataGrid_Ticket_Participante=$("#Dg_Ticket_Participantes").dxDataGrid({deferRendering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},dataSource:a._Obj_Ticket_Participantes_Grid,keyExpr:"EMPLEADO_CSC_EMPLEADO",remoteOperations:!1,searchPanel:{visible:!1,highlightCaseSensitive:!0},
selection:{mode:"multiple"},scrolling:{mode:"virtual",showScrollbar:"always",useNative:!0},groupPanel:{visible:!1},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"NOMBRE COMPLETO",dataField:"NOMBRE_EMPLEADO"},{caption:"TIPO PARTICIPANTE",dataField:"TIPO_PARTICIPANTE_CSC",lookup:{displayExpr:"TIPO_PARTICIPANTE_IDIOMA1",valueExpr:"TIPO_PARTICIPANTE_CSC",dataSource:{store:new DevExpress.data.CustomStore({load:async function(){try{return a.jsonTiposParticipanes}catch(b){console.log(b)}}})}}},
{caption:"CORREO",dataField:"EMPLEADO_EMAIL_NOTIFICA"}],toolbar:{items:[{location:"after",widget:"dxButton",options:{text:"Agregar Participante(s)",icon:"add",disabled:!1,onClick(){a.BusquedaEmpleado("AgregarParticipante","multiple")}}},{location:"after",widget:"dxButton",options:{text:"Quitar participante(s) seleccionado(s)",icon:"trash",disabled:!0,onClick(){a._DataGrid_Ticket_Participante.getSelectedRowKeys().forEach(b=>{a._Obj_Ticket_Participantes_Grid.remove(b)});a._DataGrid_Ticket_Participante.refresh()}}}]},
onSelectionChanged(b){"LECTURA"!=getUrlParam("TIPO")&&a._DataGrid_Ticket_Participante.option("toolbar.items[1].options.disabled",!b.selectedRowsData.length)}}).dxDataGrid("instance");a.FileCorreoRespuesta=$("#FileCorreoRespuesta").dxFileUploader({multiple:!0,allowedFileExtensions:".jpg .jpeg .gif .png .pdf .doc .docx .xlsx .wav .mp3 .xls .pptx".split(" "),uploadMode:"useButtons",visible:!0,disabled:!0,onValueChanged:function(b){var c=b.component.option("values");$.each(c,function(d,e){b.element.find(".dx-fileuploader-upload-button").hide()});
b.element.find(".dx-fileuploader-upload-button").hide()}}).dxFileUploader("instance")};a.ClickAlta=function(){$Btn_Alta_Ticket.option("visible",!1);$btn_Modificar_Ticket.option("visible",!1);$btn_Cancelar_Alta_Ticket.option("visible",!0);$btn_Salvar_Alta_Ticket.option("visible",!0);$btnCalificaAtencion.option("visible",!1);a.Frm_Ticket_Servicio_Instance.resetValues();a.Frm_Ticket_Servicio_Instance.option("readOnly",!1);a.setDefaultValues=!0;a.LoadCatFull=!1;a.editandoForma=!1;var g=q.EMPLEADO_NOMBREEMPLEADO+
" "+q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO;switch(getUrlParam("TPO_USUARIO")){case "GENERA":a.Frm_Ticket_Servicio_Instance.itemOption("TIC_ATIENDE","isRequired",!1);a.Frm_Ticket_Servicio_Instance.itemOption("TIC_SOLICITA","isRequired",!0);a.Frm_Ticket_Servicio_Instance.getEditor("CAM_MESA_CSC").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.itemOption("CAM_CSC_SERVICIO_SOLICITA",
"isRequired",!1);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_DESCRIPCION_SOLUCION").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_TICKET_CSC").option("readOnly",!1);a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("readOnly",!1);a.Frm_Ticket_Servicio_Instance.getEditor("SAMT_CAM_TIPO_SERVICIO_CSC").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("readOnly",
!1);a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_DESCRIPCION").option("readOnly",!1);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SOLICITA").option("readOnly",!0);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SOLICITA").option("value",g);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_EMAIL_SOLICITANTE").option("value",q.EMPLEADO_EMAILLABORAL);
a.Frm_Ticket_Servicio_Instance.getEditor("TIC_TELEFONO_SOLICITANTE").option("value",q.EMPLEADO_TELEFONO1);a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("value",q.EMPLEADO_CSC_EMPLEADO);a.Frm_Ticket_Servicio_Instance.getEditor("CLIENTE_CSC_SOLICITA").option("value",q.CLIENTE_CSC);break;default:a.Frm_Ticket_Servicio_Instance.getEditor("CLIENTE_CSC_SOLICITA").option("value",q.CLIENTE_CSC),a.Frm_Ticket_Servicio_Instance.itemOption("TIC_ATIENDE","isRequired",!0),a.Frm_Ticket_Servicio_Instance.itemOption("TIC_SOLICITA",
"isRequired",!0),a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_ATIENDE").option("value",q.EMPLEADO_CSC_EMPLEADO),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_DESCRIPCION").option("readOnly",!1),a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("readOnly",!1),a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("readOnly",!0),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("value",g),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("readOnly",
!1),a.Frm_Ticket_Servicio_Instance.itemOption("CAM_CSC_SERVICIO_SOLICITA","isRequired",!0)}setTimeout(()=>{a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value",createUUID(36));a.Frm_Ticket_Servicio_Instance.getEditor("TIC_FECHA_ALTA").option("value",moment().tz(a.TimeZoneEmpleado).format("YYYY-MM-DD HH:mm:ss"));a.Frm_Ticket_Servicio_Instance.getEditor("CAM_MESA_CSC").option("value",parseInt(getUrlParam("CSC_MESA")))},1E3)};a.Generar_Alta_Ticket=async function(){var g=a.Frm_Ticket_Servicio_Instance,
k=a.Frm_Ticket_Servicio_Instance.option("formData"),l=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("selectedItem"),n=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");moment().tz(a.TimeZoneServidor).format("YYYY-MM-DDTHH:mm:ss");if(!0===g.validate().isValid){var b=GetInsertData(k,g);b.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;b.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");b.TIC_FECHA_ALTA=n;b.TIC_FECHA_ALTA_SOLA=
n;b.TIC_FECHA_ALTA_HORA_COMPLETA=n;b.AUDITORIA_FEC_ALTA=n;b.AUDITORIA_FEC_ULT_MOD=n;b.TIC_DURACION_RECEPCION=0;b.TIC_FECHA_PROMESA=b.TIC_FECHA_PROMESA?moment(b.TIC_FECHA_PROMESA).add(CalculaTimeposInsertUpdate(),"hours").format("YYYY-MM-DD HH:mm:ss"):0==l.TIPIFICA_TIEMPO_EJECUCION?moment(n).add(a.TimeDefault,"seconds").format("YYYY-MM-DD HH:mm:ss"):moment(n).add(l.TIPIFICA_TIEMPO_EJECUCION,"seconds").format("YYYY-MM-DD HH:mm:ss");b.TIC_FECHA_SOLICITA=b.TIC_FECHA_SOLICITA?moment(b.TIC_FECHA_SOLICITA).add(CalculaTimeposInsertUpdate(),
"hours").format("YYYY-MM-DD HH:mm:ss"):moment(n).add(a.TimeDefault,"seconds").format("YYYY-MM-DD HH:mm:ss");""==b.TIC_CSCTICKET&&delete b.TIC_CSCTICKET;1==b.TIC_CERRADO&&(b.TIC_FECHA_CIERRE=n,b.TIC_FECHA_CIERRE_SOLA=n,b.TIC_FECHA_CIERRE_HORA_COMPLETA=n,g=b.TIC_FECHA_ALTA,n=moment(n),g=moment(g),n=n.diff(g,"seconds"),b.TIC_DURACION_EJECUCION=n);3==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(l=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION"),
l=l.option("selectedItem"),b.TIC_TIEMPO_RECEPCION=l.REQUISICION_PROVEEDORES_SLA,b.TIC_TIEMPO_EJECUCION=l.REQUISICION_PROVEEDORES_SLA,b.TIC_TIEMPO_CONFIRMACION=l.REQUISICION_PROVEEDORES_SLA):25==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(l=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION"),l=l.option("selectedItem"),b.TIC_TIEMPO_RECEPCION=l.REQUISICION_PROVEEDORES_SLA,b.TIC_TIEMPO_EJECUCION=l.REQUISICION_PROVEEDORES_SLA,b.TIC_TIEMPO_CONFIRMACION=
l.REQUISICION_PROVEEDORES_SLA):(b.TIC_TIEMPO_RECEPCION=l.TIPIFICA_TIEMPO_RECEPCION,b.TIC_TIEMPO_EJECUCION=0==l.TIPIFICA_TIEMPO_EJECUCION?a.TimeDefault:l.TIPIFICA_TIEMPO_EJECUCION,b.TIC_TIEMPO_CONFIRMACION=l.TIPIFICA_TIEMPO_CONFIRMACION);b.TIC_NOTIFICA_OPERACION=1;b.TIC_ESTATUS_SLA_ENUM="pause";let h={};var c=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_TICKET_CSC").option("selectedItem");g=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT_PARENT").option("selectedItem");l=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("selectedItem");
n=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("selectedItem");var d=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem");let r=null;h.TipoIncidenteString=g.TIPIFICA_IDIOMA1;h.tipoTicketProvider=c.TIPO_TICKET_IDIOMA1;h.servicioProvider=l.TIPIFICA_IDIOMA1;h.inmuebleProvider=d.REQUISICION_PROVEEDORES_NOMBRE;if(12==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(("ALTA"==g.TIPIFICA_IDIOMA1||"BAJA"==g.TIPIFICA_IDIOMA1||
"CAMBIO"==g.TIPIFICA_IDIOMA1)&&0==Object.keys(a._DatosComplementariosTicket).length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`La categoria de ticket de tipo ${g.TIPIFICA_IDIOMA1} requiere informaci\u00f3n complementaria. por favor agregue los datos.`,400,140);p.hide();return}h.FechaAplicaString=a._DatosComplementariosTicket.FechaAplicaString;h.ModeloString=a._DatosComplementariosTicket.ModeloString;h.MotivoString=b.TIC_DESCRIPCION;h.NumeroSerieString=
a._DatosComplementariosTicket.NumeroSerieString;h.MarcaString=a._DatosComplementariosTicket.MarcaString;h.NombreComponente=l.TIPIFICA_IDIOMA1;h.CategoriaAlta=n.TIPIFICA_IDIOMA1;h.TAG_COMPONENTE=b.TAG_COMPONENTE}else if(3==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(("ALTA"==g.TIPIFICA_IDIOMA1||"BAJA"==g.TIPIFICA_IDIOMA1||"CAMBIO"==g.TIPIFICA_IDIOMA1)&&0==Object.keys(a._DatosComplementariosTicket).length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
`La categoria de ticket de tipo ${g.TIPIFICA_IDIOMA1} requiere informaci\u00f3n complementaria. por favor agregue los datos.`,400,140);p.hide();return}if("REQUERIMIENTO DE SERVICIO"==g.TIPIFICA_IDIOMA1){d=a.documentsUploadToTicket.option("value");if(0==d.length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`La categoria de ticket de tipo ${g.TIPIFICA_IDIOMA1} requiere un archivo. Agr\u00e9guelo en documentos`,400,140);p.hide();return}0<d.length&&(g=d[0],
h.AttachmenName="ArchivoCargado",h.AttachmenSize=g.size,h.FechaAplicaString=a._DatosComplementariosTicket.FechaAplicaString,h.ModeloString=a._DatosComplementariosTicket.ModeloString,h.MotivoString=b.TIC_DESCRIPCION,h.NumeroSerieString=a._DatosComplementariosTicket.NumeroSerieString,h.MarcaString=a._DatosComplementariosTicket.MarcaString,h.NombreComponente=l.TIPIFICA_IDIOMA1,h.CategoriaAlta=n.TIPIFICA_IDIOMA1,h.TAG_COMPONENTE=b.TAG_COMPONENTE,l=new FileReader,l.onload=function(t){r=t.target.result;
t={...ReturnDefaultData_Init(),DATA_INSERT:b,DATA_STRINGS_PROVIDERS:h,DATA_IMAGE_ARCHIVO:r};a.InsertTicketProviderTesteo(t)},l.readAsDataURL(g));return}d=a.documentsUploadToTicket.option("value");if(1==d.length){g=d[0];h.AttachmenName="ArchivoCargado";h.AttachmenSize=g.size;h.FechaAplicaString=a._DatosComplementariosTicket.FechaAplicaString;h.ModeloString=a._DatosComplementariosTicket.ModeloString;h.MotivoString=b.TIC_DESCRIPCION;h.NumeroSerieString=a._DatosComplementariosTicket.NumeroSerieString;
h.MarcaString=a._DatosComplementariosTicket.MarcaString;h.NombreComponente=l.TIPIFICA_IDIOMA1;h.CategoriaAlta=n.TIPIFICA_IDIOMA1;h.TAG_COMPONENTE=b.TAG_COMPONENTE;l=new FileReader;l.onload=function(t){r=t.target.result;t={...ReturnDefaultData_Init(),DATA_INSERT:b,DATA_STRINGS_PROVIDERS:h,DATA_IMAGE_ARCHIVO:r};a.InsertTicketProviderTesteo(t)};l.readAsDataURL(g);return}if(2<=d.length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),'El proveedor solo permite agregar un documento, desvincule los archivos en "Documentos"',
400,140);p.hide();return}h.FechaAplicaString=a._DatosComplementariosTicket.FechaAplicaString;h.ModeloString=a._DatosComplementariosTicket.ModeloString;h.MotivoString=b.TIC_DESCRIPCION;h.NumeroSerieString=a._DatosComplementariosTicket.NumeroSerieString;h.MarcaString=a._DatosComplementariosTicket.MarcaString;h.NombreComponente=l.TIPIFICA_IDIOMA1;h.CategoriaAlta=n.TIPIFICA_IDIOMA1;h.TAG_COMPONENTE=b.TAG_COMPONENTE}else if(23==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){if(("ALTA DE USUARIO"==
n.TIPIFICA_IDIOMA1||"BAJA DE USUARIO"==n.TIPIFICA_IDIOMA1||"MONITOREO Y SEGUIMIENTO DE VEH\u00cdCULOS"==n.TIPIFICA_IDIOMA1||'ACTUALIZACI\u00d3N DE LISTA: "MEDIDA DE CONTROL CPED"'==n.TIPIFICA_IDIOMA1)&&0==Object.keys(a._DatosComplementariosTicket).length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`La categoria de ticket de tipo ${n.TIPIFICA_IDIOMA1} requiere informaci\u00f3n complementaria. por favor agregue los datos.`,400,140);p.hide();return}}else if(36==
a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA,h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA,h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;else if(19==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA,h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA,h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA,d=1,57==c.TIPO_TICKET_CSC?d=2:56==c.TIPO_TICKET_CSC&&(d=1),h.tipo_solicitud=d;else if(4==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_2=
l.TIPIFICA_CLAVE_EXTERNA,h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;else if(10==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA,h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA,h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;else if(20==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){var e=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("selectedItem"),f=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_SEVERIDAD_CSC").option("selectedItem");
h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA;h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA;h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;h.idImpacto=f.TIPO_SEVERIDAD_TICKET_IDIOMA2;h.idUrgencia="URG0001";h.idPrioridad=e.TIPO_PRIORIDAD_IDIOMA2;h.tipoOperacion=c.TIPO_TICKET_IDIOMA2;h.UBICACION=d.REQUISICION_PROVEEDORES_NOMBRE;h.RFCCLIENTE=q.EMPLEADO_RFC}else if(25==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_1=g.TIPIFICA_IDIOMA1,h.tipi_2=l.TIPIFICA_IDIOMA1,h.tipi_3=n.TIPIFICA_IDIOMA1,
h.identificador_componente=b.TAG_COMPONENTE,h.inmuebleProviderConcat=`VPN ${d.REQUISICION_PROVEEDORES_CODIGO_VPN} ${d.REQUISICION_PROVEEDORES_NOMBRE}`;else if(6==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"))h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA,h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA,h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA,h.inmuebleProviderConcat=`${d.REQUISICION_PROVEEDORES_NOMBRE}`,h.identificador_componente=b.TAG_COMPONENTE;else if(8==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){c=
a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("selectedItem");e=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_SEVERIDAD_CSC").option("selectedItem");f=a.imageUploadToTicket.option("value");if(1==f.length){f=f[0];h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA;h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA;h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;h.inmuebleProviderConcat=`${d.REQUISICION_PROVEEDORES_NOMBRE}`;h.urgency=c.TIPO_PRIORIDAD_IDIOMA1;h.impact=e.TIPO_SEVERIDAD_TICKET_IDIOMA1;h.identificador_componente=
b.TAG_COMPONENTE;h.AttachmenName=f.name;h.AttachmenSize=f.size;h.AttachmenType=f.type;l=new FileReader;l.onload=function(t){r=t.target.result;t={...ReturnDefaultData_Init(),DATA_INSERT:b,DATA_STRINGS_PROVIDERS:h,DATA_IMAGE_ARCHIVO:r};a.InsertTicketProviderTesteo(t)};l.readAsDataURL(f);return}if(2<=f.length){a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),'El proveedor solo permite agregar un imagen, desvincule los archivos en "Imagenes"',400,140);p.hide();
return}h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA;h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA;h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;h.inmuebleProviderConcat=`${d.REQUISICION_PROVEEDORES_NOMBRE}`;h.urgency=c.TIPO_PRIORIDAD_IDIOMA1;h.impact=e.TIPO_SEVERIDAD_TICKET_IDIOMA1;h.identificador_componente=b.TAG_COMPONENTE}else if(11==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")){c=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("selectedItem");e=a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_SEVERIDAD_CSC").option("selectedItem");
f=a.imageUploadToTicket.option("value");if(0<f.length){let t=[];for(let u=0;u<f.length;u++){let v=f[u];if(3145728<v.size){a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`El archivo ${v.name} excede el l\u00edmite de tama\u00f1o de 3 MB. Por favor, sube archivos m\u00e1s peque\u00f1os.`,400,130);return}var m=await a.readFileAsBase64(v);m=a.extractBase64Data(m);t.push({AttachmenType:v.type,AttachmenName:v.name,AttachmenSize:v.size,AttachmenBlob:m})}h.tipi_1=
g.TIPIFICA_CLAVE_EXTERNA;h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA;h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;h.inmuebleProviderConcat=`${d.REQUISICION_PROVEEDORES_NOMBRE}`;h.urgency=c.TIPO_PRIORIDAD_IDIOMA1;h.impact=e.TIPO_SEVERIDAD_TICKET_IDIOMA1;h.identificador_componente=b.TAG_COMPONENTE;l={...ReturnDefaultData_Init(),DATA_INSERT:b,DATA_STRINGS_PROVIDERS:h,aryImages:t};a.InsertTicketProviderTesteo(l);return}h.tipi_1=g.TIPIFICA_CLAVE_EXTERNA;h.tipi_2=l.TIPIFICA_CLAVE_EXTERNA;h.tipi_3=n.TIPIFICA_CLAVE_EXTERNA;h.inmuebleProviderConcat=
`${d.REQUISICION_PROVEEDORES_NOMBRE}`;h.urgency=c.TIPO_PRIORIDAD_IDIOMA1;h.impact=e.TIPO_SEVERIDAD_TICKET_IDIOMA1;h.identificador_componente=b.TAG_COMPONENTE}b.TIC_DESCRIPCION+=` \n\n Categor\u00eda nivel 1: ${g.TIPIFICA_IDIOMA1} \n Categor\u00eda nivel 2: ${l.TIPIFICA_IDIOMA1} \n Categor\u00eda nivel 3: ${n.TIPIFICA_IDIOMA1}`;b.TIC_NEWID_PARENT=getUrlParam("TK_ID");l={...ReturnDefaultData_Init(),DATA_INSERT:b,DATA_STRINGS_PROVIDERS:h,DATA_IMAGE_ARCHIVO:r};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Insert_Ticket_Servicio","POST",JSON.stringify(l),getJSON(DeveloperType).ApiTickets_v2.token).then(t=>{if(1==t.success){DevExpress.ui.notify({message:"Solicitud generada correctamente",minWidth:150,type:"success",displayTime:1E4},{position:"bottom right",direction:"up-push"});$Btn_Alta_Ticket.option("visible",!0);$btn_Modificar_Ticket.option("visible",!0);$btn_Cancelar_Alta_Ticket.option("visible",!1);$btn_Salvar_Alta_Ticket.option("visible",!1);a.Frm_Ticket_Servicio_Instance.option("readOnly",!0);
var u={...ReturnDefaultData_Init(),TIC_NEWID:k.TIC_NEWID,CAM_CSC_SERVICIO:k.CAM_CSC_SERVICIO},v=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem"),w={};w.TIC_CSCTICKET=t.JsonData.idTicketInsert;w.ESTATUS_TICKET_CSC=v.ESTATUS_TICKET_CSC;let y=t.ResProvider;null!=y&&(0==y.isSuccessProvider?(a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"El ticket no fue insertado en la mesa del proveedor, verificar informaci\u00f3n en bitacora para mas detalle",
400,140),a.InsertaBitacoraManual(w,JSON.stringify(y.errorDetail),!0,2,1)):a.InsertaBitacoraManual(w,JSON.stringify(y.Detail),!0,1,2));p.show();a.InsertaBitacoraManual(w,Globalize.formatMessage("txtBitaInfoAltaProceso")+": "+v.ESTATUS_TICKET_IDIOMA1,!1,1,2);a.uploadImageToTicket(!1);a.uploadFileToTicket(!1);setTimeout(()=>{p.show();setTimeout(()=>{a.Get_Tickets(u,!0,null)},3E3)},2E3)}else w=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),v="",v=12==w||3==w?`${JSON.stringify(t.ResProvider.errorDetail.message.message)}`:
24==w?`${JSON.stringify(t.ResProvider.errorDetail.message)}`:25==w?`${JSON.stringify(t.ResProvider.errorDetail.message.message)}`:11==w?`Comunicaci\u00f3n con proveedor ${JSON.stringify(t.ResProvider.providerName)} no exitosa ${JSON.stringify(t.ResProvider.Detail)}`:8==w?`Comunicaci\u00f3n con proveedor ${JSON.stringify(t.ResProvider.providerName)} no exitosa ${JSON.stringify(t.ResProvider.Detail)}`:t.message,a.notificaPantalla("Error de comunicaci\u00f3n!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),
`${v}`,400,140),p.hide();return t}).catch(function(t){console.log(t);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}else DevExpress.ui.notify({message:"Llene los campos en rojo",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})};a.InsertTicketProviderTesteo=function(g){var k=a.Frm_Ticket_Servicio_Instance.option("formData");
__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Ticket_Servicio","POST",JSON.stringify(g),getJSON(DeveloperType).ApiTickets_v2.token).then(l=>{if(1==l.success){DevExpress.ui.notify({message:"Solicitud generada correctamente",minWidth:150,type:"success",displayTime:1E4},{position:"bottom right",direction:"up-push"});$Btn_Alta_Ticket.option("visible",!0);$btn_Modificar_Ticket.option("visible",!0);$btn_Cancelar_Alta_Ticket.option("visible",!1);$btn_Salvar_Alta_Ticket.option("visible",
!1);a.Frm_Ticket_Servicio_Instance.option("readOnly",!0);var n={...ReturnDefaultData_Init(),TIC_NEWID:k.TIC_NEWID,CAM_CSC_SERVICIO:k.CAM_CSC_SERVICIO},b=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem"),c={};c.TIC_CSCTICKET=l.JsonData.idTicketInsert;c.ESTATUS_TICKET_CSC=b.ESTATUS_TICKET_CSC;let d=l.ResProvider;null!=d&&(0==d.isSuccessProvider?(a.notificaPantalla("Alerta!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"El ticket no fue insertado en la mesa del proveedor, verificar informaci\u00f3n en bitacora para mas detalle",
400,140),a.InsertaBitacoraManual(c,JSON.stringify(d.errorDetail),!0,2,1)):a.InsertaBitacoraManual(c,JSON.stringify(d.Detail),!0,1,2));p.show();a.InsertaBitacoraManual(c,Globalize.formatMessage("txtBitaInfoAltaProceso")+": "+b.ESTATUS_TICKET_IDIOMA1,!0,1,2);a.uploadImageToTicket(!1);a.uploadFileToTicket(!1);setTimeout(()=>{p.show();setTimeout(()=>{a.Get_Tickets(n,!0,null)},3E3)},2E3)}else c=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),b="",b=12==c||3==c?`${JSON.stringify(l.ResProvider.errorDetail.message.message)}`:
11==c?`Comunicaci\u00f3n con proveedor ${JSON.stringify(l.ResProvider.providerName)} no exitosa ${JSON.stringify(l.ResProvider.Detail)}`:8==c?`Comunicaci\u00f3n con proveedor ${JSON.stringify(l.ResProvider.providerName)} no exitosa ${JSON.stringify(l.ResProvider.Detail)}`:l.message,a.notificaPantalla("Error de comunicaci\u00f3n!",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${b}`,400,140),p.hide();return l}).catch(function(l){console.log(l);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",
minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})};a.convertFileToBase64=function(g){return new Promise((k,l)=>{const n=new FileReader;n.onload=()=>{const b=n.result.split(",")[1];k(b)};n.onerror=b=>{l(b)};n.readAsDataURL(g)})};a.Get_Tickets=function(g,k,l){p.show();__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Servicio","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(n=>{if(1==n.success){p.hide();var b=n.JsonData[0];null!=b.TIC_FECHA_PROMESA&&
(b.TIC_FECHA_PROMESA=moment(b.TIC_FECHA_PROMESA).add(a.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD HH:mm:ss"));null!=b.TIC_FECHA_ALTA&&(b.TIC_FECHA_ALTA=moment(b.TIC_FECHA_ALTA).add(a.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD HH:mm:ss"));null!=b.TIC_FECHA_CIERRE&&(b.TIC_FECHA_CIERRE=moment(b.TIC_FECHA_CIERRE).add(a.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD HH:mm:ss"));null!=b.TIC_FECHA_SOLICITA&&(b.TIC_FECHA_SOLICITA=moment(b.TIC_FECHA_SOLICITA).add(a.TiempoUTCEmpleado,"hours").format("YYYY-MM-DD HH:mm:ss"));
null!=b.TIC_JSON_EXTRA_PARAMS&&(b.TIC_JSON_EXTRA_PARAMS=JSON.stringify(b.TIC_JSON_EXTRA_PARAMS));switch(getUrlParam("TPO_USUARIO")){case "GENERA":a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("readOnly",!0);$btnCalificaAtencion.option("visible",!0);$btn_Modificar_Ticket.option("visible",!1);break;default:if(a.Frm_Ticket_Servicio_Instance.itemOption("CAM_CSC_SERVICIO_SOLICITA","isRequired",!0),null==b.EMPLEADO_CSC_ATIENDE){if(console.log("No se tiene empleados asignado"),
"GENERA"!=getUrlParam("TPO_USUARIO")){b.EMPLEADO_CSC_ATIENDE=q.EMPLEADO_CSC_EMPLEADO;var c={};c.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;c.EMPLEADO_CSC_ATIENDE=q.EMPLEADO_CSC_EMPLEADO;c.AUDITORIA_FEC_ULT_MOD=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");c={...ReturnDefaultData_Init(),DATA_UPDATE:c,DATA_WHERE:{TIC_CSCTICKET:b.TIC_CSCTICKET,TIC_NEWID:b.TIC_NEWID,EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST")}};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Update_Ticket_Servicio","POST",JSON.stringify(c),getJSON(DeveloperType).ApiTickets_v2.token).then(e=>{1==e.success&&(DevExpress.ui.notify("Empleado Asignado correctamente","success",3E3),a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("value",q.EMPLEADO_NOMBREEMPLEADO+" "+q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO))}).catch(function(e){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)});var d=q.EMPLEADO_NOMBREEMPLEADO+" "+
q.EMPLEADO_APATERNOEMPLEADO+" "+q.EMPLEADO_AMATERNOEMPLEADO;c={};c.TIC_CSCTICKET=b.TIC_CSCTICKET;c.ESTATUS_TICKET_CSC=b.ESTATUS_TICKET_CSC;a.InsertaBitacoraManual(c,"Ticket asignado a: "+d,!0,1,2);console.log("Ticket asignado a: "+d)}}else DevExpress.ui.notify("Ya se esta atendiendo por un operador","warning",3E3),console.log("Ya se tiene empleado asignado")}b=JSON.stringify(b);a.DataTicketOpen=JSON.parse(b);a.Frm_Ticket_Servicio_Instance.updateData(a.DataTicketOpen);setTimeout(()=>{a.ObtenSelectBoxFrm(a.Frm_Ticket_Servicio_Instance);
a.Get_Ticket_Documentos(!1);a.Previous_TxtEstatus=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("text");getUrlParam("TPO_USUARIO")},3E3);if(1==k){$("#Pop_Notificacion_Success").dxPopup("instance").option("height",300);$("#Pop_Notificacion_Success").dxPopup("instance").option("width",360);$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(){return $("<div>").append($("<div class='popup-property-details'>").append($('<div class="Nice-Shadow-1" style="padding: 9px;">TICKET GENERADO</div>'),
$('<div class="content">').append($('<img style=" width: 200px; height: 150px;" src="../../images/Icons/success_ticket.gif" alt="">'),$('<div style="flex-grow: 1; font-size: 20px; font-weight: bold;">No. ticket: '+n.JsonData[0].TIC_CSCTICKET+"</div>"),$('<div style="flex-grow: 1; font-size: 12px;">GUARDE SU NUMERO DE TICKET PARA FUTURAS CONSULTAS</div>'))))});$("#Pop_Notificacion_Success").dxPopup("show");b=a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("selectedItem");c=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem");
d=a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("selectedItem");let e=a.Frm_Ticket_Servicio_Instance.getEditor("PM_CSC_PROYECTO_SOLICITA").option("selectedItem");a.EnviaRespuesta("Nuevo ticket No. - "+a.DataTicketOpen.TIC_CSCTICKET,a.DataTicketOpen.TIC_NEWID,`
                    <b>Estatus:</b> ${b.ESTATUS_TICKET_IDIOMA1} 
                    <br><b>Aduana:</b> ${c.REQUISICION_PROVEEDORES_CODIGO_VPN} ${c.REQUISICION_PROVEEDORES_NOMBRE} 
                    <br><b>Punto tactico:</b> ${c.REQUISICION_PROVEEDORES_CODIGO_VPN} 
                    <br><b>Numero de serie:</b> ${a.DataTicketOpen.TAG_COMPONENTE} 
                    <br><b>Nombre:</b> ${a.DataTicketOpen.TIC_SOLICITA} 
                    <br><b>Tel\u00e9fono:</b> ${a.DataTicketOpen.TIC_TELEFONO_SOLICITANTE} 
                    <br><b>Tecnolog\u00eda:</b> ${e.PM_NOMBRE} 
                    <br><b>Proveedor:</b> ${d.CAM_SERVICIO_NOMBRE} 
                    <br><br><b>Descripci\u00f3n:</b> ${a.DataTicketOpen.TIC_DESCRIPCION}

                    <br><br> Cordial saludo, queremos informarte que su ticket fue generado con \u00e9xito, a partir de este momento empezamos el estudio correspondiente para darte una respuesta con la mayor oportunidad posible.`,null)}}else p.hide(),1==k?DevExpress.ui.notify("TICKET NO LOCALIZADO","error",3E3):DevExpress.ui.notify("TICKETS NO LOCALIZADO","error",3E3);return n}).catch(function(n){p.hide();console.log(n);DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",
"error",3E3)})};a.Get_Bitacora_tickets=function(g){$("#Dg_Bitacora_Ticket").length&&(g={...ReturnDefaultData_Init(),TIC_CSCTICKET:g},__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Bitacora","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success?$("#Dg_Bitacora_Ticket").dxDataGrid("instance").option("dataSource",k.JsonData):$("#Dg_Bitacora_Ticket").dxDataGrid("instance").option("dataSource",[])}).catch(function(k){DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",
minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"});$("#Dg_Bitacora_Ticket").dxDataGrid("instance").option("dataSource",[])}))};a.Get_Ticket_Foto=function(){if($("#Dg_RepFoto_Ticket").length){var g=a.Frm_Ticket_Servicio_Instance.option("formData");g={...ReturnDefaultData_Init(),TIC_NEWID:g.TIC_NEWID,TICKET_ACTIVO:1};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Foto","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success?
$("#Dg_RepFoto_Ticket").dxDataGrid("instance").option("dataSource",k.JsonData):($("#Dg_RepFoto_Ticket").dxDataGrid("instance").option("dataSource",[]),p.hide())})}};a.Get_Ticket_Documentos=function(g){if($("#Dg_Documento_Ticket").length){var k=a.Frm_Ticket_Servicio_Instance.option("formData");k={...ReturnDefaultData_Init(),TIC_NEWID:k.TIC_NEWID,TICKET_FILE_ACTIVO:1};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Documentos","GET",k,getJSON(DeveloperType).ApiTickets_v2.token).then(l=>
{if(1==l.success){var n=jslinq(l.JsonData).where(function(b){return"Solicitud_Servicio_Sistema.pdf"==b.TICKET_FILE_DESCRIPCION.trim()}).toList();1==g&&0<n.length&&a.ObtenSolicitudFormal(n[0].TIC_NEWID,n[0].TICKET_FILE_RUTA);$("#Dg_Documento_Ticket").dxDataGrid("instance").option("dataSource",l.JsonData)}else $("#Dg_Documento_Ticket").dxDataGrid("instance").option("dataSource",[]),p.hide()})}};a.Get_Linkeo_ticket_ot=function(g){a._Obj_Ot_Ticket_Grid.clear();if(58!=q.CAT_AREA_CSC||112!=q.CAT_DEPARTAMENTO_CSC)g=
{...ReturnDefaultData_Init(),TIC_CSCTICKET:g,MS:"BASE"},__Reques_ajax(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+"Get_Linkeo_ticket_ot","GET",g,getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(k=>{1==k.success&&k.JsonData.forEach(function(l){a._Obj_Ot_Ticket_Grid.insert(l)});a._Datagrid_Ot_Ticket.refresh()}).catch(function(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);a._Datagrid_Ot_Ticket.refresh()})};a.Get_Ticket_Participantes=function(g){$("#Dg_Ticket_Participantes").length&&
(a._Obj_Ticket_Participantes_Grid.clear(),g={...ReturnDefaultData_Init(),TIC_NEWID:g,TIPO_PARTICIPANTE_CSC_IN:"1,2,3"},__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Ticket_Part","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success&&(k=k.JsonData,console.log(k),k.forEach(function(l){a._Obj_Ticket_Participantes_Grid.insert(l)}));a._DataGrid_Ticket_Participante.refresh()}).catch(function(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",
"error",3E3);a._DataGrid_Ticket_Participante.refresh()}))};a.EnviaCorreo=function(g){x.show();x.message=Globalize.formatMessage("msjTicketSendMail");g=a.Frm_Ticket_Servicio_Instance.option("formData");g=[{mail:CorreoEnviar,Nombre:NombreMandaCorreo,Proceso:"Actualizaci\u00f3n de Solicitud",Solicitud:g.TIC_DESCRIPCION_SOLUCION}];var k=null;for(const l in g)k={CLAVE_SMTP:"DNA.ORACLE",Template:"Noti_Generica",emailto:g[l].mail,subject:"Notificaciones tickets",bcc:dts_FrmSura.EMAIL_RESPUESTA_CCO,TEMPLATE_PARAMETROS:{emailAddress:g[l].mail,
titulosolicitud:NombreMandaCorreo,lblproceso:g[l].Proceso,lbltiposolicitud:"<p>Cordial saludo,</p>\n        <p></p>\n        <p>\n          Te informamos que la solicitud a nombre de XXXXXX, con documento No. XXXX, se\n          encuentra en estado &quot;PENDIENTE POR REQUISITOS&quot; para poder hacer\n          efectiva esta solicitud debes adjuntar:\n        </p>\n        <p></p>\n        <p>XXXXX (especificar lo que se requiera)</p>\n        <p></p>\n        <p>\n          Es importante tener en cuenta que el tiempo de respuesta inicia, una vez la\n          solicitud tenga los requisitos completos.\n        </p>\n        <p></p>\n        <p>Muchas gracias por su comprensi\u00f3n y colaboraci\u00f3n.</p>",
lbltipotitulosoli:"Por favor, NO respondas a este mensaje, este es un medio informativo autom\u00e1tico. Si requieres m\u00e1s informaci\u00f3n sobre el contenido haz click aqu\u00ed: ",lblnombresoli:"Enviado por: BOT DNASYSTEM"}},__Reques_ajax(getJSON(DeveloperType).ApiSuraCrmColombia.url+"Send_Mail_Dinamico","POST",JSON.stringify(k),getJSON(DeveloperType).ApiSuraCrmColombia.token).then(n=>{1==n.success&&DevExpress.ui.notify({message:"E-Mail Enviado",minWidth:150,type:"success",displayTime:5E3},
{position:"bottom right",direction:"up-push"});x.hide()}).catch(function(n){x.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION CON EL SERVIDOR INTENTE NUEVAMENTE",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"});console.log(n)})};a.utf8Encode=function(g){if("string"!=typeof g)throw new TypeError("parameter \u2018unicodeString\u2019 is not a string");return g.replace(/[\u0080-\u07ff]/g,function(k){k=k.charCodeAt(0);return String.fromCharCode(192|
k>>6,128|k&63)}).replace(/[\u0800-\uffff]/g,function(k){k=k.charCodeAt(0);return String.fromCharCode(224|k>>12,128|k>>6&63,128|k&63)})};a.EnviaRespuesta=function(g,k,l,n){x.show();x.message=Globalize.formatMessage("msjTicketSendMail");let b=a.Frm_Ticket_Servicio_Instance.option("formData"),c="";c=b.TIC_EMAIL_SOLICITANTE;g={_ClientData:{EMP_CLV_EMPRESA:ReturnDefaultData_Init().EMP_CLV_EMPRESA,Type:ReturnDefaultData_Init().Type,EMP_CSC_EMPRESA_HOST:ReturnDefaultData_Init().EMP_CSC_EMPRESA_HOST},MailDataConfig:{emailto:c,
subject:`${g} ###${b.TIC_CSCTICKET}###${k}`,template:{templateLayout:"Noti_Dna_Default",templateData:{lbl_id_ticket:"No. de ticket",val_id_ticket:b.TIC_CSCTICKET,lbl_f_alta:"Fecha de alta",val_f_alta:b.TIC_FECHA_ALTA,lbl_tipo:"Tipo",val_tipo:a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_TICKET_CSC").option("text"),lbl_prio:"Prioridad",val_prio:a.Frm_Ticket_Servicio_Instance.getEditor("TIPO_PRIORIDAD_CSC").option("text"),lbl_head_info:"Informaci\u00f3n de solictud",lbl_mesa:"Mesa de ayuda",val_mesa:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_MESA_CSC").option("text"),
lbl_estatus:"Estatus",val_estatus:a.Frm_Ticket_Servicio_Instance.getEditor("ESTATUS_TICKET_CSC").option("text"),txt_body_mail:l,lbl_footer:"<b>INFORMACI\u00d3N CONFIDENCIAL</b> Este comunicado es para ser utilizado por el receptor y contiene informaci\u00f3n que puede ser privilegiada, confidencial, de propiedad intelectual y/o que contenga datos personales, de acuerdo con las leyes aplicables. Si usted no es el receptor interesado, por el presente se le notifica formalmente que cualquier uso, copia o distribuci\u00f3n de este correo electr\u00f3nico, en todo o en parte, est\u00e1 estrictamente prohibido. Por favor notifique al remitente regres\u00e1ndole este correo electr\u00f3nico y b\u00f3rrelo de su sistema. Este correo electr\u00f3nico no constituye un consentimiento para el uso de la informaci\u00f3n del remitente, para prop\u00f3sitos directos de mercadotecnia o para transmisiones de informaci\u00f3n a terceros.",
fechaEnvio:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),EMPLEADO_CSC_EMPLEADO:q.EMPLEADO_CSC_EMPLEADO,TIC_NEWID:k,MensajeNewId:n}}}};$.ajax({xhr:function(){var d=new window.XMLHttpRequest;d.upload.addEventListener("progress",function(e){},!1);return d},type:"POST",url:`${getJSON(DeveloperType).Bot_Internal_Storage_Anam.url}apiNotify/mailsystem/SendMail`,cache:!1,processData:!1,data:JSON.stringify(g),contentType:"application/json",headers:{}}).done(function(d){1==d.success&&DevExpress.ui.notify({message:"E-Mail Enviado",
minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"});x.hide()}).fail(function(d){console.log(d);DevExpress.ui.notify({message:"Error en el envio de correo",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"});x.hide()})};a.Generar_Orden_Trabajo_Rechazo=function(){var g=JSON.parse(sessionStorage.getItem("Cat_Proceso_Empleados")),k=JSON.parse(sessionStorage.getItem("Cat_Sub_Proceso_Empleados")),l=JSON.parse(sessionStorage.getItem("Cat_Estatus_Empleados"));
g=jslinq(g).where(function(n){return"ACTIVO"==n.CAT_PROCESO_EMP_CLAVE.trim()}).toList();k=jslinq(k).where(function(n){return"OPER"==n.CAT_SUBPROCESO_EMP_CLAVE.trim()}).toList();jslinq(l).where(function(n){return"ACT"==n.CAT_ESTATUS_PROCESO_EMP_CLAVE.trim()}).toList();l=g[0].CAT_PROCESO_EMP_CSC;k=k[0].CAT_SUBPROCESO_EMP_CSC;l={...ReturnDefaultData_Init(),CAT_PROCESO_EMP_CSC:l,CAT_SUBPROCESO_EMP_CSC:k,CAT_AREA_CSC:58,CAT_DEPARTAMENTO_CSC:107,OTR_CERRADA:0};__Reques_ajax(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+
"Get_Ot_Conteo_Empleado","GET",l,getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(n=>{if(1==n.success){p.hide();n=n.JsonData;var b=a.Frm_Ticket_Servicio_Instance.option("formData");b="Detalle solicitud: "+b.TIC_DESCRIPCION+" Detalle de rechazo: "+b.TIC_MOTIVO_RECHAZO;var c=createUUID(36);n={EMP_CLV_EMPRESA:localStorage.getItem("EMP_CLV_EMPRESA"),Type:localStorage.getItem("Type"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),DATA_INSERT:{OTR_FECHA_ALTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),
OTR_NEWID:c,REQ_CSCREQUISICION:q.REQ_CSCREQUISICION,ESTATUS_ORDEN_CSC:1,CAT_PROVEEDOR_INFRA_CSC:12,TIPO_PRIORIDAD_CSC:3,TIPO_ORDEN_CSC:63,SUB_TIPO_CSC:351,TIPO_DISCIPLINA_OT_CSC:3,TIPO_ESPECIALIDAD_OT_CSC:48,TIPO_OT_TRAMITE_CSC:1,TIPO_CALIFICACION_CSC:1,EMPLEADO_CSC_SOLICITA:q.EMPLEADO_CSC_EMPLEADO,EMPLEADO_CSC_RESPONSABLE:n[0].EMPLEADO_CSC_EMPLEADO,TIPO_AREA_CSC_SOLICITUD:q.CAT_AREA_CSC,CAT_DEPTO_CSC_SOLICITUD:q.CAT_DEPARTAMENTO_CSC,TIPO_AREA_CSC_RESPONSABLE:58,CAT_DEPTO_CSC_RESPONSABLE:107,EMPLEADO_CSC_ALTA:q.EMPLEADO_CSC_EMPLEADO,
MDA_CVEMONEDA:1,OTR_COSTO:0,OTR_DESCRIPCION:b,OTR_SOLUCION:"",OTR_CANCELACION:"",OTR_FECHA_PROGRAMADA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),OTR_FECHA_PROMESA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),OTR_CERRADA:!1,MDA_CVEMONEDA_TOTAL:1,OTR_COSTO_TOTAL:0,SAMT_CSC_CENTRO_COSTOS:null,AUDITORIA_USU_ALTA:q.EMPLEADO_CSC_EMPLEADO,AUDITORIA_USU_ULT_MOD:q.EMPLEADO_CSC_EMPLEADO,AUDITORIA_FEC_ALTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),AUDITORIA_FEC_ULT_MOD:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),
OTR_FECHA_ALTA_CORTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),OTR_FECHA_ALTA_HORA_COMPLETA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),CLIENTE_CSC:q.CLIENTE_CSC,PM_CSC_PROYECTO:q.PM_CSC_PROYECTO,CAM_CSC_SERVICIO:q.CAM_CSC_SERVICIO}};__Reques_ajax(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+"Insert_Orden_Trabajo","POST",JSON.stringify(n),getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(d=>
{1==d.success?(p.hide(),DevExpress.ui.notify("Ot insertada correctamente","success",4E3),a.Consulta_Ordenes_Trabajo({OTR_NEWID:c},!0)):p.hide();return d}).catch(function(d){p.hide();DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)})}else p.hide(),DevExpress.ui.notify("No se localizo ninguna empleado","success",3E3)}).catch(function(n){console.log(n);p.hide();DevExpress.ui.notify("Error de de busqueda vueva a intentar nuevamente","error",3E3)})};a.Consulta_Ordenes_Trabajo=
function(g,k){var l={...ReturnDefaultData_Init()};g=Object.assign(l,g);p.show();__Reques_ajax(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+"Get_Orden_Trabajo","GET",g,getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(n=>{1==n.success?(p.hide(),n=n.JsonData,1==k&&(n={EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST"),TIC_CSCTICKET:a.DataTicketOpen.TIC_CSCTICKET,OTR_CSCORDENTRABAJO:n[0].OTR_CSCORDENTRABAJO,AUDITORIA_USU_ALTA:q.EMPLEADO_CSC_EMPLEADO,AUDITORIA_USU_ULT_MOD:q.EMPLEADO_CSC_EMPLEADO,
AUDITORIA_FEC_ALTA:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),AUDITORIA_FEC_ULT_MOD:moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss")},a.Inserta_Interseccion_Ot_Ticket(n))):(p.hide(),DevExpress.ui.notify("No se localizo ninguna Ot","success",3E3))}).catch(function(n){console.log(n);p.hide();DevExpress.ui.notify("Error de de busqueda vueva a intentar nuevamente","error",3E3)})};a.Inserta_Interseccion_Ot_Ticket=function(g){g={...ReturnDefaultData_Init(),DATA_INSERT:g};
__Reques_ajax(getJSON(DeveloperType).ApiOrdenTrabajo_v2.url+"Insert_Inter_Ot_Ticket","POST",JSON.stringify(g),getJSON(DeveloperType).ApiOrdenTrabajo_v2.token).then(k=>{p.hide();return k}).catch(function(k){console.log(k);p.hide();DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)})};a.Get_Autorizaciones_Ticket=function(g){a._Obj_Autorizaciones_Grid.clear();g={...ReturnDefaultData_Init(),AUTORIZACIONES_TIC_NEWID:g};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Get_Autoriza_Ticket","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success&&k.JsonData.forEach(function(l){a._Obj_Autorizaciones_Grid.insert(l)});a._DataGrid_Autorizacion.refresh()}).catch(function(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);a._DataGrid_Autorizacion.refresh()})};a.Get_Respuesta_Mensaje=function(g){$("#Dg_MensajesClienteOperador").length&&(g={...ReturnDefaultData_Init(),TIC_CSCTICKET:g},__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Get_Respuesta_Mensaje","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success?$("#Dg_MensajesClienteOperador").dxDataGrid("instance").option("dataSource",k.JsonData):$("#Dg_MensajesClienteOperador").dxDataGrid("instance").option("dataSource",[])}).catch(function(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);$("#Dg_MensajesClienteOperador").dxDataGrid("instance").option("dataSource",[])}))};a.ActualizaRespuestaLectura=function(g,
k){var l={};"GENERA"==getUrlParam("TPO_USUARIO")?(l.RESPUESTA_LEIDO_CLIENTE=1,l.RESPUESTA_FEC_LEIDO_CLIENTE=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss")):(l.RESPUESTA_LEIDO_OPERADOR=1,l.RESPUESTA_FEC_LEIDO_OPERADOR=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"));g={...ReturnDefaultData_Init(),DATA_UPDATE:l,DATA_WHERE:{TIC_CSCTICKET:k,CSC_RESPUESTA:g,EMP_CSC_EMPRESA_HOST:localStorage.getItem("EMP_CSC_EMPRESA_HOST")}};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Update_Respuesta_Mensaje","POST",JSON.stringify(g),getJSON(DeveloperType).ApiTickets_v2.token).then(n=>{1==n.success&&DevExpress.ui.notify("Respuesta actualizada","success",3E3)}).catch(function(n){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)})};a.CopiarClipboar=function(g){navigator.clipboard.writeText(g).then(()=>{DevExpress.ui.notify("Copiado correctamente","success",4E3)}).catch(()=>{DevExpress.ui.notify("Ticket insertado correctamente","danger",
4E3)})};a.ObtenClipboard=function(g,k){navigator.clipboard.readText().then(l=>{$("#"+g).dxForm("instance").getEditor(k).option("value",l)}).catch(l=>{})};a.BusquedaEmpleado=function(g,k){$("#Pop_Notificacion_Success").dxPopup("instance").option("height","450");$("#Pop_Notificacion_Success").dxPopup("instance").option("width","600");$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(){return $("<div>").append($("<div class='popup-property-details'>").append($('<div class="Nice-Shadow-1" style="padding: 9px;">Buscar empleado</div>'),
$("<div style='margin: 9px;'/>").attr("id","DataGridEmpleadosBusqueda").dxDataGrid({headerFilter:{visible:!1},keyExpr:"EMPLEADO_CSC_EMPLEADO",dataSource:a._Obj_Empleados_Grid,selection:{mode:k},height:300,filterRow:{visible:!0,applyFilter:"auto"},scrolling:{useNative:!1,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always"},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},hoverStateEnabled:!0,showBorders:!0,showRowLines:!0,showColumnLines:!0,rowAlternationEnabled:!0,
columnAutoWidth:!1,columns:[{caption:"NO. DE EMPLEADO",dataField:"EMPLEADO_ID_EXTERNO",alignment:"left",width:120},{caption:"NOMBRE",dataField:"NOMBRE",sortOrder:"asc",alignment:"left"},{caption:"Proceso",dataField:"CAT_PROCESO_EMP_CSC",alignment:"left",groupIndex:0,lookup:{displayExpr:"CAT_PROCESO_EMP_IDIOMA1",valueExpr:"CAT_PROCESO_EMP_CSC",dataSource:{store:new DevExpress.data.CustomStore({load:async function(){try{return JSON.parse(sessionStorage.getItem("Cat_Proceso_Empleados"))}catch(c){console.log(c)}}})}}},
{dataField:"ACCIONES",type:"buttons",width:110,buttons:[{text:"Seleccionar",onClick(c){switch(g){case "Solicita":a.Frm_Ticket_Servicio_Instance.getEditor("TIC_SOLICITA").option("value",c.row.data.NOMBRE);a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("value",c.row.data.EMPLEADO_CSC_EMPLEADO);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_EMAIL_SOLICITANTE").option("value",c.row.data.EMPLEADO_EMAILLABORAL);a.Frm_Ticket_Servicio_Instance.getEditor("TIC_TELEFONO_SOLICITANTE").option("value",
c.row.data.EMPLEADO_TELEFONO1);$("#Pop_Notificacion_Success").dxPopup("hide");break;case "Atiende":a.Frm_Ticket_Servicio_Instance.getEditor("TIC_ATIENDE").option("value",c.row.data.NOMBRE);a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_ATIENDE").option("value",c.row.data.EMPLEADO_CSC_EMPLEADO);$("#Pop_Notificacion_Success").dxPopup("hide");break;case "AgregarParticipante":console.log(c.row.data)}}}]}]}),$('<div class="Nice-Shadow-1" style="margin: auto; margin-bottom: 10px;"/>').attr("id",
"btnAsgEmpleados").dxButton({stylingMode:"contained",text:"Agregar",icon:"add",type:"success",width:200,visible:!1,onClick(){let c=$("#DataGridEmpleadosBusqueda").dxDataGrid("instance").getSelectedRowsData(),d=null,e={},f=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss");0==c.length?DevExpress.ui.notify({message:"Seleccione al menos a un usuario",minWidth:150,type:"info",displayTime:8E3},{position:"bottom right",direction:"up-push"}):null!=a._DataGrid_Ticket_Participante.getDataSource()&&
(d=a._DataGrid_Ticket_Participante.getDataSource().items(),c.forEach(function(m){var h=a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_ATIENDE").option("value");let r=a.Frm_Ticket_Servicio_Instance.getEditor("EMPLEADO_CSC_SOLICITA").option("value");h==m.EMPLEADO_CSC_EMPLEADO||r==m.EMPLEADO_CSC_EMPLEADO?a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${m.NOMBRE}; ${Globalize.formatMessage("msjUserAtnSol")}`,400,130):(h=null,null==m.EMPLEADO_EMAILLABORAL||
""==m.EMPLEADO_EMAILLABORAL?null==m.SOLICITUD_EMPLEADO_EMAIL_PERSONAL||""==m.SOLICITUD_EMPLEADO_EMAIL_PERSONAL?a.notificaPantalla("Alerta",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${m.NOMBRE}; ${Globalize.formatMessage("msjEmail")}`,400,130):h=m.SOLICITUD_EMPLEADO_EMAIL_PERSONAL:h=m.EMPLEADO_EMAILLABORAL,void 0==(null==d?void 0:d.find(t=>t.EMPLEADO_CSC_EMPLEADO===m.EMPLEADO_CSC_EMPLEADO))?null!=h&&(e={...ReturnDefaultData_Init(),DATA_INSERT:{EMP_CSC_EMPRESA_HOST:ReturnDefaultData_Init().EMP_CSC_EMPRESA_HOST,
TIC_NEWID:a.Frm_Ticket_Servicio_Instance.option("formData").TIC_NEWID,EMPLEADO_CSC_EMPLEADO:m.EMPLEADO_CSC_EMPLEADO,TIPO_PARTICIPANTE_CSC:1,EMPLEADO_TELEFONO_NOTIFICA:m.EMPLEADO_CELULAR,EMPLEADO_EMAIL_NOTIFICA:h,AUDITORIA_USU_ALTA:q.EMPLEADO_CSC_EMPLEADO,AUDITORIA_USU_ULT_MOD:q.EMPLEADO_CSC_EMPLEADO,AUDITORIA_FEC_ALTA:f,AUDITORIA_FEC_ULT_MOD:f}},console.log(e)):a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`${m.NOMBRE}; ${Globalize.formatMessage("msjUserListPart")}`,
400,130))}))}})))});$("#Pop_Notificacion_Success").dxPopup("show");p.show();a._Obj_Empleados_Grid.clear();let l={},n=null,b=null;"AsignaTicket"==g?($("#DataGridEmpleadosBusqueda").dxDataGrid("instance").columnOption("ACCIONES","visible",!1),$("#btnAsgEmpleados").dxButton("instance").option("visible",!0),l={...ReturnDefaultData_Init(),ESTATUS_PROCESO_EMP_CSC:ReturnProcSubProcEstatus().ESTATUS_PROCESO_EMP_CSC,EMPLEADO_CSC_EMPLEADO_PADRE:q.EMPLEADO_CSC_EMPLEADO},n="ApiRecursosHumanos",b="GetSupervisionEmpl"):
"Atiende"==g?(l={...ReturnDefaultData_Init(),...ReturnProcSubProcEstatus(),TPO_USUARIO:"EMP_ADMIN_MESA",CAM_MESA_CSC:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_MESA_CSC").option("value")},n="ApiTickets_v2",b="Get_Mesa_Empleado"):"Solicita"==g?(l={...ReturnDefaultData_Init(),...ReturnProcSubProcEstatus(),TIPO_CONSULTA:"AVANZADO",INFO:"ALLEMP"},n="ApiRecursosHumanos",b="GetEmpleado"):"AgregarParticipante"==g&&($("#DataGridEmpleadosBusqueda").dxDataGrid("instance").columnOption("ACCIONES","visible",
!1),$("#btnAsgEmpleados").dxButton("instance").option("visible",!0),l={...ReturnDefaultData_Init(),...ReturnProcSubProcEstatus(),TPO_USUARIO:"EMP_ADMIN_MESA",CAM_MESA_CSC:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_MESA_CSC").option("value")},n="ApiTickets_v2",b="Get_Mesa_Empleado");a.CargaEmpleadosBy(l,n,b)};a.CargaEmpleadosBy=(g,k,l)=>{__Reques_ajax(getJSON(DeveloperType)[k].url+l,"GET",g,getJSON(DeveloperType)[k].token).then(n=>{1==n.success&&n.JsonData.forEach(function(b){a._Obj_Empleados_Grid.insert(b)});
$("#DataGridEmpleadosBusqueda").dxDataGrid("instance").refresh();p.hide()}).catch(function(n){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);$("#DataGridEmpleadosBusqueda").dxDataGrid("instance").refresh();p.hide()})};a._InsertaEmpleadosTicket=()=>{var g=null,k=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),l=a.Frm_Ticket_Servicio_Instance.option("formData");null!=a.Dg_Empleados_Ticket.getDataSource()&&(g=a.Dg_Empleados_Ticket.getDataSource().items(),
0!=g.length&&(g=g.map(n=>{var b={};b.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");b.EMPLEADO_CSC_EMPLEADO=n.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_FEC_ALTA=k;b.AUDITORIA_FEC_ULT_MOD=k;b.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;b.TIC_NEWID=l.TIC_NEWID;n={...ReturnDefaultData_Init(),DATA_INSERT:b};return a._EjecPromise(n)}),Promise.all(g).then(n=>{DevExpress.ui.notify({message:"Empleados asignados correctamente",minWidth:150,type:"info",
displayTime:5E3},{position:"bottom right",direction:"up-push"})}).catch(function(n){console.error("Ha ocurrido un error:",n)})))};a._EjecPromise=g=>new Promise((k,l)=>{try{__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Emp_Ticket","POST",JSON.stringify(g),getJSON(DeveloperType).ApiGeneral.token).then(n=>{k(n)})}catch(n){l(n)}});a.Get_Emp_Ticket=function(g){a._Obj_Agrega_Emp_Ticket.clear();g={...ReturnDefaultData_Init(),TIC_NEWID:g};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+
"Get_Emp_Ticket","GET",g,getJSON(DeveloperType).ApiTickets_v2.token).then(k=>{1==k.success&&k.JsonData.forEach(function(l){a._Obj_Agrega_Emp_Ticket.insert(l)});a.Dg_Empleados_Ticket.refresh()}).catch(function(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);a.Dg_Empleados_Ticket.refresh()})};a.Get_Datos_Empleado_Solicita=function(g){g={...ReturnDefaultData_Init(),TIPO_CONSULTA:"AVANZADO",EMPLEADO_CSC_EMPLEADO:g};return __Reques_ajax(getJSON(DeveloperType).ApiRecursosHumanos.url+
"GetEmpleado","GET",g,getJSON(DeveloperType).ApiRecursosHumanos.token).then(k=>{if(1==k.success){let l=null;l=2<=k.JsonData.length?jslinq(k.JsonData).orderByDescending(function(n){return n.AUDITORIA_FEC_ALTA}).toList()[0]:k.JsonData[0];k=JSON.stringify(l);a.DatosEmpleadosGet=JSON.parse(k);a.Frm_Ticket_Empleado_Solita_Instance.updateData(a.DatosEmpleadosGet);a.ObtenSelectBoxFrm(a.Frm_Ticket_Empleado_Solita_Instance)}else a.DatosEmpleadosGet=null,a.Frm_Ticket_Empleado_Solita_Instance.updateData({}),
DevExpress.ui.notify({message:"No se localizo el empleado que realizo la solicitud",minWidth:150,type:"info",displayTime:5E3},{position:"bottom right",direction:"up-push"})}).catch(function(k){console.log(k);DevExpress.ui.notify({message:"Error en comunicaci\u00f3n con servidores",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})};a.notificaPantalla=function(g="Notificaci\u00f3n",k="Aviso",l="",n=350,b=100){DevExpress.ui.notify({height:b,width:n,minWidth:300,
type:"default",displayTime:15E3,animation:{show:{type:"fade",duration:400,from:0,to:1},hide:{type:"fade",duration:40,to:0}},closeOnClick:!0,contentTemplate:c=>{c.append(`
                    <div class="toast-dna">
                        <div class="toast-header-dna">
                            <img src="../../images/asistente_virtual/AsisVritual_Info.svg" class="rounded me-2" alt="...">
                            <strong class="me-auto-dna">${g}</strong>
                            <small class="text-muted-dna">${k}</small>
                            <img src="../../images/Icons/CancelIcon.png" class="rounded2 me-2" alt="...">
                        </div>
                        <div class="toast-body-dna">${l}</div>
                    </div>`)}},{position:"bottom right",direction:"up-stack"})};a.Get_Inmuebles_Empleados=async function(){let g={...ReturnDefaultData_Init(),USU_CSC_USUARIO:A.USU_CSC_USUARIO};try{let k=await __Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Get_Requisicion_Empleados_Inmuebles","GET",g,getJSON(DeveloperType).ApiTickets_v2.token);if(1==k.success){let l=(Array.isArray(k.JsonData)?k.JsonData:[]).map(n=>n.REQ_CSCREQUISICION).join(",");a.REQ_CSCREQUISICION_IN=l}else a.REQ_CSCREQUISICION_IN=
""}catch(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3),a.REQ_CSCREQUISICION_IN=""}return a.REQ_CSCREQUISICION_IN};a.BusquedaActivoFijo=function(g,k){$("#Pop_Notificacion_Success").dxPopup("instance").option("height","450");$("#Pop_Notificacion_Success").dxPopup("instance").option("width","600");$("#Pop_Notificacion_Success").dxPopup("instance").option("contentTemplate",function(){return $("<div>").append($("<div class='popup-property-details'>").append($('<div class="Nice-Shadow-1" style="padding: 9px;">Buscar activo fijo</div>'),
$("<div style='margin: 9px;'/>").attr("id","DataGridActivosFijosBusqueda").dxDataGrid({headerFilter:{visible:!1},keyExpr:"SAMT_CSCEQUIPAMIENTO",dataSource:a._Obj_Activos_Grid_Busqueda,selection:{mode:"single"},height:300,filterRow:{visible:!0,applyFilter:"auto"},scrolling:{useNative:!1,scrollByContent:!0,scrollByThumb:!0,showScrollbar:"always"},groupPanel:{visible:!0},grouping:{autoExpandAll:!0},paging:{enabled:!1,pageIndex:0,pageSize:20},hoverStateEnabled:!0,showBorders:!0,showRowLines:!0,showColumnLines:!0,
rowAlternationEnabled:!0,columnAutoWidth:!1,columns:[{caption:"TAG/HOSTNAME",dataField:"EQUIPAMIENTO_HOSTNAME"},{caption:"Tipo de bien",dataField:"EQUIPAMIENTO_AUX1S"},{caption:"Modelo",dataField:"EQUIPAMIENTO_MODELO"},{caption:"No. de serie",dataField:"EQUIPAMIENTO_NO_SERIE"},{dataField:"ACCIONES",type:"buttons",width:110,buttons:[{text:"Seleccionar",onClick(l){let n=moment().tz(a.TimeZoneServidor).format("YYYY-MM-DD HH:mm:ss"),b={};b.EMP_CSC_EMPRESA_HOST=localStorage.getItem("EMP_CSC_EMPRESA_HOST");
b.TIC_NEWID=a.Frm_Ticket_Servicio_Instance.getEditor("TIC_NEWID").option("value");b.EQUIPAMIENTO_NEWID=l.row.data.EQUIPAMIENTO_NEWID;b.SAMT_CSCEQUIPAMIENTO=l.row.data.SAMT_CSCEQUIPAMIENTO;b.TICKET_EQUIPOS_ACTIVO=1;b.AUDITORIA_FEC_ALTA=n;b.AUDITORIA_FEC_ULT_MOD=n;b.AUDITORIA_USU_ALTA=q.EMPLEADO_CSC_EMPLEADO;b.AUDITORIA_USU_ULT_MOD=q.EMPLEADO_CSC_EMPLEADO;null==l.row.data.EQUIPAMIENTO_HOSTNAME?a.Frm_Ticket_Servicio_Instance.getEditor("TAG_COMPONENTE").option("value",l.row.data.EQUIPAMIENTO_NO_SERIE):
a.Frm_Ticket_Servicio_Instance.getEditor("TAG_COMPONENTE").option("value",l.row.data.EQUIPAMIENTO_HOSTNAME);24==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")&&a.Frm_Ticket_Servicio_Instance.getEditor("TIC_JSON_EXTRA_PARAMS").option("value",l.row.data.EQUIPAMIENTO_NO_INVENTARIO);l={...ReturnDefaultData_Init(),DATA_INSERT:b};__Reques_ajax(getJSON(DeveloperType).ApiTickets_v2.url+"Insert_Equipo_Ticket","POST",JSON.stringify(l),getJSON(DeveloperType).ApiTickets_v2.token).then(c=>
{1==c.success?(DevExpress.ui.notify({message:"Activo agregado correctamente",minWidth:150,type:"success",displayTime:5E3},{position:"bottom right",direction:"up-push"}),p.hide(),$("#Pop_Notificacion_Success").dxPopup("hide")):p.hide();return c}).catch(function(c){console.log(c);p.hide();DevExpress.ui.notify({message:"ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE",minWidth:150,type:"error",displayTime:5E3},{position:"bottom right",direction:"up-push"})})}}]}]})))});$("#Pop_Notificacion_Success").dxPopup("show");
p.show();a._Obj_Activos_Grid_Busqueda.clear();12==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(g=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC").option("selectedItem"),_BusquedaActivos={...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),EQUIPAMIENTO_AUX1S:g.TIPIFICA_IDIOMA1.trim()}):3==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?
(g=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem"),k=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("selectedItem"),_BusquedaActivos={...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),EQUIPAMIENTO_AUX1S:k.TIPIFICA_IDIOMA1.trim(),EQUIPAMIENTO_CODIGO_VPN:g.REQUISICION_PROVEEDORES_CODIGO_VPN.trim()}):25==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?
(g=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem"),_BusquedaActivos={...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),EQUIPAMIENTO_HOSTNAME:g.REQUISICION_PROVEEDORES_CODIGO_VPN.trim()}):6==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(g=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem"),_BusquedaActivos=
{...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),EQUIPAMIENTO_CODIGO_VPN:g.REQUISICION_PROVEEDORES_CODIGO_VPN.trim()}):20==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(g=a.Frm_Ticket_Servicio_Instance.getEditor("REQ_CSCREQUISICION").option("selectedItem"),console.log(g),_BusquedaActivos={...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value"),
EQUIPAMIENTO_CODIGO_VPN:g.SAMT_REQUISICION_PROVEEDORES_CSC}):_BusquedaActivos={...ReturnDefaultData_Init(),CAM_CSC_SERVICIO:a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")};_UrlApi="ApiEquipamiento";_FnName="Get_Equipo";a.CargarActiosFijos(_BusquedaActivos,_UrlApi,_FnName)};a.CargarActiosFijos=(g,k,l)=>{p.hide();__Reques_ajax(getJSON(DeveloperType)[k].url+l,"GET",g,getJSON(DeveloperType)[k].token).then(n=>{1==n.success?(n.JsonData.forEach(function(b){a._Obj_Activos_Grid_Busqueda.insert(b)}),
$("#DataGridActivosFijosBusqueda").dxDataGrid("instance").refresh(),p.hide()):($("#DataGridActivosFijosBusqueda").dxDataGrid("instance").refresh(),p.hide(),3==a.Frm_Ticket_Servicio_Instance.getEditor("CAM_CSC_SERVICIO_SOLICITA").option("value")?(n=a.Frm_Ticket_Servicio_Instance.getEditor("TIPIFICA_CSC_PARENT").option("selectedItem"),a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),`No se localizan activos asignados al inmueble del tipo ${n.TIPIFICA_IDIOMA1.trim()}`,
400,130)):a.notificaPantalla("Informaci\u00f3n",moment().tz(a.TimeZoneEmpleado).format(" DD/MM/YYYY HH:mm"),"No se localizan activos/inventario",400,130))}).catch(function(n){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3);$("#DataGridActivosFijosBusqueda").dxDataGrid("instance").refresh();p.hide()})};a.Run=function(){a.getPermisosEmpleadoServicios();const g=[{Tbl:"SAMT_TIPO_REQ_USO"},{Tbl:"SAMT_TIPO_TICKET_PARTICIPANTE"},{Tbl:"SAMT_CAT_EMPLEADO_AREA"},
{Tbl:"SAMT_CAT_EMPLEADO_DEPARTAMENTO"},{Tbl:"SAMT_CAM_MESA_DE_AYUDA"},{Tbl:"SAMT_ESTATUS_TICKET"},{Tbl:"SAMT_TIPO_PRIORIDAD_TICKET"},{Tbl:"SAMT_TIPO_TICKET"},{Tbl:"SAMT_CAM_TIPO_SERVICIO"},{Tbl:"SAMT_TIPO_SEVERIDAD"},{Tbl:"SAMT_CLIENTES"},{Tbl:"SAMT_PROYECTOS"},{Tbl:"SAMT_CAM_SERVICIO"},{Tbl:"SAMT_TIPO_CALIFICACION"},{Tbl:"SAMT_TIPO_PUESTO_EMPLEADO"},{Tbl:"SAMT_TIPO_RESPUESTA_AUTORIZA"},{Tbl:"SAMT_ESTATUS_ORDEN_TRABAJO"},{Tbl:"SAMT_CAM_TIPIFICACIONES"}];var k=sessionStorage.getItem("catsTicketsCompartidos");
""==k||null==k?(k=g.map(l=>a.CargaCatalogosPromise(l,"Get_Cat_Full")),Promise.all(k).then(l=>{a.CatalogosPantalla=l;a.armaCatalogosVista(g)}).catch(function(l){console.log("Ha ocurrido un error:",l)})):(a.CatalogosPantalla=JSON.parse(k),a.armaCatalogosVista(g))};a.CargaCatalogosPromise=(g,k)=>new Promise((l,n)=>{try{__Get_catalogos(getJSON(DeveloperType).ApiGeneral.url+k,"GET",g,getJSON(DeveloperType).ApiGeneral.token).then(b=>{!0===b.success&&(b.CatName=g.Tbl);l(b)})}catch(b){n(b)}});a.armaCatalogosVista=
g=>{jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[0].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_REQ_USO_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[1].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_TICKET_PARTICIPANTE_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[2].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAT_EMPLEADO_AREA_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[3].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAT_EMPLEADO_DEPARTAMENTO_OBJDATA.insert(k)});
jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[4].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAM_MESA_DE_AYUDA_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[5].Tbl)).toList().forEach(function(k){a._CMB_SAMT_ESTATUS_TICKET_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[6].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_PRIORIDAD_TICKET_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[7].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_TICKET_OBJDATA.insert(k)});
jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[8].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAM_TIPO_SERVICIO_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[9].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_SEVERIDAD_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[10].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CLIENTES_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[11].Tbl)).toList().forEach(function(k){a._CMB_SAMT_PROYECTOS_OBJDATA.insert(k)});
jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[12].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAM_SERVICIO_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[13].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_CALIFICACION_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[14].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_PUESTO_EMPLEADO_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[15].Tbl)).toList().forEach(function(k){a._CMB_SAMT_TIPO_RESPUESTA_AUTORIZA_OBJDATA.insert(k)});
jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[16].Tbl)).toList().forEach(function(k){a._CMB_SAMT_ESTATUS_ORDEN_TRABAJO_OBJDATA.insert(k)});jslinq(ObtenCatalogoPantalla(a.CatalogosPantalla,g[17].Tbl)).toList().forEach(function(k){a._CMB_SAMT_CAM_TIPIFICACIONES_OBJDATA.insert(k)});setTimeout(()=>{try{sessionStorage.setItem("catsTicketsCompartidos",JSON.stringify(a.CatalogosPantalla))}catch(k){console.log(k)}a.init()},1E3)};a.getPermisosEmpleadoServicios=async function(){var g=JSON.parse(localStorage.getItem("obj_DatosEmpleado"));
g={...ReturnDefaultData_Init(),EMPLEADO_CSC_EMPLEADO:g.EMPLEADO_CSC_EMPLEADO};try{let k=await __Reques_ajax(getJSON(DeveloperType).ApiGeneral.url+"getTreeCliProyCamp","GET",g,getJSON(DeveloperType).ApiGeneral.token);if(1==k.success){let l=jslinq(k.JsonData).toList();l.forEach(function(n){a._ClienteProyectoCampania_ObjData.insert(n)});console.log(l)}}catch(k){DevExpress.ui.notify("ERROR EN COMUNICACION AL SERVIDOR, INTENTELO NUEVAMENTE","error",3E3)}return!0}};
setTimeout(()=>{SalesDashboard.currentModel=new SalesDashboard.dashboardModel;SalesDashboard.currentModel.Run()},1E3);
